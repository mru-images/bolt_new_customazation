"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./app/page.tsx":
/*!**********************!*\
  !*** ./app/page.tsx ***!
  \**********************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ MusicPlayerApp; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var _components_AddToPlaylistModal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/components/AddToPlaylistModal */ \"(app-pages-browser)/./components/AddToPlaylistModal.tsx\");\n/* harmony import */ var _components_AuthWrapper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/components/AuthWrapper */ \"(app-pages-browser)/./components/AuthWrapper.tsx\");\n/* harmony import */ var _components_CreatePlaylistModal__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/components/CreatePlaylistModal */ \"(app-pages-browser)/./components/CreatePlaylistModal.tsx\");\n/* harmony import */ var _components_HomePage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/components/HomePage */ \"(app-pages-browser)/./components/HomePage.tsx\");\n/* harmony import */ var _components_LikedSongsPage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/components/LikedSongsPage */ \"(app-pages-browser)/./components/LikedSongsPage.tsx\");\n/* harmony import */ var _components_MaximizedPlayer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/components/MaximizedPlayer */ \"(app-pages-browser)/./components/MaximizedPlayer.tsx\");\n/* harmony import */ var _components_MinimizedPlayer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/components/MinimizedPlayer */ \"(app-pages-browser)/./components/MinimizedPlayer.tsx\");\n/* harmony import */ var _components_PlaylistsPage__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/components/PlaylistsPage */ \"(app-pages-browser)/./components/PlaylistsPage.tsx\");\n/* harmony import */ var _components_SearchPage__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/components/SearchPage */ \"(app-pages-browser)/./components/SearchPage.tsx\");\n/* harmony import */ var _components_SettingsPage__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/components/SettingsPage */ \"(app-pages-browser)/./components/SettingsPage.tsx\");\n/* harmony import */ var _components_SleepTimerModal__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/components/SleepTimerModal */ \"(app-pages-browser)/./components/SleepTimerModal.tsx\");\n/* harmony import */ var _components_ThemeContext__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/components/ThemeContext */ \"(app-pages-browser)/./components/ThemeContext.tsx\");\n/* harmony import */ var _hooks_useAuth__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @/hooks/useAuth */ \"(app-pages-browser)/./hooks/useAuth.ts\");\n/* harmony import */ var _hooks_useQueue__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @/hooks/useQueue */ \"(app-pages-browser)/./hooks/useQueue.ts\");\n/* harmony import */ var _hooks_useSleepTimer__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @/hooks/useSleepTimer */ \"(app-pages-browser)/./hooks/useSleepTimer.ts\");\n/* harmony import */ var _hooks_useSupabaseData__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @/hooks/useSupabaseData */ \"(app-pages-browser)/./hooks/useSupabaseData.ts\");\n/* harmony import */ var _barrel_optimize_names_Home_Search_Settings_lucide_react__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! __barrel_optimize__?names=Home,Search,Settings!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/home.js\");\n/* harmony import */ var _barrel_optimize_names_Home_Search_Settings_lucide_react__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! __barrel_optimize__?names=Home,Search,Settings!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/search.js\");\n/* harmony import */ var _barrel_optimize_names_Home_Search_Settings_lucide_react__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! __barrel_optimize__?names=Home,Search,Settings!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/settings.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_17__);\n/* harmony import */ var react_hot_toast__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! react-hot-toast */ \"(app-pages-browser)/./node_modules/react-hot-toast/dist/index.mjs\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction MusicPlayerContent() {\n    _s();\n    const { user } = (0,_hooks_useAuth__WEBPACK_IMPORTED_MODULE_13__.useAuth)();\n    const { songs, personalizedSongs, playlists, likedSongs, recentlyPlayedSongs, lastPlayedSong, loading, toggleLike, createPlaylist, deletePlaylist, renamePlaylist, addSongToPlaylist, removeSongFromPlaylist, recordListeningHistory, stopCurrentSongTracking, getPersonalizedSongs, getSmartPersonalizedSongs } = (0,_hooks_useSupabaseData__WEBPACK_IMPORTED_MODULE_16__.useSupabaseData)(user);\n    const { queue, addToQueue, removeFromQueue, getNextSongFromQueue, clearQueue, hasQueue } = (0,_hooks_useQueue__WEBPACK_IMPORTED_MODULE_14__.useQueue)();\n    const [activeTab, setActiveTab] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(\"home\");\n    const [currentPage, setCurrentPage] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(\"main\");\n    const [currentSong, setCurrentSong] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(null);\n    const [isPlaying, setIsPlaying] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    const [isPlayerMaximized, setIsPlayerMaximized] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    const [showCreatePlaylistModal, setShowCreatePlaylistModal] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    const [showAddToPlaylistModal, setShowAddToPlaylistModal] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    const [showSleepTimerModal, setShowSleepTimerModal] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    const [selectedSongForPlaylist, setSelectedSongForPlaylist] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(null);\n    const [hasSetLastPlayedSong, setHasSetLastPlayedSong] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    const [lastPlayedSongDismissed, setLastPlayedSongDismissed] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    const { isDarkMode, toggleTheme } = (0,_components_ThemeContext__WEBPACK_IMPORTED_MODULE_12__.useTheme)();\n    const [displayCount, setDisplayCount] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(15);\n    const [imageUrls, setImageUrls] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)({});\n    const [audioUrl, setAudioUrl] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(null);\n    const audioRef = (0,react__WEBPACK_IMPORTED_MODULE_17__.useRef)(null);\n    const [currentTime, setCurrentTime] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(0);\n    const [duration, setDuration] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(0);\n    const [volume, setVolume] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(1); // default 75%\n    const [isSeeking, setIsSeeking] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    const [pendingSeekTime, setPendingSeekTime] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(null);\n    const [isExternallySeeking, setIsExternallySeeking] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    const [recommendedQueue, setRecommendedQueue] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)([]);\n    const [playedSongs, setPlayedSongs] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(new Set());\n    const [personalizedList, setPersonalizedList] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)([]);\n    const [currentSongIndex, setCurrentSongIndex] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(0);\n    const [listenedSongs, setListenedSongs] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(new Set());\n    const [isFetchingMore, setIsFetchingMore] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(false);\n    // Smart recommendation system state\n    const [currentBatchListenedSongs, setCurrentBatchListenedSongs] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)([]);\n    const [songStartTime, setSongStartTime] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(null);\n    const [batchStartIndex, setBatchStartIndex] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(0);\n    // Shuffle and repeat state\n    const [isShuffleEnabled, setIsShuffleEnabled] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(true); // Shuffle on by default\n    const [repeatMode, setRepeatMode] = (0,react__WEBPACK_IMPORTED_MODULE_17__.useState)(\"off\");\n    // Sleep timer\n    const { sleepTimer, remainingTime, startTimer, cancelTimer, triggerAfterSongTimer, isActive: isSleepTimerActive } = (0,_hooks_useSleepTimer__WEBPACK_IMPORTED_MODULE_15__.useSleepTimer)();\n    const loadMoreSongs = ()=>{\n        setDisplayCount((prev)=>prev + 15);\n    };\n    const displayedSongs = songs.slice(0, displayCount);\n    (0,react__WEBPACK_IMPORTED_MODULE_17__.useEffect)(()=>{\n        const loadAudio = async ()=>{\n            if (currentSong === null || currentSong === void 0 ? void 0 : currentSong.file_id) {\n                const url = \"/api/audio-proxy?fileid=\".concat(currentSong.file_id);\n                setAudioUrl(url);\n                setDuration(0);\n                setCurrentTime(0);\n                setPendingSeekTime(null);\n            }\n        };\n        loadAudio();\n    }, [\n        currentSong === null || currentSong === void 0 ? void 0 : currentSong.file_id\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_17__.useEffect)(()=>{\n        if (audioRef.current) {\n            audioRef.current.volume = volume;\n        }\n    }, [\n        volume\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_17__.useEffect)(()=>{\n        const audio = audioRef.current;\n        if (!audio) return;\n        if (!isNaN(audio.duration) && isPlaying) {\n            // Duration is valid, safe to play\n            audio.play().catch((e)=>{\n                console.error(\"Playback error:\", e);\n            });\n        } else if (!isPlaying) {\n            audio.pause();\n        }\n    }, [\n        isPlaying\n    ]);\n    // Load images for currently displayed songs\n    (0,react__WEBPACK_IMPORTED_MODULE_17__.useEffect)(()=>{\n        const fetchImages = async ()=>{\n            const newUrls = {};\n            // Songs from the main feed\n            const songsToLoad = songs.slice(0, displayCount);\n            for (const song of songsToLoad){\n                if (!imageUrls[song.id]) {\n                    newUrls[song.id] = \"/api/image-proxy?fileid=\".concat(song.img_id);\n                }\n            }\n            // Songs from playlists\n            for (const playlist of playlists){\n                for (const song of playlist.songs){\n                    if (!imageUrls[song.id]) {\n                        newUrls[song.id] = \"/api/image-proxy?fileid=\".concat(song.img_id);\n                    }\n                }\n            }\n            // Liked songs\n            for (const song of likedSongs){\n                if (!imageUrls[song.id]) {\n                    newUrls[song.id] = \"/api/image-proxy?fileid=\".concat(song.img_id);\n                }\n            }\n            // Recently played songs\n            for (const song of recentlyPlayedSongs){\n                if (!imageUrls[song.id]) {\n                    newUrls[song.id] = \"/api/image-proxy?fileid=\".concat(song.img_id);\n                }\n            }\n            // Apply if new URLs found\n            if (Object.keys(newUrls).length > 0) {\n                setImageUrls((prev)=>({\n                        ...prev,\n                        ...newUrls\n                    }));\n            }\n        };\n        fetchImages();\n    }, [\n        displayCount,\n        songs,\n        playlists,\n        likedSongs,\n        recentlyPlayedSongs\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_17__.useEffect)(()=>{\n        console.log(\"\\uD83C\\uDFB5 personalizedList updated:\", personalizedList);\n    }, [\n        personalizedList\n    ]);\n    // Set last played song as current song when data loads (only once and if not dismissed)\n    (0,react__WEBPACK_IMPORTED_MODULE_17__.useEffect)(()=>{\n        const loadLastPlayedImage = async ()=>{\n            if (user && lastPlayedSong && !hasSetLastPlayedSong && !lastPlayedSongDismissed) {\n                try {\n                    console.log(\"\\uD83C\\uDFB5 Loading initial personalized songs for last played song\");\n                    const initialRecs = await getPersonalizedSongs(user.id, lastPlayedSong, listenedSongs);\n                    const filtered = initialRecs.filter((song)=>!playedSongs.has(song.file_id.toString()));\n                    const newPersonalizedList = [\n                        lastPlayedSong,\n                        ...filtered.slice(0, 4)\n                    ];\n                    setPersonalizedList(newPersonalizedList);\n                    console.log(\"✅ Initial personalized list set:\", newPersonalizedList.length, \"songs\");\n                } catch (error) {\n                    console.error(\"❌ Error loading initial personalized songs:\", error);\n                    setPersonalizedList([\n                        lastPlayedSong\n                    ]);\n                }\n                setCurrentSong(lastPlayedSong);\n                setHasSetLastPlayedSong(true);\n                // Add to listened songs and log\n                setListenedSongs((prev)=>{\n                    const newSet = new Set(prev);\n                    newSet.add(lastPlayedSong.file_id.toString());\n                    console.log(\"\\uD83C\\uDFB5 Listened Songs List:\", Array.from(newSet));\n                    return newSet;\n                });\n                if (!imageUrls[lastPlayedSong.img_id]) {\n                    const url = \"/api/image-proxy?fileid=\".concat(lastPlayedSong.img_id);\n                    setImageUrls((prev)=>({\n                            ...prev,\n                            [lastPlayedSong.img_id]: url\n                        }));\n                }\n            }\n        };\n        loadLastPlayedImage();\n    }, [\n        lastPlayedSong,\n        hasSetLastPlayedSong,\n        lastPlayedSongDismissed,\n        user,\n        getPersonalizedSongs\n    ]);\n    const handleSongPlay = async (song)=>{\n        // Record if previous song was listened to (>20 seconds)\n        if (currentSong && songStartTime) {\n            const listenDuration = (new Date().getTime() - songStartTime.getTime()) / 1000;\n            if (listenDuration > 20) {\n                console.log('✅ User listened to \"'.concat(currentSong.name, '\" for ').concat(listenDuration.toFixed(1), \" seconds\"));\n                setCurrentBatchListenedSongs((prev)=>{\n                    const exists = prev.some((s)=>s.file_id === currentSong.file_id);\n                    if (!exists) {\n                        const updated = [\n                            ...prev,\n                            currentSong\n                        ];\n                        console.log(\"\\uD83C\\uDFB5 Current batch listened songs:\", updated.map((s)=>s.name));\n                        return updated;\n                    }\n                    return prev;\n                });\n            } else {\n                console.log('⏭️ User skipped \"'.concat(currentSong.name, '\" after ').concat(listenDuration.toFixed(1), \" seconds\"));\n            }\n        }\n        setCurrentSong(song);\n        setIsPlaying(true);\n        setLastPlayedSongDismissed(false);\n        recordListeningHistory(song.id);\n        setSongStartTime(new Date()); // Track when this song started\n        // Add to listened songs and log\n        setListenedSongs((prev)=>{\n            const newSet = new Set(prev);\n            newSet.add(song.file_id.toString());\n            console.log(\"\\uD83C\\uDFB5 Listened Songs List:\", Array.from(newSet));\n            return newSet;\n        });\n        setPlayedSongs((prev)=>{\n            const updated = new Set(prev);\n            updated.add(song.file_id.toString());\n            return updated;\n        });\n        if (user) {\n            try {\n                console.log(\"\\uD83C\\uDFB5 Fetching personalized songs for:\", song.name);\n                const recs = await getPersonalizedSongs(user.id, song, listenedSongs);\n                const filtered = recs.filter((s)=>!playedSongs.has(s.file_id.toString()));\n                const newPersonalizedList = [\n                    song,\n                    ...filtered.slice(0, 4)\n                ];\n                setPersonalizedList(newPersonalizedList);\n                setCurrentSongIndex(0);\n                setBatchStartIndex(0);\n                setCurrentBatchListenedSongs([]); // Reset batch for new song selection\n                console.log(\"✅ New personalized list set:\", newPersonalizedList.length, \"songs\");\n            } catch (error) {\n                console.error(\"❌ Error fetching personalized songs:\", error);\n                setPersonalizedList([\n                    song\n                ]);\n                setCurrentSongIndex(0);\n                setBatchStartIndex(0);\n                setCurrentBatchListenedSongs([]);\n            }\n        }\n    };\n    const handleAddToQueue = (song)=>{\n        addToQueue(song);\n        react_hot_toast__WEBPACK_IMPORTED_MODULE_18__.toast.success('Added \"'.concat(song.name, '\" to queue'));\n    };\n    const togglePlay = ()=>{\n        setIsPlaying(!isPlaying);\n    };\n    const togglePlayerSize = ()=>{\n        setIsPlayerMaximized(!isPlayerMaximized);\n    };\n    const closePlayer = async ()=>{\n        // Stop tracking current song before closing\n        await stopCurrentSongTracking();\n        setCurrentSong(null);\n        setIsPlaying(false);\n        setIsPlayerMaximized(false);\n        // Mark last played song as dismissed so it won't auto-load again\n        setLastPlayedSongDismissed(true);\n    };\n    const handleToggleLike = (songId)=>{\n        toggleLike(songId);\n        // Update current song state if it's the one being liked/unliked\n        if (currentSong && currentSong.id === songId) {\n            setCurrentSong((prev)=>prev ? {\n                    ...prev,\n                    isLiked: !prev.isLiked\n                } : null);\n        }\n    };\n    const handlePrevious = ()=>{\n        // Record if current song was listened to before going to previous\n        if (currentSong && songStartTime) {\n            const listenDuration = (new Date().getTime() - songStartTime.getTime()) / 1000;\n            if (listenDuration > 20) {\n                console.log('✅ User listened to \"'.concat(currentSong.name, '\" for ').concat(listenDuration.toFixed(1), \" seconds\"));\n                setCurrentBatchListenedSongs((prev)=>{\n                    const exists = prev.some((s)=>s.file_id === currentSong.file_id);\n                    if (!exists) {\n                        const updated = [\n                            ...prev,\n                            currentSong\n                        ];\n                        console.log(\"\\uD83C\\uDFB5 Current batch listened songs:\", updated.map((s)=>s.name));\n                        return updated;\n                    }\n                    return prev;\n                });\n            }\n        }\n        if (!currentSong) return;\n        // Check if there's a previous song in the personalized list\n        if (currentSongIndex > 0) {\n            const prevIndex = currentSongIndex - 1;\n            const prevSong = personalizedList[prevIndex];\n            if (prevSong) {\n                setCurrentSong(prevSong);\n                setCurrentSongIndex(prevIndex);\n                setIsPlaying(true);\n                setLastPlayedSongDismissed(false);\n                recordListeningHistory(prevSong.id);\n                setSongStartTime(new Date());\n                // Add to listened songs and log\n                setListenedSongs((prev)=>{\n                    const newSet = new Set(prev);\n                    newSet.add(prevSong.file_id.toString());\n                    console.log(\"\\uD83C\\uDFB5 Listened Songs List:\", Array.from(newSet));\n                    return newSet;\n                });\n                setPlayedSongs((prev)=>{\n                    const updated = new Set(prev);\n                    updated.add(prevSong.file_id.toString());\n                    return updated;\n                });\n                // Preload image\n                if (!imageUrls[prevSong.img_id]) {\n                    const newUrl = \"/api/image-proxy?fileid=\".concat(prevSong.img_id);\n                    setImageUrls((prev)=>({\n                            ...prev,\n                            [prevSong.img_id]: newUrl\n                        }));\n                }\n            }\n        } else {\n            // If at the beginning, just restart current song\n            setCurrentTime(0);\n            setIsPlaying(true);\n        }\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_17__.useEffect)(()=>{\n        if (!currentSong) return;\n        const currentIndex = songs.findIndex((song)=>song.id === currentSong.id);\n        const nextIndex = currentIndex < songs.length - 1 ? currentIndex + 1 : 0;\n        const nextSong = songs[nextIndex];\n        // Preload next song image if not in cache\n        if (nextSong && !imageUrls[nextSong.img_id]) {\n            const newUrl = \"/api/image-proxy?fileid=\".concat(nextSong.img_id);\n            setImageUrls((prev)=>({\n                    ...prev,\n                    [nextSong.img_id]: newUrl\n                }));\n        }\n    }, [\n        currentSong,\n        songs\n    ]);\n    const handleLoadedMetadata = async ()=>{\n        const audio = audioRef.current;\n        if (!audio) return;\n        const loadedDuration = audio.duration;\n        if (!isNaN(loadedDuration) && isFinite(loadedDuration)) {\n            setDuration(loadedDuration);\n            if (pendingSeekTime !== null) {\n                audio.currentTime = pendingSeekTime;\n                setCurrentTime(pendingSeekTime);\n                setPendingSeekTime(null);\n            } else {\n                setCurrentTime(audio.currentTime);\n            }\n            try {\n                if (isPlaying) {\n                    await audio.play();\n                }\n            } catch (err) {\n                console.error(\"Auto-play error after metadata load:\", err);\n            }\n        } else {\n            // Retry metadata read\n            setTimeout(handleLoadedMetadata, 100);\n        }\n    };\n    const handleNext = async ()=>{\n        // Record if current song was listened to before going to next\n        if (currentSong && songStartTime) {\n            const listenDuration = (new Date().getTime() - songStartTime.getTime()) / 1000;\n            if (listenDuration > 20) {\n                console.log('✅ User listened to \"'.concat(currentSong.name, '\" for ').concat(listenDuration.toFixed(1), \" seconds\"));\n                setCurrentBatchListenedSongs((prev)=>{\n                    const exists = prev.some((s)=>s.file_id === currentSong.file_id);\n                    if (!exists) {\n                        const updated = [\n                            ...prev,\n                            currentSong\n                        ];\n                        console.log(\"\\uD83C\\uDFB5 Current batch listened songs:\", updated.map((s)=>s.name));\n                        return updated;\n                    }\n                    return prev;\n                });\n            } else {\n                console.log('⏭️ User skipped \"'.concat(currentSong.name, '\" after ').concat(listenDuration.toFixed(1), \" seconds\"));\n            }\n        }\n        if (!currentSong) return;\n        // Check if there's a song in the queue first\n        const nextQueueSong = getNextSongFromQueue();\n        if (nextQueueSong) {\n            setCurrentSong(nextQueueSong);\n            setIsPlaying(true);\n            setLastPlayedSongDismissed(false);\n            recordListeningHistory(nextQueueSong.id);\n            setSongStartTime(new Date());\n            // Add to listened songs and log\n            setListenedSongs((prev)=>{\n                const newSet = new Set(prev);\n                newSet.add(nextQueueSong.file_id.toString());\n                console.log(\"\\uD83C\\uDFB5 Listened Songs List:\", Array.from(newSet));\n                return newSet;\n            });\n            // Update personalized list with the queue song\n            if (user) {\n                const recs = await getPersonalizedSongs(user.id, nextQueueSong, listenedSongs);\n                const filtered = recs.filter((s)=>!playedSongs.has(String(s.file_id)));\n                const newPersonalizedList = [\n                    nextQueueSong,\n                    ...filtered.slice(0, 4)\n                ];\n                setPersonalizedList(newPersonalizedList);\n                setCurrentSongIndex(0);\n            }\n            // Preload image\n            if (!imageUrls[nextQueueSong.img_id]) {\n                const newUrl = \"/api/image-proxy?fileid=\".concat(nextQueueSong.img_id);\n                setImageUrls((prev)=>({\n                        ...prev,\n                        [nextQueueSong.img_id]: newUrl\n                    }));\n            }\n            return;\n        }\n        // Check if we're at the second-to-last song and need to fetch smart recommendations\n        if (currentSongIndex === personalizedList.length - 2 && !isFetchingMore && user && currentSong) {\n            console.log(\"\\uD83E\\uDDE0 At second-to-last song, checking for smart recommendations...\");\n            setIsFetchingMore(true);\n            try {\n                let newRecs = [];\n                // If we have songs that user actually listened to in current batch, use smart recommendations\n                if (currentBatchListenedSongs.length > 0) {\n                    console.log(\"\\uD83E\\uDDE0 Using smart recommendations based on listened songs\");\n                    newRecs = await getSmartPersonalizedSongs(user.id, currentBatchListenedSongs, new Set([\n                        ...Array.from(listenedSongs),\n                        ...personalizedList.map((s)=>s.file_id.toString())\n                    ]));\n                } else {\n                    console.log(\"\\uD83C\\uDFB5 No listened songs in batch, using regular recommendations\");\n                    newRecs = await getPersonalizedSongs(user.id, currentSong, listenedSongs);\n                }\n                const filtered = newRecs.filter((song)=>!playedSongs.has(song.file_id.toString()) && !listenedSongs.has(song.file_id.toString()) && !personalizedList.some((existing)=>existing.file_id === song.file_id));\n                if (filtered.length > 0) {\n                    setPersonalizedList((prev)=>[\n                            ...prev,\n                            ...filtered.slice(0, 5)\n                        ]);\n                    console.log(\"✅ Added\", filtered.slice(0, 5).length, \"smart recommendations to personalized list\");\n                }\n            } catch (error) {\n                console.error(\"❌ Error fetching smart recommendations:\", error);\n            } finally{\n                setIsFetchingMore(false);\n            }\n        }\n        // If no queue, proceed with personalized list\n        const nextIndex = currentSongIndex + 1;\n        if (nextIndex < personalizedList.length) {\n            const nextSong = personalizedList[nextIndex];\n            setCurrentSong(nextSong);\n            setCurrentSongIndex(nextIndex);\n            setIsPlaying(true);\n            setLastPlayedSongDismissed(false);\n            recordListeningHistory(nextSong.id);\n            setSongStartTime(new Date());\n            // Add to listened songs and log\n            setListenedSongs((prev)=>{\n                const newSet = new Set(prev);\n                newSet.add(nextSong.file_id.toString());\n                console.log(\"\\uD83C\\uDFB5 Listened Songs List:\", Array.from(newSet));\n                return newSet;\n            });\n            setPlayedSongs((prev)=>{\n                const updated = new Set(prev);\n                updated.add(String(nextSong.file_id));\n                return updated;\n            });\n            // Preload image\n            if (!imageUrls[nextSong.img_id]) {\n                const newUrl = \"/api/image-proxy?fileid=\".concat(nextSong.img_id);\n                setImageUrls((prev)=>({\n                        ...prev,\n                        [nextSong.img_id]: newUrl\n                    }));\n            }\n        } else {\n            // If we've reached the end of personalized list, get new smart recommendations\n            if (user && currentSong) {\n                try {\n                    console.log(\"\\uD83E\\uDDE0 Reached end of list, fetching new smart recommendations\");\n                    let newRecs = [];\n                    // Use smart recommendations if we have listened songs in current batch\n                    if (currentBatchListenedSongs.length > 0) {\n                        console.log(\"\\uD83E\\uDDE0 Using smart recommendations for new batch\");\n                        newRecs = await getSmartPersonalizedSongs(user.id, currentBatchListenedSongs, listenedSongs);\n                    } else {\n                        console.log(\"\\uD83C\\uDFB5 Using regular recommendations for new batch\");\n                        newRecs = await getPersonalizedSongs(user.id, currentSong, listenedSongs);\n                    }\n                    const filtered = newRecs.filter((song)=>!playedSongs.has(song.file_id.toString()) && !listenedSongs.has(song.file_id.toString()));\n                    if (filtered.length > 0) {\n                        const nextSong = filtered[0];\n                        setCurrentSong(nextSong);\n                        setIsPlaying(true);\n                        setLastPlayedSongDismissed(false);\n                        recordListeningHistory(nextSong.id);\n                        setSongStartTime(new Date());\n                        // Add to listened songs and log\n                        setListenedSongs((prev)=>{\n                            const newSet = new Set(prev);\n                            newSet.add(nextSong.file_id.toString());\n                            console.log(\"\\uD83C\\uDFB5 Listened Songs List:\", Array.from(newSet));\n                            return newSet;\n                        });\n                        // Create new personalized list starting with this song\n                        const newPersonalizedList = [\n                            nextSong,\n                            ...filtered.slice(1, 5)\n                        ];\n                        setPersonalizedList(newPersonalizedList);\n                        setCurrentSongIndex(0);\n                        setBatchStartIndex(0);\n                        setCurrentBatchListenedSongs([]); // Reset batch for new recommendations\n                        setPlayedSongs((prev)=>{\n                            const updated = new Set(prev);\n                            updated.add(nextSong.file_id.toString());\n                            return updated;\n                        });\n                        // Preload image\n                        if (!imageUrls[nextSong.img_id]) {\n                            const newUrl = \"/api/image-proxy?fileid=\".concat(nextSong.img_id);\n                            setImageUrls((prev)=>({\n                                    ...prev,\n                                    [nextSong.img_id]: newUrl\n                                }));\n                        }\n                        console.log(\"✅ New smart recommendations loaded:\", newPersonalizedList.length, \"songs\");\n                    } else {\n                        console.warn(\"⚠️ No more smart recommendations available\");\n                    }\n                } catch (error) {\n                    console.error(\"❌ Error fetching new smart recommendations:\", error);\n                }\n            }\n        }\n    };\n    const formatNumber = (num)=>{\n        if (num >= 1000000) {\n            return (num / 1000000).toFixed(1) + \"M\";\n        } else if (num >= 1000) {\n            return (num / 1000).toFixed(1) + \"K\";\n        }\n        return num.toString();\n    };\n    const handleAddToPlaylist = (song)=>{\n        setSelectedSongForPlaylist(song);\n        setShowAddToPlaylistModal(true);\n    };\n    const handleSongEnd = async ()=>{\n        // Check if sleep timer is set to \"after-song\" and trigger it\n        if (sleepTimer === \"after-song\") {\n            triggerAfterSongTimer();\n            return;\n        }\n        // Record if song was listened to completely (assume >20 seconds if it ended naturally)\n        if (currentSong && songStartTime) {\n            const listenDuration = (new Date().getTime() - songStartTime.getTime()) / 1000;\n            console.log('\\uD83C\\uDFB5 Song \"'.concat(currentSong.name, '\" ended after ').concat(listenDuration.toFixed(1), \" seconds\"));\n            if (listenDuration > 20) {\n                setCurrentBatchListenedSongs((prev)=>{\n                    const exists = prev.some((s)=>s.file_id === currentSong.file_id);\n                    if (!exists) {\n                        const updated = [\n                            ...prev,\n                            currentSong\n                        ];\n                        console.log(\"\\uD83C\\uDFB5 Current batch listened songs:\", updated.map((s)=>s.name));\n                        return updated;\n                    }\n                    return prev;\n                });\n            }\n        }\n        // Handle repeat modes\n        if (repeatMode === \"once\" || repeatMode === \"infinite\") {\n            // Restart the current song\n            setCurrentTime(0);\n            setIsPlaying(true);\n            setSongStartTime(new Date());\n            // If repeat once, turn off repeat after playing once\n            if (repeatMode === \"once\") {\n                setRepeatMode(\"off\");\n            }\n            return;\n        }\n        // When a song ends, automatically play the next one\n        await handleNext();\n    };\n    const handleSleepTimerSet = (minutes)=>{\n        if (minutes === null) {\n            cancelTimer();\n        } else {\n            startTimer(minutes, ()=>{\n                setIsPlaying(false);\n                react_hot_toast__WEBPACK_IMPORTED_MODULE_18__.toast.success(\"Sleep timer ended - music stopped\");\n            });\n            if (typeof minutes === \"number\") {\n                react_hot_toast__WEBPACK_IMPORTED_MODULE_18__.toast.success(\"Sleep timer set for \".concat(minutes, \" minutes\"));\n            } else {\n                react_hot_toast__WEBPACK_IMPORTED_MODULE_18__.toast.success(\"Sleep timer set to stop after current song\");\n            }\n        }\n    };\n    const renderContent = ()=>{\n        if (currentPage === \"playlists\") {\n            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_PlaylistsPage__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {\n                playlists: playlists,\n                onBack: ()=>setCurrentPage(\"main\"),\n                onSongPlay: handleSongPlay,\n                onAddToQueue: handleAddToQueue,\n                onCreatePlaylist: ()=>setShowCreatePlaylistModal(true),\n                onDeletePlaylist: deletePlaylist,\n                onRenamePlaylist: renamePlaylist,\n                onRemoveSongFromPlaylist: removeSongFromPlaylist,\n                imageUrls: imageUrls,\n                clearQueue: clearQueue\n            }, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 718,\n                columnNumber: 9\n            }, this);\n        }\n        if (currentPage === \"liked\") {\n            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_LikedSongsPage__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n                songs: likedSongs,\n                onBack: ()=>setCurrentPage(\"main\"),\n                onSongPlay: handleSongPlay,\n                onAddToQueue: handleAddToQueue,\n                imageUrls: imageUrls,\n                clearQueue: clearQueue\n            }, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 734,\n                columnNumber: 14\n            }, this);\n        }\n        switch(activeTab){\n            case \"home\":\n                return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_HomePage__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n                    songs: displayedSongs,\n                    personalizedSongs: personalizedSongs,\n                    recentlyPlayedSongs: recentlyPlayedSongs,\n                    onSongPlay: handleSongPlay,\n                    formatNumber: formatNumber,\n                    onAddToPlaylist: handleAddToPlaylist,\n                    onAddToQueue: handleAddToQueue,\n                    imageUrls: imageUrls,\n                    onLoadMore: loadMoreSongs,\n                    hasMoreSongs: displayCount < songs.length\n                }, void 0, false, {\n                    fileName: \"/home/project/app/page.tsx\",\n                    lineNumber: 739,\n                    columnNumber: 16\n                }, this);\n            case \"search\":\n                return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_SearchPage__WEBPACK_IMPORTED_MODULE_9__[\"default\"], {\n                    songs: songs,\n                    onSongPlay: handleSongPlay,\n                    formatNumber: formatNumber,\n                    onAddToPlaylist: handleAddToPlaylist,\n                    onAddToQueue: handleAddToQueue,\n                    imageUrls: imageUrls,\n                    setImageUrls: setImageUrls\n                }, void 0, false, {\n                    fileName: \"/home/project/app/page.tsx\",\n                    lineNumber: 752,\n                    columnNumber: 16\n                }, this);\n            case \"settings\":\n                return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_SettingsPage__WEBPACK_IMPORTED_MODULE_10__[\"default\"], {\n                    onPlaylistsClick: ()=>setCurrentPage(\"playlists\"),\n                    onLikedClick: ()=>setCurrentPage(\"liked\")\n                }, void 0, false, {\n                    fileName: \"/home/project/app/page.tsx\",\n                    lineNumber: 762,\n                    columnNumber: 16\n                }, this);\n            default:\n                return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_HomePage__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n                    songs: displayedSongs,\n                    personalizedSongs: personalizedSongs,\n                    recentlyPlayedSongs: recentlyPlayedSongs,\n                    onSongPlay: handleSongPlay,\n                    formatNumber: formatNumber,\n                    onAddToPlaylist: handleAddToPlaylist,\n                    onAddToQueue: handleAddToQueue,\n                    imageUrls: imageUrls,\n                    onLoadMore: loadMoreSongs,\n                    hasMoreSongs: displayCount < songs.length\n                }, void 0, false, {\n                    fileName: \"/home/project/app/page.tsx\",\n                    lineNumber: 764,\n                    columnNumber: 16\n                }, this);\n        }\n    };\n    const themeClasses = isDarkMode ? \"bg-gray-900 text-white\" : \"bg-gray-50 text-gray-900\";\n    const setCurrentTimeState = setCurrentTime;\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"min-h-screen \".concat(themeClasses, \" relative overflow-hidden\"),\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"transition-all duration-300 \".concat(currentSong ? \"pb-36\" : \"pb-20\"),\n                children: renderContent()\n            }, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 788,\n                columnNumber: 9\n            }, this),\n            currentPage === \"main\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"fixed bottom-0 left-0 right-0 \".concat(isDarkMode ? \"bg-gray-800 border-gray-700\" : \"bg-white border-gray-200\", \" border-t z-30\"),\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"flex items-center justify-around py-3\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                            onClick: ()=>setActiveTab(\"home\"),\n                            className: \"flex flex-col items-center space-y-1 p-2 transition-colors \".concat(activeTab === \"home\" ? \"text-purple-400\" : isDarkMode ? \"text-gray-400\" : \"text-gray-600\"),\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Home_Search_Settings_lucide_react__WEBPACK_IMPORTED_MODULE_19__[\"default\"], {\n                                    size: 24\n                                }, void 0, false, {\n                                    fileName: \"/home/project/app/page.tsx\",\n                                    lineNumber: 802,\n                                    columnNumber: 17\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                    className: \"text-xs\",\n                                    children: \"Home\"\n                                }, void 0, false, {\n                                    fileName: \"/home/project/app/page.tsx\",\n                                    lineNumber: 803,\n                                    columnNumber: 17\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/project/app/page.tsx\",\n                            lineNumber: 796,\n                            columnNumber: 15\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                            onClick: ()=>setActiveTab(\"search\"),\n                            className: \"flex flex-col items-center space-y-1 p-2 transition-colors \".concat(activeTab === \"search\" ? \"text-purple-400\" : isDarkMode ? \"text-gray-400\" : \"text-gray-600\"),\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Home_Search_Settings_lucide_react__WEBPACK_IMPORTED_MODULE_20__[\"default\"], {\n                                    size: 24\n                                }, void 0, false, {\n                                    fileName: \"/home/project/app/page.tsx\",\n                                    lineNumber: 811,\n                                    columnNumber: 17\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                    className: \"text-xs\",\n                                    children: \"Search\"\n                                }, void 0, false, {\n                                    fileName: \"/home/project/app/page.tsx\",\n                                    lineNumber: 812,\n                                    columnNumber: 17\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/project/app/page.tsx\",\n                            lineNumber: 805,\n                            columnNumber: 15\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                            onClick: ()=>setActiveTab(\"settings\"),\n                            className: \"flex flex-col items-center space-y-1 p-2 transition-colors \".concat(activeTab === \"settings\" ? \"text-purple-400\" : isDarkMode ? \"text-gray-400\" : \"text-gray-600\"),\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Home_Search_Settings_lucide_react__WEBPACK_IMPORTED_MODULE_21__[\"default\"], {\n                                    size: 24\n                                }, void 0, false, {\n                                    fileName: \"/home/project/app/page.tsx\",\n                                    lineNumber: 820,\n                                    columnNumber: 17\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                    className: \"text-xs\",\n                                    children: \"Settings\"\n                                }, void 0, false, {\n                                    fileName: \"/home/project/app/page.tsx\",\n                                    lineNumber: 821,\n                                    columnNumber: 17\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/project/app/page.tsx\",\n                            lineNumber: 814,\n                            columnNumber: 15\n                        }, this)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/home/project/app/page.tsx\",\n                    lineNumber: 795,\n                    columnNumber: 13\n                }, this)\n            }, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 794,\n                columnNumber: 11\n            }, this),\n            currentSong && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n                children: !isPlayerMaximized ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_MinimizedPlayer__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n                    song: currentSong,\n                    isPlaying: isPlaying,\n                    imageUrl: imageUrls[currentSong.img_id],\n                    onTogglePlay: togglePlay,\n                    onMaximize: togglePlayerSize,\n                    onPrevious: handlePrevious,\n                    onNext: handleNext,\n                    onClose: closePlayer,\n                    onToggleLike: ()=>handleToggleLike(currentSong.id),\n                    formatNumber: formatNumber,\n                    currentTime: currentTime,\n                    duration: duration\n                }, void 0, false, {\n                    fileName: \"/home/project/app/page.tsx\",\n                    lineNumber: 831,\n                    columnNumber: 15\n                }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_MaximizedPlayer__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n                    song: currentSong,\n                    isPlaying: isPlaying,\n                    imageUrl: imageUrls[currentSong.img_id],\n                    onTogglePlay: togglePlay,\n                    onMinimize: togglePlayerSize,\n                    onPrevious: handlePrevious,\n                    onNext: handleNext,\n                    onToggleLike: ()=>handleToggleLike(currentSong.id),\n                    formatNumber: formatNumber,\n                    onAddToPlaylist: ()=>handleAddToPlaylist(currentSong),\n                    currentTime: currentTime,\n                    duration: duration,\n                    setCurrentTime: (seekTime)=>{\n                        if (audioRef.current && !isNaN(audioRef.current.duration)) {\n                            setIsExternallySeeking(true);\n                            audioRef.current.currentTime = seekTime;\n                            setCurrentTimeState(seekTime);\n                            setTimeout(()=>setIsExternallySeeking(false), 200);\n                        } else {\n                            setPendingSeekTime(seekTime); // Will apply onLoadedMetadata\n                        }\n                    },\n                    volume: volume,\n                    setVolume: setVolume,\n                    isSeeking: isSeeking,\n                    setIsSeeking: setIsSeeking,\n                    queue: queue,\n                    onRemoveFromQueue: removeFromQueue,\n                    onSongPlay: handleSongPlay,\n                    imageUrls: imageUrls,\n                    isShuffleEnabled: isShuffleEnabled,\n                    setIsShuffleEnabled: setIsShuffleEnabled,\n                    repeatMode: repeatMode,\n                    setRepeatMode: setRepeatMode,\n                    sleepTimer: sleepTimer,\n                    remainingTime: remainingTime,\n                    onOpenSleepTimer: ()=>setShowSleepTimerModal(true)\n                }, void 0, false, {\n                    fileName: \"/home/project/app/page.tsx\",\n                    lineNumber: 846,\n                    columnNumber: 15\n                }, this)\n            }, void 0, false),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_CreatePlaylistModal__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n                isOpen: showCreatePlaylistModal,\n                onClose: ()=>setShowCreatePlaylistModal(false),\n                onCreatePlaylist: createPlaylist\n            }, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 894,\n                columnNumber: 9\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_AddToPlaylistModal__WEBPACK_IMPORTED_MODULE_1__[\"default\"], {\n                isOpen: showAddToPlaylistModal,\n                onClose: ()=>{\n                    setShowAddToPlaylistModal(false);\n                    setSelectedSongForPlaylist(null);\n                },\n                song: selectedSongForPlaylist,\n                playlists: playlists,\n                onAddToPlaylist: addSongToPlaylist,\n                onCreatePlaylist: ()=>{\n                    setShowAddToPlaylistModal(false);\n                    setShowCreatePlaylistModal(true);\n                },\n                imageUrls: imageUrls,\n                setImageUrls: setImageUrls\n            }, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 900,\n                columnNumber: 9\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_SleepTimerModal__WEBPACK_IMPORTED_MODULE_11__[\"default\"], {\n                isOpen: showSleepTimerModal,\n                onClose: ()=>setShowSleepTimerModal(false),\n                onSetTimer: handleSleepTimerSet,\n                currentTimer: sleepTimer\n            }, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 917,\n                columnNumber: 9\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"audio\", {\n                ref: audioRef,\n                src: audioUrl !== null && audioUrl !== void 0 ? audioUrl : undefined,\n                onEnded: handleSongEnd,\n                onTimeUpdate: ()=>{\n                    if (audioRef.current && !isSeeking && !isExternallySeeking) {\n                        const current = audioRef.current.currentTime;\n                        // Only update state if the difference is significant\n                        if (Math.abs(currentTime - current) > 0.25) {\n                            setCurrentTime(current);\n                        }\n                    }\n                },\n                onLoadedMetadata: handleLoadedMetadata,\n                onVolumeChange: ()=>{\n                    if (audioRef.current) {\n                        setVolume(audioRef.current.volume);\n                    }\n                },\n                style: {\n                    display: \"none\"\n                }\n            }, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 923,\n                columnNumber: 9\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"/home/project/app/page.tsx\",\n        lineNumber: 786,\n        columnNumber: 7\n    }, this);\n}\n_s(MusicPlayerContent, \"AocsUj2QHbM1C4wcaR7CwygHxt0=\", false, function() {\n    return [\n        _hooks_useAuth__WEBPACK_IMPORTED_MODULE_13__.useAuth,\n        _hooks_useSupabaseData__WEBPACK_IMPORTED_MODULE_16__.useSupabaseData,\n        _hooks_useQueue__WEBPACK_IMPORTED_MODULE_14__.useQueue,\n        _components_ThemeContext__WEBPACK_IMPORTED_MODULE_12__.useTheme,\n        _hooks_useSleepTimer__WEBPACK_IMPORTED_MODULE_15__.useSleepTimer\n    ];\n});\n_c = MusicPlayerContent;\nfunction MusicPlayerApp() {\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_AuthWrapper__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_hot_toast__WEBPACK_IMPORTED_MODULE_18__.Toaster, {\n                position: \"bottom-center\"\n            }, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 954,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(MusicPlayerContent, {}, void 0, false, {\n                fileName: \"/home/project/app/page.tsx\",\n                lineNumber: 955,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"/home/project/app/page.tsx\",\n        lineNumber: 953,\n        columnNumber: 5\n    }, this);\n}\n_c1 = MusicPlayerApp;\nvar _c, _c1;\n$RefreshReg$(_c, \"MusicPlayerContent\");\n$RefreshReg$(_c1, \"MusicPlayerApp\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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L2FwcC9wYWdlLnRzeD83NjAzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2UgY2xpZW50J1xuXG5pbXBvcnQgQWRkVG9QbGF5bGlzdE1vZGFsIGZyb20gJ0AvY29tcG9uZW50cy9BZGRUb1BsYXlsaXN0TW9kYWwnO1xuaW1wb3J0IEF1dGhXcmFwcGVyIGZyb20gJ0AvY29tcG9uZW50cy9BdXRoV3JhcHBlcic7XG5pbXBvcnQgQ3JlYXRlUGxheWxpc3RNb2RhbCBmcm9tICdAL2NvbXBvbmVudHMvQ3JlYXRlUGxheWxpc3RNb2RhbCc7XG5pbXBvcnQgSG9tZVBhZ2UgZnJvbSAnQC9jb21wb25lbnRzL0hvbWVQYWdlJztcbmltcG9ydCBMaWtlZFNvbmdzUGFnZSBmcm9tICdAL2NvbXBvbmVudHMvTGlrZWRTb25nc1BhZ2UnO1xuaW1wb3J0IE1heGltaXplZFBsYXllciBmcm9tICdAL2NvbXBvbmVudHMvTWF4aW1pemVkUGxheWVyJztcbmltcG9ydCBNaW5pbWl6ZWRQbGF5ZXIgZnJvbSAnQC9jb21wb25lbnRzL01pbmltaXplZFBsYXllcic7XG5pbXBvcnQgUGxheWxpc3RzUGFnZSBmcm9tICdAL2NvbXBvbmVudHMvUGxheWxpc3RzUGFnZSc7XG5pbXBvcnQgU2VhcmNoUGFnZSBmcm9tICdAL2NvbXBvbmVudHMvU2VhcmNoUGFnZSc7XG5pbXBvcnQgU2V0dGluZ3NQYWdlIGZyb20gJ0AvY29tcG9uZW50cy9TZXR0aW5nc1BhZ2UnO1xuaW1wb3J0IFNsZWVwVGltZXJNb2RhbCBmcm9tICdAL2NvbXBvbmVudHMvU2xlZXBUaW1lck1vZGFsJztcbmltcG9ydCB7IHVzZVRoZW1lIH0gZnJvbSAnQC9jb21wb25lbnRzL1RoZW1lQ29udGV4dCc7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnQC9ob29rcy91c2VBdXRoJztcbmltcG9ydCB7IHVzZVF1ZXVlIH0gZnJvbSAnQC9ob29rcy91c2VRdWV1ZSc7XG5pbXBvcnQgeyB1c2VTbGVlcFRpbWVyIH0gZnJvbSAnQC9ob29rcy91c2VTbGVlcFRpbWVyJztcbmltcG9ydCB7IHVzZVN1cGFiYXNlRGF0YSB9IGZyb20gJ0AvaG9va3MvdXNlU3VwYWJhc2VEYXRhJztcbmltcG9ydCB7IFNvbmcgfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB7IEhvbWUgYXMgSG9tZUljb24sIFNlYXJjaCwgU2V0dGluZ3MgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgVG9hc3RlciwgdG9hc3QgfSBmcm9tICdyZWFjdC1ob3QtdG9hc3QnO1xuXG5cbmZ1bmN0aW9uIE11c2ljUGxheWVyQ29udGVudCgpIHtcbiAgY29uc3QgeyB1c2VyIH0gPSB1c2VBdXRoKCk7XG4gIGNvbnN0IHtcbiAgICBzb25ncyxcbiAgICBwZXJzb25hbGl6ZWRTb25ncyxcbiAgICBwbGF5bGlzdHMsXG4gICAgbGlrZWRTb25ncyxcbiAgICByZWNlbnRseVBsYXllZFNvbmdzLFxuICAgIGxhc3RQbGF5ZWRTb25nLFxuICAgIGxvYWRpbmcsXG4gICAgdG9nZ2xlTGlrZSxcbiAgICBjcmVhdGVQbGF5bGlzdCxcbiAgICBkZWxldGVQbGF5bGlzdCxcbiAgICByZW5hbWVQbGF5bGlzdCxcbiAgICBhZGRTb25nVG9QbGF5bGlzdCxcbiAgICByZW1vdmVTb25nRnJvbVBsYXlsaXN0LFxuICAgIHJlY29yZExpc3RlbmluZ0hpc3RvcnksXG4gICAgc3RvcEN1cnJlbnRTb25nVHJhY2tpbmcsXG4gICAgZ2V0UGVyc29uYWxpemVkU29uZ3MsXG4gICAgZ2V0U21hcnRQZXJzb25hbGl6ZWRTb25nc1xuICB9ID0gdXNlU3VwYWJhc2VEYXRhKHVzZXIpO1xuXG4gIGNvbnN0IHtcbiAgICBxdWV1ZSxcbiAgICBhZGRUb1F1ZXVlLFxuICAgIHJlbW92ZUZyb21RdWV1ZSxcbiAgICBnZXROZXh0U29uZ0Zyb21RdWV1ZSxcbiAgICBjbGVhclF1ZXVlLFxuICAgIGhhc1F1ZXVlXG4gIH0gPSB1c2VRdWV1ZSgpO1xuXG4gIGNvbnN0IFthY3RpdmVUYWIsIHNldEFjdGl2ZVRhYl0gPSB1c2VTdGF0ZTwnaG9tZScgfCAnc2VhcmNoJyB8ICdzZXR0aW5ncyc+KCdob21lJyk7XG4gIGNvbnN0IFtjdXJyZW50UGFnZSwgc2V0Q3VycmVudFBhZ2VdID0gdXNlU3RhdGU8J21haW4nIHwgJ3BsYXlsaXN0cycgfCAnbGlrZWQnPignbWFpbicpO1xuICBjb25zdCBbY3VycmVudFNvbmcsIHNldEN1cnJlbnRTb25nXSA9IHVzZVN0YXRlPFNvbmcgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2lzUGxheWluZywgc2V0SXNQbGF5aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2lzUGxheWVyTWF4aW1pemVkLCBzZXRJc1BsYXllck1heGltaXplZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtzaG93Q3JlYXRlUGxheWxpc3RNb2RhbCwgc2V0U2hvd0NyZWF0ZVBsYXlsaXN0TW9kYWxdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2hvd0FkZFRvUGxheWxpc3RNb2RhbCwgc2V0U2hvd0FkZFRvUGxheWxpc3RNb2RhbF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtzaG93U2xlZXBUaW1lck1vZGFsLCBzZXRTaG93U2xlZXBUaW1lck1vZGFsXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3NlbGVjdGVkU29uZ0ZvclBsYXlsaXN0LCBzZXRTZWxlY3RlZFNvbmdGb3JQbGF5bGlzdF0gPSB1c2VTdGF0ZTxTb25nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtoYXNTZXRMYXN0UGxheWVkU29uZywgc2V0SGFzU2V0TGFzdFBsYXllZFNvbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbbGFzdFBsYXllZFNvbmdEaXNtaXNzZWQsIHNldExhc3RQbGF5ZWRTb25nRGlzbWlzc2VkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgeyBpc0RhcmtNb2RlLCB0b2dnbGVUaGVtZSB9ID0gdXNlVGhlbWUoKTtcbiAgY29uc3QgW2Rpc3BsYXlDb3VudCwgc2V0RGlzcGxheUNvdW50XSA9IHVzZVN0YXRlKDE1KTtcbiAgY29uc3QgW2ltYWdlVXJscywgc2V0SW1hZ2VVcmxzXSA9IHVzZVN0YXRlPFJlY29yZDxzdHJpbmcsIHN0cmluZz4+KHt9KTtcbiAgY29uc3QgW2F1ZGlvVXJsLCBzZXRBdWRpb1VybF0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcbiAgY29uc3QgYXVkaW9SZWYgPSB1c2VSZWY8SFRNTEF1ZGlvRWxlbWVudCB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbY3VycmVudFRpbWUsIHNldEN1cnJlbnRUaW1lXSA9IHVzZVN0YXRlKDApO1xuICBjb25zdCBbZHVyYXRpb24sIHNldER1cmF0aW9uXSA9IHVzZVN0YXRlKDApO1xuICBjb25zdCBbdm9sdW1lLCBzZXRWb2x1bWVdID0gdXNlU3RhdGUoMSk7IC8vIGRlZmF1bHQgNzUlXG4gIGNvbnN0IFtpc1NlZWtpbmcsIHNldElzU2Vla2luZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtwZW5kaW5nU2Vla1RpbWUsIHNldFBlbmRpbmdTZWVrVGltZV0gPSB1c2VTdGF0ZTxudW1iZXIgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2lzRXh0ZXJuYWxseVNlZWtpbmcsIHNldElzRXh0ZXJuYWxseVNlZWtpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbcmVjb21tZW5kZWRRdWV1ZSwgc2V0UmVjb21tZW5kZWRRdWV1ZV0gPSB1c2VTdGF0ZTxTb25nW10+KFtdKVxuICBjb25zdCBbcGxheWVkU29uZ3MsIHNldFBsYXllZFNvbmdzXSA9IHVzZVN0YXRlPFNldDxzdHJpbmc+PihuZXcgU2V0KCkpICBcbiAgY29uc3QgW3BlcnNvbmFsaXplZExpc3QsIHNldFBlcnNvbmFsaXplZExpc3RdID0gdXNlU3RhdGU8U29uZ1tdPihbXSk7XG4gIGNvbnN0IFtjdXJyZW50U29uZ0luZGV4LCBzZXRDdXJyZW50U29uZ0luZGV4XSA9IHVzZVN0YXRlPG51bWJlcj4oMCk7XG4gIGNvbnN0IFtsaXN0ZW5lZFNvbmdzLCBzZXRMaXN0ZW5lZFNvbmdzXSA9IHVzZVN0YXRlPFNldDxzdHJpbmc+PihuZXcgU2V0KCkpO1xuICBjb25zdCBbaXNGZXRjaGluZ01vcmUsIHNldElzRmV0Y2hpbmdNb3JlXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICAvLyBTbWFydCByZWNvbW1lbmRhdGlvbiBzeXN0ZW0gc3RhdGVcbiAgY29uc3QgW2N1cnJlbnRCYXRjaExpc3RlbmVkU29uZ3MsIHNldEN1cnJlbnRCYXRjaExpc3RlbmVkU29uZ3NdID0gdXNlU3RhdGU8U29uZ1tdPihbXSk7XG4gIGNvbnN0IFtzb25nU3RhcnRUaW1lLCBzZXRTb25nU3RhcnRUaW1lXSA9IHVzZVN0YXRlPERhdGUgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2JhdGNoU3RhcnRJbmRleCwgc2V0QmF0Y2hTdGFydEluZGV4XSA9IHVzZVN0YXRlKDApO1xuXG4gIC8vIFNodWZmbGUgYW5kIHJlcGVhdCBzdGF0ZVxuICBjb25zdCBbaXNTaHVmZmxlRW5hYmxlZCwgc2V0SXNTaHVmZmxlRW5hYmxlZF0gPSB1c2VTdGF0ZSh0cnVlKTsgLy8gU2h1ZmZsZSBvbiBieSBkZWZhdWx0XG4gIGNvbnN0IFtyZXBlYXRNb2RlLCBzZXRSZXBlYXRNb2RlXSA9IHVzZVN0YXRlPCdvZmYnIHwgJ29uY2UnIHwgJ2luZmluaXRlJz4oJ29mZicpO1xuXG4gIC8vIFNsZWVwIHRpbWVyXG4gIGNvbnN0IHtcbiAgICBzbGVlcFRpbWVyLFxuICAgIHJlbWFpbmluZ1RpbWUsXG4gICAgc3RhcnRUaW1lcixcbiAgICBjYW5jZWxUaW1lcixcbiAgICB0cmlnZ2VyQWZ0ZXJTb25nVGltZXIsXG4gICAgaXNBY3RpdmU6IGlzU2xlZXBUaW1lckFjdGl2ZVxuICB9ID0gdXNlU2xlZXBUaW1lcigpO1xuXG5jb25zdCBsb2FkTW9yZVNvbmdzID0gKCkgPT4ge1xuICBzZXREaXNwbGF5Q291bnQocHJldiA9PiBwcmV2ICsgMTUpO1xufTtcblxuY29uc3QgZGlzcGxheWVkU29uZ3MgPSBzb25ncy5zbGljZSgwLCBkaXNwbGF5Q291bnQpO1xudXNlRWZmZWN0KCgpID0+IHtcbiAgY29uc3QgbG9hZEF1ZGlvID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmIChjdXJyZW50U29uZz8uZmlsZV9pZCkge1xuICAgICAgY29uc3QgdXJsID0gYC9hcGkvYXVkaW8tcHJveHk/ZmlsZWlkPSR7Y3VycmVudFNvbmcuZmlsZV9pZH1gO1xuICAgICAgc2V0QXVkaW9VcmwodXJsKTtcblxuICAgICAgc2V0RHVyYXRpb24oMCk7XG4gICAgICBzZXRDdXJyZW50VGltZSgwKTtcbiAgICAgIHNldFBlbmRpbmdTZWVrVGltZShudWxsKTtcbiAgICB9XG4gIH07XG5cbiAgbG9hZEF1ZGlvKCk7XG59LCBbY3VycmVudFNvbmc/LmZpbGVfaWRdKTtcblxudXNlRWZmZWN0KCgpID0+IHtcbiAgaWYgKGF1ZGlvUmVmLmN1cnJlbnQpIHtcbiAgICBhdWRpb1JlZi5jdXJyZW50LnZvbHVtZSA9IHZvbHVtZTtcbiAgfVxufSwgW3ZvbHVtZV0pO1xuXG51c2VFZmZlY3QoKCkgPT4ge1xuICBjb25zdCBhdWRpbyA9IGF1ZGlvUmVmLmN1cnJlbnQ7XG4gIGlmICghYXVkaW8pIHJldHVybjtcblxuICBpZiAoIWlzTmFOKGF1ZGlvLmR1cmF0aW9uKSAmJiBpc1BsYXlpbmcpIHtcbiAgICAvLyBEdXJhdGlvbiBpcyB2YWxpZCwgc2FmZSB0byBwbGF5XG4gICAgYXVkaW8ucGxheSgpLmNhdGNoKChlKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCdQbGF5YmFjayBlcnJvcjonLCBlKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICghaXNQbGF5aW5nKSB7XG4gICAgYXVkaW8ucGF1c2UoKTtcbiAgfVxufSwgW2lzUGxheWluZ10pO1xuXG5cblxuXG4vLyBMb2FkIGltYWdlcyBmb3IgY3VycmVudGx5IGRpc3BsYXllZCBzb25nc1xudXNlRWZmZWN0KCgpID0+IHtcbiAgY29uc3QgZmV0Y2hJbWFnZXMgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbmV3VXJsczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuXG4gICAgLy8gU29uZ3MgZnJvbSB0aGUgbWFpbiBmZWVkXG4gICAgY29uc3Qgc29uZ3NUb0xvYWQgPSBzb25ncy5zbGljZSgwLCBkaXNwbGF5Q291bnQpO1xuICAgIGZvciAoY29uc3Qgc29uZyBvZiBzb25nc1RvTG9hZCkge1xuICAgICAgaWYgKCFpbWFnZVVybHNbc29uZy5pZF0pIHtcbiAgICAgICAgbmV3VXJsc1tzb25nLmlkXSA9IGAvYXBpL2ltYWdlLXByb3h5P2ZpbGVpZD0ke3NvbmcuaW1nX2lkfWA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU29uZ3MgZnJvbSBwbGF5bGlzdHNcbiAgICBmb3IgKGNvbnN0IHBsYXlsaXN0IG9mIHBsYXlsaXN0cykge1xuICAgICAgZm9yIChjb25zdCBzb25nIG9mIHBsYXlsaXN0LnNvbmdzKSB7XG4gICAgICAgIGlmICghaW1hZ2VVcmxzW3NvbmcuaWRdKSB7XG4gICAgICAgICAgbmV3VXJsc1tzb25nLmlkXSA9IGAvYXBpL2ltYWdlLXByb3h5P2ZpbGVpZD0ke3NvbmcuaW1nX2lkfWA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBMaWtlZCBzb25nc1xuICAgIGZvciAoY29uc3Qgc29uZyBvZiBsaWtlZFNvbmdzKSB7XG4gICAgICBpZiAoIWltYWdlVXJsc1tzb25nLmlkXSkge1xuICAgICAgICBuZXdVcmxzW3NvbmcuaWRdID0gYC9hcGkvaW1hZ2UtcHJveHk/ZmlsZWlkPSR7c29uZy5pbWdfaWR9YDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZWNlbnRseSBwbGF5ZWQgc29uZ3NcbiAgICBmb3IgKGNvbnN0IHNvbmcgb2YgcmVjZW50bHlQbGF5ZWRTb25ncykge1xuICAgICAgaWYgKCFpbWFnZVVybHNbc29uZy5pZF0pIHtcbiAgICAgICAgbmV3VXJsc1tzb25nLmlkXSA9IGAvYXBpL2ltYWdlLXByb3h5P2ZpbGVpZD0ke3NvbmcuaW1nX2lkfWA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgaWYgbmV3IFVSTHMgZm91bmRcbiAgICBpZiAoT2JqZWN0LmtleXMobmV3VXJscykubGVuZ3RoID4gMCkge1xuICAgICAgc2V0SW1hZ2VVcmxzKHByZXYgPT4gKHsgLi4ucHJldiwgLi4ubmV3VXJscyB9KSk7XG4gICAgfVxuICB9O1xuXG4gIGZldGNoSW1hZ2VzKCk7XG59LCBbZGlzcGxheUNvdW50LCBzb25ncywgcGxheWxpc3RzLCBsaWtlZFNvbmdzLCByZWNlbnRseVBsYXllZFNvbmdzXSk7XG5cblxudXNlRWZmZWN0KCgpID0+IHtcbiAgY29uc29sZS5sb2coJ/CfjrUgcGVyc29uYWxpemVkTGlzdCB1cGRhdGVkOicsIHBlcnNvbmFsaXplZExpc3QpO1xufSwgW3BlcnNvbmFsaXplZExpc3RdKTtcblxuICAvLyBTZXQgbGFzdCBwbGF5ZWQgc29uZyBhcyBjdXJyZW50IHNvbmcgd2hlbiBkYXRhIGxvYWRzIChvbmx5IG9uY2UgYW5kIGlmIG5vdCBkaXNtaXNzZWQpXG51c2VFZmZlY3QoKCkgPT4ge1xuICBjb25zdCBsb2FkTGFzdFBsYXllZEltYWdlID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmICh1c2VyICYmIGxhc3RQbGF5ZWRTb25nICYmICFoYXNTZXRMYXN0UGxheWVkU29uZyAmJiAhbGFzdFBsYXllZFNvbmdEaXNtaXNzZWQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn461IExvYWRpbmcgaW5pdGlhbCBwZXJzb25hbGl6ZWQgc29uZ3MgZm9yIGxhc3QgcGxheWVkIHNvbmcnKTtcbiAgICAgICAgY29uc3QgaW5pdGlhbFJlY3MgPSBhd2FpdCBnZXRQZXJzb25hbGl6ZWRTb25ncyh1c2VyLmlkLCBsYXN0UGxheWVkU29uZywgbGlzdGVuZWRTb25ncyk7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkID0gaW5pdGlhbFJlY3MuZmlsdGVyKHNvbmcgPT4gIXBsYXllZFNvbmdzLmhhcyhzb25nLmZpbGVfaWQudG9TdHJpbmcoKSkpO1xuICAgICAgICBjb25zdCBuZXdQZXJzb25hbGl6ZWRMaXN0ID0gW2xhc3RQbGF5ZWRTb25nLCAuLi5maWx0ZXJlZC5zbGljZSgwLCA0KV07XG4gICAgICAgIHNldFBlcnNvbmFsaXplZExpc3QobmV3UGVyc29uYWxpemVkTGlzdCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgSW5pdGlhbCBwZXJzb25hbGl6ZWQgbGlzdCBzZXQ6JywgbmV3UGVyc29uYWxpemVkTGlzdC5sZW5ndGgsICdzb25ncycpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGxvYWRpbmcgaW5pdGlhbCBwZXJzb25hbGl6ZWQgc29uZ3M6JywgZXJyb3IpO1xuICAgICAgICBzZXRQZXJzb25hbGl6ZWRMaXN0KFtsYXN0UGxheWVkU29uZ10pO1xuICAgICAgfVxuICAgICAgXG4gICAgICBzZXRDdXJyZW50U29uZyhsYXN0UGxheWVkU29uZyk7XG4gICAgICBzZXRIYXNTZXRMYXN0UGxheWVkU29uZyh0cnVlKTtcblxuICAgICAgLy8gQWRkIHRvIGxpc3RlbmVkIHNvbmdzIGFuZCBsb2dcbiAgICAgIHNldExpc3RlbmVkU29uZ3MocHJldiA9PiB7XG4gICAgICAgIGNvbnN0IG5ld1NldCA9IG5ldyBTZXQocHJldik7XG4gICAgICAgIG5ld1NldC5hZGQobGFzdFBsYXllZFNvbmcuZmlsZV9pZC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc29sZS5sb2coJ/CfjrUgTGlzdGVuZWQgU29uZ3MgTGlzdDonLCBBcnJheS5mcm9tKG5ld1NldCkpO1xuICAgICAgICByZXR1cm4gbmV3U2V0O1xuICAgICAgfSk7XG5cbiAgICAgIGlmICghaW1hZ2VVcmxzW2xhc3RQbGF5ZWRTb25nLmltZ19pZF0pIHtcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvaW1hZ2UtcHJveHk/ZmlsZWlkPSR7bGFzdFBsYXllZFNvbmcuaW1nX2lkfWA7XG4gICAgICAgIHNldEltYWdlVXJscygocHJldikgPT4gKHtcbiAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgIFtsYXN0UGxheWVkU29uZy5pbWdfaWRdOiB1cmxcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBsb2FkTGFzdFBsYXllZEltYWdlKCk7XG59LCBbbGFzdFBsYXllZFNvbmcsIGhhc1NldExhc3RQbGF5ZWRTb25nLCBsYXN0UGxheWVkU29uZ0Rpc21pc3NlZCwgdXNlciwgZ2V0UGVyc29uYWxpemVkU29uZ3NdKTtcblxuXG5jb25zdCBoYW5kbGVTb25nUGxheSA9IGFzeW5jIChzb25nOiBTb25nKSA9PiB7XG4gIC8vIFJlY29yZCBpZiBwcmV2aW91cyBzb25nIHdhcyBsaXN0ZW5lZCB0byAoPjIwIHNlY29uZHMpXG4gIGlmIChjdXJyZW50U29uZyAmJiBzb25nU3RhcnRUaW1lKSB7XG4gICAgY29uc3QgbGlzdGVuRHVyYXRpb24gPSAobmV3IERhdGUoKS5nZXRUaW1lKCkgLSBzb25nU3RhcnRUaW1lLmdldFRpbWUoKSkgLyAxMDAwO1xuICAgIGlmIChsaXN0ZW5EdXJhdGlvbiA+IDIwKSB7XG4gICAgICBjb25zb2xlLmxvZyhg4pyFIFVzZXIgbGlzdGVuZWQgdG8gXCIke2N1cnJlbnRTb25nLm5hbWV9XCIgZm9yICR7bGlzdGVuRHVyYXRpb24udG9GaXhlZCgxKX0gc2Vjb25kc2ApO1xuICAgICAgc2V0Q3VycmVudEJhdGNoTGlzdGVuZWRTb25ncyhwcmV2ID0+IHtcbiAgICAgICAgY29uc3QgZXhpc3RzID0gcHJldi5zb21lKHMgPT4gcy5maWxlX2lkID09PSBjdXJyZW50U29uZy5maWxlX2lkKTtcbiAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICBjb25zdCB1cGRhdGVkID0gWy4uLnByZXYsIGN1cnJlbnRTb25nXTtcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+OtSBDdXJyZW50IGJhdGNoIGxpc3RlbmVkIHNvbmdzOicsIHVwZGF0ZWQubWFwKHMgPT4gcy5uYW1lKSk7XG4gICAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coYOKPre+4jyBVc2VyIHNraXBwZWQgXCIke2N1cnJlbnRTb25nLm5hbWV9XCIgYWZ0ZXIgJHtsaXN0ZW5EdXJhdGlvbi50b0ZpeGVkKDEpfSBzZWNvbmRzYCk7XG4gICAgfVxuICB9XG5cbiAgc2V0Q3VycmVudFNvbmcoc29uZyk7XG4gIHNldElzUGxheWluZyh0cnVlKTtcbiAgc2V0TGFzdFBsYXllZFNvbmdEaXNtaXNzZWQoZmFsc2UpO1xuICByZWNvcmRMaXN0ZW5pbmdIaXN0b3J5KHNvbmcuaWQpO1xuICBzZXRTb25nU3RhcnRUaW1lKG5ldyBEYXRlKCkpOyAvLyBUcmFjayB3aGVuIHRoaXMgc29uZyBzdGFydGVkXG5cbiAgLy8gQWRkIHRvIGxpc3RlbmVkIHNvbmdzIGFuZCBsb2dcbiAgc2V0TGlzdGVuZWRTb25ncyhwcmV2ID0+IHtcbiAgICBjb25zdCBuZXdTZXQgPSBuZXcgU2V0KHByZXYpO1xuICAgIG5ld1NldC5hZGQoc29uZy5maWxlX2lkLnRvU3RyaW5nKCkpO1xuICAgIGNvbnNvbGUubG9nKCfwn461IExpc3RlbmVkIFNvbmdzIExpc3Q6JywgQXJyYXkuZnJvbShuZXdTZXQpKTtcbiAgICByZXR1cm4gbmV3U2V0O1xuICB9KTtcblxuICBzZXRQbGF5ZWRTb25ncygocHJldikgPT4ge1xuICAgIGNvbnN0IHVwZGF0ZWQgPSBuZXcgU2V0KHByZXYpO1xuICAgIHVwZGF0ZWQuYWRkKHNvbmcuZmlsZV9pZC50b1N0cmluZygpKTtcbiAgICByZXR1cm4gdXBkYXRlZDtcbiAgfSk7XG5cbiAgaWYgKHVzZXIpIHtcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ/CfjrUgRmV0Y2hpbmcgcGVyc29uYWxpemVkIHNvbmdzIGZvcjonLCBzb25nLm5hbWUpO1xuICAgICAgY29uc3QgcmVjcyA9IGF3YWl0IGdldFBlcnNvbmFsaXplZFNvbmdzKHVzZXIuaWQsIHNvbmcsIGxpc3RlbmVkU29uZ3MpO1xuICAgICAgY29uc3QgZmlsdGVyZWQgPSByZWNzLmZpbHRlcihzID0+ICFwbGF5ZWRTb25ncy5oYXMocy5maWxlX2lkLnRvU3RyaW5nKCkpKTtcbiAgICAgIGNvbnN0IG5ld1BlcnNvbmFsaXplZExpc3QgPSBbc29uZywgLi4uZmlsdGVyZWQuc2xpY2UoMCwgNCldO1xuICAgICAgc2V0UGVyc29uYWxpemVkTGlzdChuZXdQZXJzb25hbGl6ZWRMaXN0KTtcbiAgICAgIHNldEN1cnJlbnRTb25nSW5kZXgoMCk7XG4gICAgICBzZXRCYXRjaFN0YXJ0SW5kZXgoMCk7XG4gICAgICBzZXRDdXJyZW50QmF0Y2hMaXN0ZW5lZFNvbmdzKFtdKTsgLy8gUmVzZXQgYmF0Y2ggZm9yIG5ldyBzb25nIHNlbGVjdGlvblxuICAgICAgY29uc29sZS5sb2coJ+KchSBOZXcgcGVyc29uYWxpemVkIGxpc3Qgc2V0OicsIG5ld1BlcnNvbmFsaXplZExpc3QubGVuZ3RoLCAnc29uZ3MnKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGZldGNoaW5nIHBlcnNvbmFsaXplZCBzb25nczonLCBlcnJvcik7XG4gICAgICBzZXRQZXJzb25hbGl6ZWRMaXN0KFtzb25nXSk7XG4gICAgICBzZXRDdXJyZW50U29uZ0luZGV4KDApO1xuICAgICAgc2V0QmF0Y2hTdGFydEluZGV4KDApO1xuICAgICAgc2V0Q3VycmVudEJhdGNoTGlzdGVuZWRTb25ncyhbXSk7XG4gICAgfVxuICB9XG59O1xuXG5cbiAgY29uc3QgaGFuZGxlQWRkVG9RdWV1ZSA9IChzb25nOiBTb25nKSA9PiB7XG4gIGFkZFRvUXVldWUoc29uZyk7XG4gIHRvYXN0LnN1Y2Nlc3MoYEFkZGVkIFwiJHtzb25nLm5hbWV9XCIgdG8gcXVldWVgKTtcbn07XG5cbiAgY29uc3QgdG9nZ2xlUGxheSA9ICgpID0+IHtcbiAgICBzZXRJc1BsYXlpbmcoIWlzUGxheWluZyk7XG4gIH07XG5cbiAgY29uc3QgdG9nZ2xlUGxheWVyU2l6ZSA9ICgpID0+IHtcbiAgICBzZXRJc1BsYXllck1heGltaXplZCghaXNQbGF5ZXJNYXhpbWl6ZWQpO1xuICB9O1xuXG4gIGNvbnN0IGNsb3NlUGxheWVyID0gYXN5bmMgKCkgPT4ge1xuICAgIC8vIFN0b3AgdHJhY2tpbmcgY3VycmVudCBzb25nIGJlZm9yZSBjbG9zaW5nXG4gICAgYXdhaXQgc3RvcEN1cnJlbnRTb25nVHJhY2tpbmcoKTtcbiAgICBzZXRDdXJyZW50U29uZyhudWxsKTtcbiAgICBzZXRJc1BsYXlpbmcoZmFsc2UpO1xuICAgIHNldElzUGxheWVyTWF4aW1pemVkKGZhbHNlKTtcbiAgICBcbiAgICAvLyBNYXJrIGxhc3QgcGxheWVkIHNvbmcgYXMgZGlzbWlzc2VkIHNvIGl0IHdvbid0IGF1dG8tbG9hZCBhZ2FpblxuICAgIHNldExhc3RQbGF5ZWRTb25nRGlzbWlzc2VkKHRydWUpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZVRvZ2dsZUxpa2UgPSAoc29uZ0lkOiBzdHJpbmcpID0+IHtcbiAgICB0b2dnbGVMaWtlKHNvbmdJZCk7XG4gICAgXG4gICAgLy8gVXBkYXRlIGN1cnJlbnQgc29uZyBzdGF0ZSBpZiBpdCdzIHRoZSBvbmUgYmVpbmcgbGlrZWQvdW5saWtlZFxuICAgIGlmIChjdXJyZW50U29uZyAmJiBjdXJyZW50U29uZy5pZCA9PT0gc29uZ0lkKSB7XG4gICAgICBzZXRDdXJyZW50U29uZyhwcmV2ID0+IHByZXYgPyB7IC4uLnByZXYsIGlzTGlrZWQ6ICFwcmV2LmlzTGlrZWQgfSA6IG51bGwpO1xuICAgIH1cbiAgfTtcblxuY29uc3QgaGFuZGxlUHJldmlvdXMgPSAoKSA9PiB7XG4gIC8vIFJlY29yZCBpZiBjdXJyZW50IHNvbmcgd2FzIGxpc3RlbmVkIHRvIGJlZm9yZSBnb2luZyB0byBwcmV2aW91c1xuICBpZiAoY3VycmVudFNvbmcgJiYgc29uZ1N0YXJ0VGltZSkge1xuICAgIGNvbnN0IGxpc3RlbkR1cmF0aW9uID0gKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gc29uZ1N0YXJ0VGltZS5nZXRUaW1lKCkpIC8gMTAwMDtcbiAgICBpZiAobGlzdGVuRHVyYXRpb24gPiAyMCkge1xuICAgICAgY29uc29sZS5sb2coYOKchSBVc2VyIGxpc3RlbmVkIHRvIFwiJHtjdXJyZW50U29uZy5uYW1lfVwiIGZvciAke2xpc3RlbkR1cmF0aW9uLnRvRml4ZWQoMSl9IHNlY29uZHNgKTtcbiAgICAgIHNldEN1cnJlbnRCYXRjaExpc3RlbmVkU29uZ3MocHJldiA9PiB7XG4gICAgICAgIGNvbnN0IGV4aXN0cyA9IHByZXYuc29tZShzID0+IHMuZmlsZV9pZCA9PT0gY3VycmVudFNvbmcuZmlsZV9pZCk7XG4gICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgY29uc3QgdXBkYXRlZCA9IFsuLi5wcmV2LCBjdXJyZW50U29uZ107XG4gICAgICAgICAgY29uc29sZS5sb2coJ/CfjrUgQ3VycmVudCBiYXRjaCBsaXN0ZW5lZCBzb25nczonLCB1cGRhdGVkLm1hcChzID0+IHMubmFtZSkpO1xuICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmV2O1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFjdXJyZW50U29uZykgcmV0dXJuO1xuXG4gIC8vIENoZWNrIGlmIHRoZXJlJ3MgYSBwcmV2aW91cyBzb25nIGluIHRoZSBwZXJzb25hbGl6ZWQgbGlzdFxuICBpZiAoY3VycmVudFNvbmdJbmRleCA+IDApIHtcbiAgICBjb25zdCBwcmV2SW5kZXggPSBjdXJyZW50U29uZ0luZGV4IC0gMTtcbiAgICBjb25zdCBwcmV2U29uZyA9IHBlcnNvbmFsaXplZExpc3RbcHJldkluZGV4XTtcbiAgICBcbiAgICBpZiAocHJldlNvbmcpIHtcbiAgICAgIHNldEN1cnJlbnRTb25nKHByZXZTb25nKTtcbiAgICAgIHNldEN1cnJlbnRTb25nSW5kZXgocHJldkluZGV4KTtcbiAgICAgIHNldElzUGxheWluZyh0cnVlKTtcbiAgICAgIHNldExhc3RQbGF5ZWRTb25nRGlzbWlzc2VkKGZhbHNlKTtcbiAgICAgIHJlY29yZExpc3RlbmluZ0hpc3RvcnkocHJldlNvbmcuaWQpO1xuICAgICAgc2V0U29uZ1N0YXJ0VGltZShuZXcgRGF0ZSgpKTtcblxuICAgICAgLy8gQWRkIHRvIGxpc3RlbmVkIHNvbmdzIGFuZCBsb2dcbiAgICAgIHNldExpc3RlbmVkU29uZ3MocHJldiA9PiB7XG4gICAgICAgIGNvbnN0IG5ld1NldCA9IG5ldyBTZXQocHJldik7XG4gICAgICAgIG5ld1NldC5hZGQocHJldlNvbmcuZmlsZV9pZC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc29sZS5sb2coJ/CfjrUgTGlzdGVuZWQgU29uZ3MgTGlzdDonLCBBcnJheS5mcm9tKG5ld1NldCkpO1xuICAgICAgICByZXR1cm4gbmV3U2V0O1xuICAgICAgfSk7XG5cbiAgICAgIHNldFBsYXllZFNvbmdzKChwcmV2KSA9PiB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBuZXcgU2V0KHByZXYpO1xuICAgICAgICB1cGRhdGVkLmFkZChwcmV2U29uZy5maWxlX2lkLnRvU3RyaW5nKCkpO1xuICAgICAgICByZXR1cm4gdXBkYXRlZDtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBQcmVsb2FkIGltYWdlXG4gICAgICBpZiAoIWltYWdlVXJsc1twcmV2U29uZy5pbWdfaWRdKSB7XG4gICAgICAgIGNvbnN0IG5ld1VybCA9IGAvYXBpL2ltYWdlLXByb3h5P2ZpbGVpZD0ke3ByZXZTb25nLmltZ19pZH1gO1xuICAgICAgICBzZXRJbWFnZVVybHMocHJldiA9PiAoeyAuLi5wcmV2LCBbcHJldlNvbmcuaW1nX2lkXTogbmV3VXJsIH0pKTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gSWYgYXQgdGhlIGJlZ2lubmluZywganVzdCByZXN0YXJ0IGN1cnJlbnQgc29uZ1xuICAgIHNldEN1cnJlbnRUaW1lKDApO1xuICAgIHNldElzUGxheWluZyh0cnVlKTtcbiAgfVxufTtcblxudXNlRWZmZWN0KCgpID0+IHtcbiAgaWYgKCFjdXJyZW50U29uZykgcmV0dXJuO1xuXG4gIGNvbnN0IGN1cnJlbnRJbmRleCA9IHNvbmdzLmZpbmRJbmRleChzb25nID0+IHNvbmcuaWQgPT09IGN1cnJlbnRTb25nLmlkKTtcbiAgY29uc3QgbmV4dEluZGV4ID0gY3VycmVudEluZGV4IDwgc29uZ3MubGVuZ3RoIC0gMSA/IGN1cnJlbnRJbmRleCArIDEgOiAwO1xuICBjb25zdCBuZXh0U29uZyA9IHNvbmdzW25leHRJbmRleF07XG5cbiAgLy8gUHJlbG9hZCBuZXh0IHNvbmcgaW1hZ2UgaWYgbm90IGluIGNhY2hlXG4gIGlmIChuZXh0U29uZyAmJiAhaW1hZ2VVcmxzW25leHRTb25nLmltZ19pZF0pIHtcbiAgICBjb25zdCBuZXdVcmwgPSBgL2FwaS9pbWFnZS1wcm94eT9maWxlaWQ9JHtuZXh0U29uZy5pbWdfaWR9YDtcbiAgICBzZXRJbWFnZVVybHMocHJldiA9PiAoeyAuLi5wcmV2LCBbbmV4dFNvbmcuaW1nX2lkXTogbmV3VXJsIH0pKTtcbiAgfVxufSwgW2N1cnJlbnRTb25nLCBzb25nc10pO1xuXG5jb25zdCBoYW5kbGVMb2FkZWRNZXRhZGF0YSA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgYXVkaW8gPSBhdWRpb1JlZi5jdXJyZW50O1xuICBpZiAoIWF1ZGlvKSByZXR1cm47XG5cbiAgY29uc3QgbG9hZGVkRHVyYXRpb24gPSBhdWRpby5kdXJhdGlvbjtcblxuICBpZiAoIWlzTmFOKGxvYWRlZER1cmF0aW9uKSAmJiBpc0Zpbml0ZShsb2FkZWREdXJhdGlvbikpIHtcbiAgICBzZXREdXJhdGlvbihsb2FkZWREdXJhdGlvbik7XG5cbiAgICBpZiAocGVuZGluZ1NlZWtUaW1lICE9PSBudWxsKSB7XG4gICAgICBhdWRpby5jdXJyZW50VGltZSA9IHBlbmRpbmdTZWVrVGltZTtcbiAgICAgIHNldEN1cnJlbnRUaW1lKHBlbmRpbmdTZWVrVGltZSk7XG4gICAgICBzZXRQZW5kaW5nU2Vla1RpbWUobnVsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldEN1cnJlbnRUaW1lKGF1ZGlvLmN1cnJlbnRUaW1lKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgaWYgKGlzUGxheWluZykge1xuICAgICAgICBhd2FpdCBhdWRpby5wbGF5KCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdBdXRvLXBsYXkgZXJyb3IgYWZ0ZXIgbWV0YWRhdGEgbG9hZDonLCBlcnIpO1xuICAgIH1cblxuICB9IGVsc2Uge1xuICAgIC8vIFJldHJ5IG1ldGFkYXRhIHJlYWRcbiAgICBzZXRUaW1lb3V0KGhhbmRsZUxvYWRlZE1ldGFkYXRhLCAxMDApO1xuICB9XG59O1xuXG5cblxuY29uc3QgaGFuZGxlTmV4dCA9IGFzeW5jICgpID0+IHtcbiAgLy8gUmVjb3JkIGlmIGN1cnJlbnQgc29uZyB3YXMgbGlzdGVuZWQgdG8gYmVmb3JlIGdvaW5nIHRvIG5leHRcbiAgaWYgKGN1cnJlbnRTb25nICYmIHNvbmdTdGFydFRpbWUpIHtcbiAgICBjb25zdCBsaXN0ZW5EdXJhdGlvbiA9IChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHNvbmdTdGFydFRpbWUuZ2V0VGltZSgpKSAvIDEwMDA7XG4gICAgaWYgKGxpc3RlbkR1cmF0aW9uID4gMjApIHtcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgVXNlciBsaXN0ZW5lZCB0byBcIiR7Y3VycmVudFNvbmcubmFtZX1cIiBmb3IgJHtsaXN0ZW5EdXJhdGlvbi50b0ZpeGVkKDEpfSBzZWNvbmRzYCk7XG4gICAgICBzZXRDdXJyZW50QmF0Y2hMaXN0ZW5lZFNvbmdzKHByZXYgPT4ge1xuICAgICAgICBjb25zdCBleGlzdHMgPSBwcmV2LnNvbWUocyA9PiBzLmZpbGVfaWQgPT09IGN1cnJlbnRTb25nLmZpbGVfaWQpO1xuICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBbLi4ucHJldiwgY3VycmVudFNvbmddO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn461IEN1cnJlbnQgYmF0Y2ggbGlzdGVuZWQgc29uZ3M6JywgdXBkYXRlZC5tYXAocyA9PiBzLm5hbWUpKTtcbiAgICAgICAgICByZXR1cm4gdXBkYXRlZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJldjtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhg4o+t77iPIFVzZXIgc2tpcHBlZCBcIiR7Y3VycmVudFNvbmcubmFtZX1cIiBhZnRlciAke2xpc3RlbkR1cmF0aW9uLnRvRml4ZWQoMSl9IHNlY29uZHNgKTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWN1cnJlbnRTb25nKSByZXR1cm47XG5cbiAgLy8gQ2hlY2sgaWYgdGhlcmUncyBhIHNvbmcgaW4gdGhlIHF1ZXVlIGZpcnN0XG4gIGNvbnN0IG5leHRRdWV1ZVNvbmcgPSBnZXROZXh0U29uZ0Zyb21RdWV1ZSgpO1xuICBpZiAobmV4dFF1ZXVlU29uZykge1xuICAgIHNldEN1cnJlbnRTb25nKG5leHRRdWV1ZVNvbmcpO1xuICAgIHNldElzUGxheWluZyh0cnVlKTtcbiAgICBzZXRMYXN0UGxheWVkU29uZ0Rpc21pc3NlZChmYWxzZSk7XG4gICAgcmVjb3JkTGlzdGVuaW5nSGlzdG9yeShuZXh0UXVldWVTb25nLmlkKTtcbiAgICBzZXRTb25nU3RhcnRUaW1lKG5ldyBEYXRlKCkpO1xuICAgIFxuICAgIC8vIEFkZCB0byBsaXN0ZW5lZCBzb25ncyBhbmQgbG9nXG4gICAgc2V0TGlzdGVuZWRTb25ncyhwcmV2ID0+IHtcbiAgICAgIGNvbnN0IG5ld1NldCA9IG5ldyBTZXQocHJldik7XG4gICAgICBuZXdTZXQuYWRkKG5leHRRdWV1ZVNvbmcuZmlsZV9pZC50b1N0cmluZygpKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn461IExpc3RlbmVkIFNvbmdzIExpc3Q6JywgQXJyYXkuZnJvbShuZXdTZXQpKTtcbiAgICAgIHJldHVybiBuZXdTZXQ7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gVXBkYXRlIHBlcnNvbmFsaXplZCBsaXN0IHdpdGggdGhlIHF1ZXVlIHNvbmdcbiAgICBpZiAodXNlcikge1xuICAgICAgY29uc3QgcmVjcyA9IGF3YWl0IGdldFBlcnNvbmFsaXplZFNvbmdzKHVzZXIuaWQsIG5leHRRdWV1ZVNvbmcsIGxpc3RlbmVkU29uZ3MpO1xuICAgICAgY29uc3QgZmlsdGVyZWQgPSByZWNzLmZpbHRlcihzID0+ICFwbGF5ZWRTb25ncy5oYXMoU3RyaW5nKHMuZmlsZV9pZCkpKTtcbiAgICAgIGNvbnN0IG5ld1BlcnNvbmFsaXplZExpc3QgPSBbbmV4dFF1ZXVlU29uZywgLi4uZmlsdGVyZWQuc2xpY2UoMCwgNCldO1xuICAgICAgc2V0UGVyc29uYWxpemVkTGlzdChuZXdQZXJzb25hbGl6ZWRMaXN0KTtcbiAgICAgIHNldEN1cnJlbnRTb25nSW5kZXgoMCk7XG4gICAgfVxuICAgIFxuICAgIC8vIFByZWxvYWQgaW1hZ2VcbiAgICBpZiAoIWltYWdlVXJsc1tuZXh0UXVldWVTb25nLmltZ19pZF0pIHtcbiAgICAgIGNvbnN0IG5ld1VybCA9IGAvYXBpL2ltYWdlLXByb3h5P2ZpbGVpZD0ke25leHRRdWV1ZVNvbmcuaW1nX2lkfWA7XG4gICAgICBzZXRJbWFnZVVybHMocHJldiA9PiAoeyAuLi5wcmV2LCBbbmV4dFF1ZXVlU29uZy5pbWdfaWRdOiBuZXdVcmwgfSkpO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBDaGVjayBpZiB3ZSdyZSBhdCB0aGUgc2Vjb25kLXRvLWxhc3Qgc29uZyBhbmQgbmVlZCB0byBmZXRjaCBzbWFydCByZWNvbW1lbmRhdGlvbnNcbiAgaWYgKGN1cnJlbnRTb25nSW5kZXggPT09IHBlcnNvbmFsaXplZExpc3QubGVuZ3RoIC0gMiAmJiAhaXNGZXRjaGluZ01vcmUgJiYgdXNlciAmJiBjdXJyZW50U29uZykge1xuICAgIGNvbnNvbGUubG9nKCfwn6egIEF0IHNlY29uZC10by1sYXN0IHNvbmcsIGNoZWNraW5nIGZvciBzbWFydCByZWNvbW1lbmRhdGlvbnMuLi4nKTtcbiAgICBzZXRJc0ZldGNoaW5nTW9yZSh0cnVlKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgbGV0IG5ld1JlY3M6IFNvbmdbXSA9IFtdO1xuICAgICAgXG4gICAgICAvLyBJZiB3ZSBoYXZlIHNvbmdzIHRoYXQgdXNlciBhY3R1YWxseSBsaXN0ZW5lZCB0byBpbiBjdXJyZW50IGJhdGNoLCB1c2Ugc21hcnQgcmVjb21tZW5kYXRpb25zXG4gICAgICBpZiAoY3VycmVudEJhdGNoTGlzdGVuZWRTb25ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn6egIFVzaW5nIHNtYXJ0IHJlY29tbWVuZGF0aW9ucyBiYXNlZCBvbiBsaXN0ZW5lZCBzb25ncycpO1xuICAgICAgICBuZXdSZWNzID0gYXdhaXQgZ2V0U21hcnRQZXJzb25hbGl6ZWRTb25ncyhcbiAgICAgICAgICB1c2VyLmlkLCBcbiAgICAgICAgICBjdXJyZW50QmF0Y2hMaXN0ZW5lZFNvbmdzLCBcbiAgICAgICAgICBuZXcgU2V0KFsuLi5BcnJheS5mcm9tKGxpc3RlbmVkU29uZ3MpLCAuLi5wZXJzb25hbGl6ZWRMaXN0Lm1hcChzID0+IHMuZmlsZV9pZC50b1N0cmluZygpKV0pXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+OtSBObyBsaXN0ZW5lZCBzb25ncyBpbiBiYXRjaCwgdXNpbmcgcmVndWxhciByZWNvbW1lbmRhdGlvbnMnKTtcbiAgICAgICAgbmV3UmVjcyA9IGF3YWl0IGdldFBlcnNvbmFsaXplZFNvbmdzKHVzZXIuaWQsIGN1cnJlbnRTb25nLCBsaXN0ZW5lZFNvbmdzKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgZmlsdGVyZWQgPSBuZXdSZWNzLmZpbHRlcihzb25nID0+IFxuICAgICAgICAhcGxheWVkU29uZ3MuaGFzKHNvbmcuZmlsZV9pZC50b1N0cmluZygpKSAmJlxuICAgICAgICAhbGlzdGVuZWRTb25ncy5oYXMoc29uZy5maWxlX2lkLnRvU3RyaW5nKCkpICYmXG4gICAgICAgICFwZXJzb25hbGl6ZWRMaXN0LnNvbWUoZXhpc3RpbmcgPT4gZXhpc3RpbmcuZmlsZV9pZCA9PT0gc29uZy5maWxlX2lkKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgaWYgKGZpbHRlcmVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc2V0UGVyc29uYWxpemVkTGlzdChwcmV2ID0+IFsuLi5wcmV2LCAuLi5maWx0ZXJlZC5zbGljZSgwLCA1KV0pO1xuICAgICAgICBjb25zb2xlLmxvZygn4pyFIEFkZGVkJywgZmlsdGVyZWQuc2xpY2UoMCwgNSkubGVuZ3RoLCAnc21hcnQgcmVjb21tZW5kYXRpb25zIHRvIHBlcnNvbmFsaXplZCBsaXN0Jyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBmZXRjaGluZyBzbWFydCByZWNvbW1lbmRhdGlvbnM6JywgZXJyb3IpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc0ZldGNoaW5nTW9yZShmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgLy8gSWYgbm8gcXVldWUsIHByb2NlZWQgd2l0aCBwZXJzb25hbGl6ZWQgbGlzdFxuICBjb25zdCBuZXh0SW5kZXggPSBjdXJyZW50U29uZ0luZGV4ICsgMTtcblxuICBpZiAobmV4dEluZGV4IDwgcGVyc29uYWxpemVkTGlzdC5sZW5ndGgpIHtcbiAgICBjb25zdCBuZXh0U29uZyA9IHBlcnNvbmFsaXplZExpc3RbbmV4dEluZGV4XTtcbiAgICBzZXRDdXJyZW50U29uZyhuZXh0U29uZyk7XG4gICAgc2V0Q3VycmVudFNvbmdJbmRleChuZXh0SW5kZXgpO1xuICAgIHNldElzUGxheWluZyh0cnVlKTtcbiAgICBzZXRMYXN0UGxheWVkU29uZ0Rpc21pc3NlZChmYWxzZSk7XG4gICAgcmVjb3JkTGlzdGVuaW5nSGlzdG9yeShuZXh0U29uZy5pZCk7XG4gICAgc2V0U29uZ1N0YXJ0VGltZShuZXcgRGF0ZSgpKTtcblxuICAgIC8vIEFkZCB0byBsaXN0ZW5lZCBzb25ncyBhbmQgbG9nXG4gICAgc2V0TGlzdGVuZWRTb25ncyhwcmV2ID0+IHtcbiAgICAgIGNvbnN0IG5ld1NldCA9IG5ldyBTZXQocHJldik7XG4gICAgICBuZXdTZXQuYWRkKG5leHRTb25nLmZpbGVfaWQudG9TdHJpbmcoKSk7XG4gICAgICBjb25zb2xlLmxvZygn8J+OtSBMaXN0ZW5lZCBTb25ncyBMaXN0OicsIEFycmF5LmZyb20obmV3U2V0KSk7XG4gICAgICByZXR1cm4gbmV3U2V0O1xuICAgIH0pO1xuXG4gICAgc2V0UGxheWVkU29uZ3MoKHByZXYpID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBuZXcgU2V0KHByZXYpO1xuICAgICAgdXBkYXRlZC5hZGQoU3RyaW5nKG5leHRTb25nLmZpbGVfaWQpKTtcbiAgICAgIHJldHVybiB1cGRhdGVkO1xuICAgIH0pO1xuXG4gICAgLy8gUHJlbG9hZCBpbWFnZVxuICAgIGlmICghaW1hZ2VVcmxzW25leHRTb25nLmltZ19pZF0pIHtcbiAgICAgIGNvbnN0IG5ld1VybCA9IGAvYXBpL2ltYWdlLXByb3h5P2ZpbGVpZD0ke25leHRTb25nLmltZ19pZH1gO1xuICAgICAgc2V0SW1hZ2VVcmxzKHByZXYgPT4gKHsgLi4ucHJldiwgW25leHRTb25nLmltZ19pZF06IG5ld1VybCB9KSk7XG4gICAgfVxuXG4gIH0gZWxzZSB7XG4gICAgLy8gSWYgd2UndmUgcmVhY2hlZCB0aGUgZW5kIG9mIHBlcnNvbmFsaXplZCBsaXN0LCBnZXQgbmV3IHNtYXJ0IHJlY29tbWVuZGF0aW9uc1xuICAgIGlmICh1c2VyICYmIGN1cnJlbnRTb25nKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+noCBSZWFjaGVkIGVuZCBvZiBsaXN0LCBmZXRjaGluZyBuZXcgc21hcnQgcmVjb21tZW5kYXRpb25zJyk7XG4gICAgICAgIFxuICAgICAgICBsZXQgbmV3UmVjczogU29uZ1tdID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBVc2Ugc21hcnQgcmVjb21tZW5kYXRpb25zIGlmIHdlIGhhdmUgbGlzdGVuZWQgc29uZ3MgaW4gY3VycmVudCBiYXRjaFxuICAgICAgICBpZiAoY3VycmVudEJhdGNoTGlzdGVuZWRTb25ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/Cfp6AgVXNpbmcgc21hcnQgcmVjb21tZW5kYXRpb25zIGZvciBuZXcgYmF0Y2gnKTtcbiAgICAgICAgICBuZXdSZWNzID0gYXdhaXQgZ2V0U21hcnRQZXJzb25hbGl6ZWRTb25ncyhcbiAgICAgICAgICAgIHVzZXIuaWQsIFxuICAgICAgICAgICAgY3VycmVudEJhdGNoTGlzdGVuZWRTb25ncywgXG4gICAgICAgICAgICBsaXN0ZW5lZFNvbmdzXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+OtSBVc2luZyByZWd1bGFyIHJlY29tbWVuZGF0aW9ucyBmb3IgbmV3IGJhdGNoJyk7XG4gICAgICAgICAgbmV3UmVjcyA9IGF3YWl0IGdldFBlcnNvbmFsaXplZFNvbmdzKHVzZXIuaWQsIGN1cnJlbnRTb25nLCBsaXN0ZW5lZFNvbmdzKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBuZXdSZWNzLmZpbHRlcihzb25nID0+IFxuICAgICAgICAgICFwbGF5ZWRTb25ncy5oYXMoc29uZy5maWxlX2lkLnRvU3RyaW5nKCkpICYmXG4gICAgICAgICAgIWxpc3RlbmVkU29uZ3MuaGFzKHNvbmcuZmlsZV9pZC50b1N0cmluZygpKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgaWYgKGZpbHRlcmVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBuZXh0U29uZyA9IGZpbHRlcmVkWzBdO1xuICAgICAgICAgIHNldEN1cnJlbnRTb25nKG5leHRTb25nKTtcbiAgICAgICAgICBzZXRJc1BsYXlpbmcodHJ1ZSk7XG4gICAgICAgICAgc2V0TGFzdFBsYXllZFNvbmdEaXNtaXNzZWQoZmFsc2UpO1xuICAgICAgICAgIHJlY29yZExpc3RlbmluZ0hpc3RvcnkobmV4dFNvbmcuaWQpO1xuICAgICAgICAgIHNldFNvbmdTdGFydFRpbWUobmV3IERhdGUoKSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQWRkIHRvIGxpc3RlbmVkIHNvbmdzIGFuZCBsb2dcbiAgICAgICAgICBzZXRMaXN0ZW5lZFNvbmdzKHByZXYgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3U2V0ID0gbmV3IFNldChwcmV2KTtcbiAgICAgICAgICAgIG5ld1NldC5hZGQobmV4dFNvbmcuZmlsZV9pZC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn461IExpc3RlbmVkIFNvbmdzIExpc3Q6JywgQXJyYXkuZnJvbShuZXdTZXQpKTtcbiAgICAgICAgICAgIHJldHVybiBuZXdTZXQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQ3JlYXRlIG5ldyBwZXJzb25hbGl6ZWQgbGlzdCBzdGFydGluZyB3aXRoIHRoaXMgc29uZ1xuICAgICAgICAgIGNvbnN0IG5ld1BlcnNvbmFsaXplZExpc3QgPSBbbmV4dFNvbmcsIC4uLmZpbHRlcmVkLnNsaWNlKDEsIDUpXTtcbiAgICAgICAgICBzZXRQZXJzb25hbGl6ZWRMaXN0KG5ld1BlcnNvbmFsaXplZExpc3QpO1xuICAgICAgICAgIHNldEN1cnJlbnRTb25nSW5kZXgoMCk7XG4gICAgICAgICAgc2V0QmF0Y2hTdGFydEluZGV4KDApO1xuICAgICAgICAgIHNldEN1cnJlbnRCYXRjaExpc3RlbmVkU29uZ3MoW10pOyAvLyBSZXNldCBiYXRjaCBmb3IgbmV3IHJlY29tbWVuZGF0aW9uc1xuICAgICAgICAgIFxuICAgICAgICAgIHNldFBsYXllZFNvbmdzKChwcmV2KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gbmV3IFNldChwcmV2KTtcbiAgICAgICAgICAgIHVwZGF0ZWQuYWRkKG5leHRTb25nLmZpbGVfaWQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBQcmVsb2FkIGltYWdlXG4gICAgICAgICAgaWYgKCFpbWFnZVVybHNbbmV4dFNvbmcuaW1nX2lkXSkge1xuICAgICAgICAgICAgY29uc3QgbmV3VXJsID0gYC9hcGkvaW1hZ2UtcHJveHk/ZmlsZWlkPSR7bmV4dFNvbmcuaW1nX2lkfWA7XG4gICAgICAgICAgICBzZXRJbWFnZVVybHMocHJldiA9PiAoeyAuLi5wcmV2LCBbbmV4dFNvbmcuaW1nX2lkXTogbmV3VXJsIH0pKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgY29uc29sZS5sb2coJ+KchSBOZXcgc21hcnQgcmVjb21tZW5kYXRpb25zIGxvYWRlZDonLCBuZXdQZXJzb25hbGl6ZWRMaXN0Lmxlbmd0aCwgJ3NvbmdzJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gTm8gbW9yZSBzbWFydCByZWNvbW1lbmRhdGlvbnMgYXZhaWxhYmxlJyk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBmZXRjaGluZyBuZXcgc21hcnQgcmVjb21tZW5kYXRpb25zOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cblxuXG5cbiAgY29uc3QgZm9ybWF0TnVtYmVyID0gKG51bTogbnVtYmVyKTogc3RyaW5nID0+IHtcbiAgICBpZiAobnVtID49IDEwMDAwMDApIHtcbiAgICAgIHJldHVybiAobnVtIC8gMTAwMDAwMCkudG9GaXhlZCgxKSArICdNJztcbiAgICB9IGVsc2UgaWYgKG51bSA+PSAxMDAwKSB7XG4gICAgICByZXR1cm4gKG51bSAvIDEwMDApLnRvRml4ZWQoMSkgKyAnSyc7XG4gICAgfVxuICAgIHJldHVybiBudW0udG9TdHJpbmcoKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVBZGRUb1BsYXlsaXN0ID0gKHNvbmc6IFNvbmcpID0+IHtcbiAgICBzZXRTZWxlY3RlZFNvbmdGb3JQbGF5bGlzdChzb25nKTtcbiAgICBzZXRTaG93QWRkVG9QbGF5bGlzdE1vZGFsKHRydWUpO1xuICB9O1xuXG4gIGNvbnN0IGhhbmRsZVNvbmdFbmQgPSBhc3luYyAoKSA9PiB7XG4gICAgLy8gQ2hlY2sgaWYgc2xlZXAgdGltZXIgaXMgc2V0IHRvIFwiYWZ0ZXItc29uZ1wiIGFuZCB0cmlnZ2VyIGl0XG4gICAgaWYgKHNsZWVwVGltZXIgPT09ICdhZnRlci1zb25nJykge1xuICAgICAgdHJpZ2dlckFmdGVyU29uZ1RpbWVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIFJlY29yZCBpZiBzb25nIHdhcyBsaXN0ZW5lZCB0byBjb21wbGV0ZWx5IChhc3N1bWUgPjIwIHNlY29uZHMgaWYgaXQgZW5kZWQgbmF0dXJhbGx5KVxuICAgIGlmIChjdXJyZW50U29uZyAmJiBzb25nU3RhcnRUaW1lKSB7XG4gICAgICBjb25zdCBsaXN0ZW5EdXJhdGlvbiA9IChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHNvbmdTdGFydFRpbWUuZ2V0VGltZSgpKSAvIDEwMDA7XG4gICAgICBjb25zb2xlLmxvZyhg8J+OtSBTb25nIFwiJHtjdXJyZW50U29uZy5uYW1lfVwiIGVuZGVkIGFmdGVyICR7bGlzdGVuRHVyYXRpb24udG9GaXhlZCgxKX0gc2Vjb25kc2ApO1xuICAgICAgXG4gICAgICBpZiAobGlzdGVuRHVyYXRpb24gPiAyMCkge1xuICAgICAgICBzZXRDdXJyZW50QmF0Y2hMaXN0ZW5lZFNvbmdzKHByZXYgPT4ge1xuICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IHByZXYuc29tZShzID0+IHMuZmlsZV9pZCA9PT0gY3VycmVudFNvbmcuZmlsZV9pZCk7XG4gICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBbLi4ucHJldiwgY3VycmVudFNvbmddO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ/CfjrUgQ3VycmVudCBiYXRjaCBsaXN0ZW5lZCBzb25nczonLCB1cGRhdGVkLm1hcChzID0+IHMubmFtZSkpO1xuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBwcmV2O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIHJlcGVhdCBtb2Rlc1xuICAgIGlmIChyZXBlYXRNb2RlID09PSAnb25jZScgfHwgcmVwZWF0TW9kZSA9PT0gJ2luZmluaXRlJykge1xuICAgICAgLy8gUmVzdGFydCB0aGUgY3VycmVudCBzb25nXG4gICAgICBzZXRDdXJyZW50VGltZSgwKTtcbiAgICAgIHNldElzUGxheWluZyh0cnVlKTtcbiAgICAgIHNldFNvbmdTdGFydFRpbWUobmV3IERhdGUoKSk7XG4gICAgICBcbiAgICAgIC8vIElmIHJlcGVhdCBvbmNlLCB0dXJuIG9mZiByZXBlYXQgYWZ0ZXIgcGxheWluZyBvbmNlXG4gICAgICBpZiAocmVwZWF0TW9kZSA9PT0gJ29uY2UnKSB7XG4gICAgICAgIHNldFJlcGVhdE1vZGUoJ29mZicpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICAvLyBXaGVuIGEgc29uZyBlbmRzLCBhdXRvbWF0aWNhbGx5IHBsYXkgdGhlIG5leHQgb25lXG4gICAgYXdhaXQgaGFuZGxlTmV4dCgpO1xufTtcblxuICBjb25zdCBoYW5kbGVTbGVlcFRpbWVyU2V0ID0gKG1pbnV0ZXM6IG51bWJlciB8ICdhZnRlci1zb25nJyB8IG51bGwpID0+IHtcbiAgICBpZiAobWludXRlcyA9PT0gbnVsbCkge1xuICAgICAgY2FuY2VsVGltZXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhcnRUaW1lcihtaW51dGVzLCAoKSA9PiB7XG4gICAgICAgIHNldElzUGxheWluZyhmYWxzZSk7XG4gICAgICAgIHRvYXN0LnN1Y2Nlc3MoJ1NsZWVwIHRpbWVyIGVuZGVkIC0gbXVzaWMgc3RvcHBlZCcpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGlmICh0eXBlb2YgbWludXRlcyA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgdG9hc3Quc3VjY2VzcyhgU2xlZXAgdGltZXIgc2V0IGZvciAke21pbnV0ZXN9IG1pbnV0ZXNgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRvYXN0LnN1Y2Nlc3MoJ1NsZWVwIHRpbWVyIHNldCB0byBzdG9wIGFmdGVyIGN1cnJlbnQgc29uZycpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCByZW5kZXJDb250ZW50ID0gKCkgPT4ge1xuICAgIGlmIChjdXJyZW50UGFnZSA9PT0gJ3BsYXlsaXN0cycpIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxQbGF5bGlzdHNQYWdlIFxuICAgICAgICAgIHBsYXlsaXN0cz17cGxheWxpc3RzfSBcbiAgICAgICAgICBvbkJhY2s9eygpID0+IHNldEN1cnJlbnRQYWdlKCdtYWluJyl9IFxuICAgICAgICAgIG9uU29uZ1BsYXk9e2hhbmRsZVNvbmdQbGF5fVxuICAgICAgICAgIG9uQWRkVG9RdWV1ZT17aGFuZGxlQWRkVG9RdWV1ZX1cbiAgICAgICAgICBvbkNyZWF0ZVBsYXlsaXN0PXsoKSA9PiBzZXRTaG93Q3JlYXRlUGxheWxpc3RNb2RhbCh0cnVlKX1cbiAgICAgICAgICBvbkRlbGV0ZVBsYXlsaXN0PXtkZWxldGVQbGF5bGlzdH1cbiAgICAgICAgICBvblJlbmFtZVBsYXlsaXN0PXtyZW5hbWVQbGF5bGlzdH1cbiAgICAgICAgICBvblJlbW92ZVNvbmdGcm9tUGxheWxpc3Q9e3JlbW92ZVNvbmdGcm9tUGxheWxpc3R9XG4gICAgICAgICAgaW1hZ2VVcmxzPXtpbWFnZVVybHN9XG4gICAgICAgICAgY2xlYXJRdWV1ZT17Y2xlYXJRdWV1ZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIGlmIChjdXJyZW50UGFnZSA9PT0gJ2xpa2VkJykge1xuICAgICAgcmV0dXJuIDxMaWtlZFNvbmdzUGFnZSBzb25ncz17bGlrZWRTb25nc30gb25CYWNrPXsoKSA9PiBzZXRDdXJyZW50UGFnZSgnbWFpbicpfSBvblNvbmdQbGF5PXtoYW5kbGVTb25nUGxheX0gb25BZGRUb1F1ZXVlPXtoYW5kbGVBZGRUb1F1ZXVlfSBpbWFnZVVybHM9e2ltYWdlVXJsc30gY2xlYXJRdWV1ZT17Y2xlYXJRdWV1ZX0vPjtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKGFjdGl2ZVRhYikge1xuICAgICAgY2FzZSAnaG9tZSc6XG4gICAgICAgIHJldHVybiA8SG9tZVBhZ2VcbiAgICAgICAgICAgICAgICBzb25ncz17ZGlzcGxheWVkU29uZ3N9XG4gICAgICAgICAgICAgICAgcGVyc29uYWxpemVkU29uZ3M9e3BlcnNvbmFsaXplZFNvbmdzfVxuICAgICAgICAgICAgICAgIHJlY2VudGx5UGxheWVkU29uZ3M9e3JlY2VudGx5UGxheWVkU29uZ3N9XG4gICAgICAgICAgICAgICAgb25Tb25nUGxheT17aGFuZGxlU29uZ1BsYXl9XG4gICAgICAgICAgICAgICAgZm9ybWF0TnVtYmVyPXtmb3JtYXROdW1iZXJ9XG4gICAgICAgICAgICAgICAgb25BZGRUb1BsYXlsaXN0PXtoYW5kbGVBZGRUb1BsYXlsaXN0fVxuICAgICAgICAgICAgICAgIG9uQWRkVG9RdWV1ZT17aGFuZGxlQWRkVG9RdWV1ZX1cbiAgICAgICAgICAgICAgICBpbWFnZVVybHM9e2ltYWdlVXJsc31cbiAgICAgICAgICAgICAgICBvbkxvYWRNb3JlPXtsb2FkTW9yZVNvbmdzfVxuICAgICAgICAgICAgICAgIGhhc01vcmVTb25ncz17ZGlzcGxheUNvdW50IDwgc29uZ3MubGVuZ3RofVxuICAgICAgICAgICAgICAvPjtcbiAgICAgIGNhc2UgJ3NlYXJjaCc6XG4gICAgICAgIHJldHVybiA8U2VhcmNoUGFnZVxuICAgICAgICAgICAgICBzb25ncz17c29uZ3N9XG4gICAgICAgICAgICAgIG9uU29uZ1BsYXk9e2hhbmRsZVNvbmdQbGF5fVxuICAgICAgICAgICAgICBmb3JtYXROdW1iZXI9e2Zvcm1hdE51bWJlcn1cbiAgICAgICAgICAgICAgb25BZGRUb1BsYXlsaXN0PXtoYW5kbGVBZGRUb1BsYXlsaXN0fVxuICAgICAgICAgICAgICBvbkFkZFRvUXVldWU9e2hhbmRsZUFkZFRvUXVldWV9XG4gICAgICAgICAgICAgIGltYWdlVXJscz17aW1hZ2VVcmxzfVxuICAgICAgICAgICAgICBzZXRJbWFnZVVybHM9e3NldEltYWdlVXJsc31cbiAgICAgICAgICAgIC8+O1xuICAgICAgY2FzZSAnc2V0dGluZ3MnOlxuICAgICAgICByZXR1cm4gPFNldHRpbmdzUGFnZSBvblBsYXlsaXN0c0NsaWNrPXsoKSA9PiBzZXRDdXJyZW50UGFnZSgncGxheWxpc3RzJyl9IG9uTGlrZWRDbGljaz17KCkgPT4gc2V0Q3VycmVudFBhZ2UoJ2xpa2VkJyl9IC8+O1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIDxIb21lUGFnZVxuICAgICAgICAgICAgICBzb25ncz17ZGlzcGxheWVkU29uZ3N9XG4gICAgICAgICAgICAgIHBlcnNvbmFsaXplZFNvbmdzPXtwZXJzb25hbGl6ZWRTb25nc31cbiAgICAgICAgICAgICAgcmVjZW50bHlQbGF5ZWRTb25ncz17cmVjZW50bHlQbGF5ZWRTb25nc31cbiAgICAgICAgICAgICAgb25Tb25nUGxheT17aGFuZGxlU29uZ1BsYXl9XG4gICAgICAgICAgICAgIGZvcm1hdE51bWJlcj17Zm9ybWF0TnVtYmVyfVxuICAgICAgICAgICAgICBvbkFkZFRvUGxheWxpc3Q9e2hhbmRsZUFkZFRvUGxheWxpc3R9XG4gICAgICAgICAgICAgIG9uQWRkVG9RdWV1ZT17aGFuZGxlQWRkVG9RdWV1ZX1cbiAgICAgICAgICAgICAgaW1hZ2VVcmxzPXtpbWFnZVVybHN9XG4gICAgICAgICAgICAgIG9uTG9hZE1vcmU9e2xvYWRNb3JlU29uZ3N9XG4gICAgICAgICAgICAgIGhhc01vcmVTb25ncz17ZGlzcGxheUNvdW50IDwgc29uZ3MubGVuZ3RofVxuICAgICAgICAgICAgLz47XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHRoZW1lQ2xhc3NlcyA9IGlzRGFya01vZGUgXG4gICAgPyAnYmctZ3JheS05MDAgdGV4dC13aGl0ZScgXG4gICAgOiAnYmctZ3JheS01MCB0ZXh0LWdyYXktOTAwJztcbmNvbnN0IHNldEN1cnJlbnRUaW1lU3RhdGUgPSBzZXRDdXJyZW50VGltZTtcblxuICByZXR1cm4gKFxuICAgIFxuICAgICAgPGRpdiBjbGFzc05hbWU9e2BtaW4taC1zY3JlZW4gJHt0aGVtZUNsYXNzZXN9IHJlbGF0aXZlIG92ZXJmbG93LWhpZGRlbmB9PlxuICAgICAgICB7LyogTWFpbiBDb250ZW50ICovfVxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTMwMCAke2N1cnJlbnRTb25nID8gJ3BiLTM2JyA6ICdwYi0yMCd9YH0+XG4gICAgICAgICAge3JlbmRlckNvbnRlbnQoKX1cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgey8qIEJvdHRvbSBOYXZpZ2F0aW9uICovfVxuICAgICAgICB7Y3VycmVudFBhZ2UgPT09ICdtYWluJyAmJiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BmaXhlZCBib3R0b20tMCBsZWZ0LTAgcmlnaHQtMCAke2lzRGFya01vZGUgPyAnYmctZ3JheS04MDAgYm9yZGVyLWdyYXktNzAwJyA6ICdiZy13aGl0ZSBib3JkZXItZ3JheS0yMDAnfSBib3JkZXItdCB6LTMwYH0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYXJvdW5kIHB5LTNcIj5cbiAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldEFjdGl2ZVRhYignaG9tZScpfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YGZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIHNwYWNlLXktMSBwLTIgdHJhbnNpdGlvbi1jb2xvcnMgJHtcbiAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhYiA9PT0gJ2hvbWUnID8gJ3RleHQtcHVycGxlLTQwMCcgOiBpc0RhcmtNb2RlID8gJ3RleHQtZ3JheS00MDAnIDogJ3RleHQtZ3JheS02MDAnXG4gICAgICAgICAgICAgICAgfWB9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8SG9tZUljb24gc2l6ZT17MjR9IC8+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC14c1wiPkhvbWU8L3NwYW4+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0QWN0aXZlVGFiKCdzZWFyY2gnKX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BmbGV4IGZsZXgtY29sIGl0ZW1zLWNlbnRlciBzcGFjZS15LTEgcC0yIHRyYW5zaXRpb24tY29sb3JzICR7XG4gICAgICAgICAgICAgICAgICBhY3RpdmVUYWIgPT09ICdzZWFyY2gnID8gJ3RleHQtcHVycGxlLTQwMCcgOiBpc0RhcmtNb2RlID8gJ3RleHQtZ3JheS00MDAnIDogJ3RleHQtZ3JheS02MDAnXG4gICAgICAgICAgICAgICAgfWB9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8U2VhcmNoIHNpemU9ezI0fSAvPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQteHNcIj5TZWFyY2g8L3NwYW4+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0QWN0aXZlVGFiKCdzZXR0aW5ncycpfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YGZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIHNwYWNlLXktMSBwLTIgdHJhbnNpdGlvbi1jb2xvcnMgJHtcbiAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhYiA9PT0gJ3NldHRpbmdzJyA/ICd0ZXh0LXB1cnBsZS00MDAnIDogaXNEYXJrTW9kZSA/ICd0ZXh0LWdyYXktNDAwJyA6ICd0ZXh0LWdyYXktNjAwJ1xuICAgICAgICAgICAgICAgIH1gfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPFNldHRpbmdzIHNpemU9ezI0fSAvPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQteHNcIj5TZXR0aW5nczwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cblxuICAgICAgICB7LyogTXVzaWMgUGxheWVyIC0gT25seSBzaG93IGlmIGN1cnJlbnRTb25nIGV4aXN0cyAqL31cbiAgICAgICAge2N1cnJlbnRTb25nICYmIChcbiAgICAgICAgICA8PlxuICAgICAgICAgICAgeyFpc1BsYXllck1heGltaXplZCA/IChcbiAgICAgICAgICAgICAgPE1pbmltaXplZFBsYXllclxuICAgICAgICAgICAgICAgIHNvbmc9e2N1cnJlbnRTb25nfVxuICAgICAgICAgICAgICAgIGlzUGxheWluZz17aXNQbGF5aW5nfVxuICAgICAgICAgICAgICAgIGltYWdlVXJsPXtpbWFnZVVybHNbY3VycmVudFNvbmcuaW1nX2lkXX1cbiAgICAgICAgICAgICAgICBvblRvZ2dsZVBsYXk9e3RvZ2dsZVBsYXl9XG4gICAgICAgICAgICAgICAgb25NYXhpbWl6ZT17dG9nZ2xlUGxheWVyU2l6ZX1cbiAgICAgICAgICAgICAgICBvblByZXZpb3VzPXtoYW5kbGVQcmV2aW91c31cbiAgICAgICAgICAgICAgICBvbk5leHQ9e2hhbmRsZU5leHR9XG4gICAgICAgICAgICAgICAgb25DbG9zZT17Y2xvc2VQbGF5ZXJ9XG4gICAgICAgICAgICAgICAgb25Ub2dnbGVMaWtlPXsoKSA9PiBoYW5kbGVUb2dnbGVMaWtlKGN1cnJlbnRTb25nLmlkKX1cbiAgICAgICAgICAgICAgICBmb3JtYXROdW1iZXI9e2Zvcm1hdE51bWJlcn1cbiAgICAgICAgICAgICAgICBjdXJyZW50VGltZT17Y3VycmVudFRpbWV9XG4gICAgICAgICAgICAgICAgZHVyYXRpb249e2R1cmF0aW9ufVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgPE1heGltaXplZFBsYXllclxuICAgICAgICAgICAgICAgIHNvbmc9e2N1cnJlbnRTb25nfVxuICAgICAgICAgICAgICAgIGlzUGxheWluZz17aXNQbGF5aW5nfVxuICAgICAgICAgICAgICAgIGltYWdlVXJsPXtpbWFnZVVybHNbY3VycmVudFNvbmcuaW1nX2lkXX1cbiAgICAgICAgICAgICAgICBvblRvZ2dsZVBsYXk9e3RvZ2dsZVBsYXl9XG4gICAgICAgICAgICAgICAgb25NaW5pbWl6ZT17dG9nZ2xlUGxheWVyU2l6ZX1cbiAgICAgICAgICAgICAgICBvblByZXZpb3VzPXtoYW5kbGVQcmV2aW91c31cbiAgICAgICAgICAgICAgICBvbk5leHQ9e2hhbmRsZU5leHR9XG4gICAgICAgICAgICAgICAgb25Ub2dnbGVMaWtlPXsoKSA9PiBoYW5kbGVUb2dnbGVMaWtlKGN1cnJlbnRTb25nLmlkKX1cbiAgICAgICAgICAgICAgICBmb3JtYXROdW1iZXI9e2Zvcm1hdE51bWJlcn1cbiAgICAgICAgICAgICAgICBvbkFkZFRvUGxheWxpc3Q9eygpID0+IGhhbmRsZUFkZFRvUGxheWxpc3QoY3VycmVudFNvbmcpfVxuICAgICAgICAgICAgICAgIGN1cnJlbnRUaW1lPXtjdXJyZW50VGltZX1cbiAgICAgICAgICAgICAgICBkdXJhdGlvbj17ZHVyYXRpb259XG5cbiAgICAgICAgICAgICAgc2V0Q3VycmVudFRpbWU9eyhzZWVrVGltZSkgPT4ge1xuICBpZiAoYXVkaW9SZWYuY3VycmVudCAmJiAhaXNOYU4oYXVkaW9SZWYuY3VycmVudC5kdXJhdGlvbikpIHtcbiAgICBzZXRJc0V4dGVybmFsbHlTZWVraW5nKHRydWUpO1xuICAgIGF1ZGlvUmVmLmN1cnJlbnQuY3VycmVudFRpbWUgPSBzZWVrVGltZTtcbiAgICBzZXRDdXJyZW50VGltZVN0YXRlKHNlZWtUaW1lKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHNldElzRXh0ZXJuYWxseVNlZWtpbmcoZmFsc2UpLCAyMDApO1xuICB9IGVsc2Uge1xuICAgIHNldFBlbmRpbmdTZWVrVGltZShzZWVrVGltZSk7IC8vIFdpbGwgYXBwbHkgb25Mb2FkZWRNZXRhZGF0YVxuICB9XG59fVxuXG5cblxuICAgICAgICAgICAgICAgIHZvbHVtZT17dm9sdW1lfVxuICAgICAgICAgICAgICAgIHNldFZvbHVtZT17c2V0Vm9sdW1lfVxuICAgICAgICAgICAgICAgIGlzU2Vla2luZz17aXNTZWVraW5nfVxuICAgICAgICAgICAgICAgIHNldElzU2Vla2luZz17c2V0SXNTZWVraW5nfVxuICAgICAgICAgICAgICAgIHF1ZXVlPXtxdWV1ZX1cbiAgICAgICAgICAgICAgICBvblJlbW92ZUZyb21RdWV1ZT17cmVtb3ZlRnJvbVF1ZXVlfVxuICAgICAgICAgICAgICAgIG9uU29uZ1BsYXk9e2hhbmRsZVNvbmdQbGF5fVxuICAgICAgICAgICAgICAgIGltYWdlVXJscz17aW1hZ2VVcmxzfVxuICAgICAgICAgICAgICAgIGlzU2h1ZmZsZUVuYWJsZWQ9e2lzU2h1ZmZsZUVuYWJsZWR9XG4gICAgICAgICAgICAgICAgc2V0SXNTaHVmZmxlRW5hYmxlZD17c2V0SXNTaHVmZmxlRW5hYmxlZH1cbiAgICAgICAgICAgICAgICByZXBlYXRNb2RlPXtyZXBlYXRNb2RlfVxuICAgICAgICAgICAgICAgIHNldFJlcGVhdE1vZGU9e3NldFJlcGVhdE1vZGV9XG4gICAgICAgICAgICAgICAgc2xlZXBUaW1lcj17c2xlZXBUaW1lcn1cbiAgICAgICAgICAgICAgICByZW1haW5pbmdUaW1lPXtyZW1haW5pbmdUaW1lfVxuICAgICAgICAgICAgICAgIG9uT3BlblNsZWVwVGltZXI9eygpID0+IHNldFNob3dTbGVlcFRpbWVyTW9kYWwodHJ1ZSl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvPlxuICAgICAgICApfVxuXG4gICAgICAgIHsvKiBNb2RhbHMgKi99XG4gICAgICAgIDxDcmVhdGVQbGF5bGlzdE1vZGFsXG4gICAgICAgICAgaXNPcGVuPXtzaG93Q3JlYXRlUGxheWxpc3RNb2RhbH1cbiAgICAgICAgICBvbkNsb3NlPXsoKSA9PiBzZXRTaG93Q3JlYXRlUGxheWxpc3RNb2RhbChmYWxzZSl9XG4gICAgICAgICAgb25DcmVhdGVQbGF5bGlzdD17Y3JlYXRlUGxheWxpc3R9XG4gICAgICAgIC8+XG5cbiAgICAgICAgPEFkZFRvUGxheWxpc3RNb2RhbFxuICAgICAgICAgIGlzT3Blbj17c2hvd0FkZFRvUGxheWxpc3RNb2RhbH1cbiAgICAgICAgICBvbkNsb3NlPXsoKSA9PiB7XG4gICAgICAgICAgICBzZXRTaG93QWRkVG9QbGF5bGlzdE1vZGFsKGZhbHNlKTtcbiAgICAgICAgICAgIHNldFNlbGVjdGVkU29uZ0ZvclBsYXlsaXN0KG51bGwpO1xuICAgICAgICAgIH19XG4gICAgICAgICAgc29uZz17c2VsZWN0ZWRTb25nRm9yUGxheWxpc3R9XG4gICAgICAgICAgcGxheWxpc3RzPXtwbGF5bGlzdHN9XG4gICAgICAgICAgb25BZGRUb1BsYXlsaXN0PXthZGRTb25nVG9QbGF5bGlzdH1cbiAgICAgICAgICBvbkNyZWF0ZVBsYXlsaXN0PXsoKSA9PiB7XG4gICAgICAgICAgICBzZXRTaG93QWRkVG9QbGF5bGlzdE1vZGFsKGZhbHNlKTtcbiAgICAgICAgICAgIHNldFNob3dDcmVhdGVQbGF5bGlzdE1vZGFsKHRydWUpO1xuICAgICAgICAgIH19XG4gICAgICAgICAgaW1hZ2VVcmxzPXtpbWFnZVVybHN9XG4gICAgICAgICAgc2V0SW1hZ2VVcmxzPXtzZXRJbWFnZVVybHN9XG4gICAgICAgIC8+XG5cbiAgICAgICAgPFNsZWVwVGltZXJNb2RhbFxuICAgICAgICAgIGlzT3Blbj17c2hvd1NsZWVwVGltZXJNb2RhbH1cbiAgICAgICAgICBvbkNsb3NlPXsoKSA9PiBzZXRTaG93U2xlZXBUaW1lck1vZGFsKGZhbHNlKX1cbiAgICAgICAgICBvblNldFRpbWVyPXtoYW5kbGVTbGVlcFRpbWVyU2V0fVxuICAgICAgICAgIGN1cnJlbnRUaW1lcj17c2xlZXBUaW1lcn1cbiAgICAgICAgLz5cbiAgICAgICAgPGF1ZGlvXG4gICAgICAgICAgcmVmPXthdWRpb1JlZn1cbiAgICAgICAgICBzcmM9e2F1ZGlvVXJsID8/IHVuZGVmaW5lZH1cbiAgICAgICAgICBvbkVuZGVkPXtoYW5kbGVTb25nRW5kfVxuICAgICAgICAgIG9uVGltZVVwZGF0ZT17KCkgPT4ge1xuICAgICAgICAgIGlmIChhdWRpb1JlZi5jdXJyZW50ICYmICFpc1NlZWtpbmcgJiYgIWlzRXh0ZXJuYWxseVNlZWtpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBhdWRpb1JlZi5jdXJyZW50LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgLy8gT25seSB1cGRhdGUgc3RhdGUgaWYgdGhlIGRpZmZlcmVuY2UgaXMgc2lnbmlmaWNhbnRcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyhjdXJyZW50VGltZSAtIGN1cnJlbnQpID4gMC4yNSkge1xuICAgICAgICAgICAgICBzZXRDdXJyZW50VGltZShjdXJyZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH19XG5cblxuICAgICAgICAgIG9uTG9hZGVkTWV0YWRhdGE9e2hhbmRsZUxvYWRlZE1ldGFkYXRhfVxuICAgICAgICAgIG9uVm9sdW1lQ2hhbmdlPXsoKSA9PiB7XG4gICAgICAgICAgICBpZiAoYXVkaW9SZWYuY3VycmVudCkge1xuICAgICAgICAgICAgICBzZXRWb2x1bWUoYXVkaW9SZWYuY3VycmVudC52b2x1bWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH19XG4gICAgICAgICAgc3R5bGU9e3sgZGlzcGxheTogJ25vbmUnIH19XG4gICAgICAgIC8+XG5cbiAgICAgIDwvZGl2PlxuICApO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBNdXNpY1BsYXllckFwcCgpIHtcbiAgcmV0dXJuIChcbiAgICA8QXV0aFdyYXBwZXI+XG4gICAgICA8VG9hc3RlciBwb3NpdGlvbj1cImJvdHRvbS1jZW50ZXJcIiAvPlxuICAgICAgPE11c2ljUGxheWVyQ29udGVudCAvPlxuICAgIDwvQXV0aFdyYXBwZXI+XG4gICk7XG59Il0sIm5hbWVzIjpbIkFkZFRvUGxheWxpc3RNb2RhbCIsIkF1dGhXcmFwcGVyIiwiQ3JlYXRlUGxheWxpc3RNb2RhbCIsIkhvbWVQYWdlIiwiTGlrZWRTb25nc1BhZ2UiLCJNYXhpbWl6ZWRQbGF5ZXIiLCJNaW5pbWl6ZWRQbGF5ZXIiLCJQbGF5bGlzdHNQYWdlIiwiU2VhcmNoUGFnZSIsIlNldHRpbmdzUGFnZSIsIlNsZWVwVGltZXJNb2RhbCIsInVzZVRoZW1lIiwidXNlQXV0aCIsInVzZVF1ZXVlIiwidXNlU2xlZXBUaW1lciIsInVzZVN1cGFiYXNlRGF0YSIsIkhvbWUiLCJIb21lSWNvbiIsIlNlYXJjaCIsIlNldHRpbmdzIiwidXNlRWZmZWN0IiwidXNlUmVmIiwidXNlU3RhdGUiLCJUb2FzdGVyIiwidG9hc3QiLCJNdXNpY1BsYXllckNvbnRlbnQiLCJ1c2VyIiwic29uZ3MiLCJwZXJzb25hbGl6ZWRTb25ncyIsInBsYXlsaXN0cyIsImxpa2VkU29uZ3MiLCJyZWNlbnRseVBsYXllZFNvbmdzIiwibGFzdFBsYXllZFNvbmciLCJsb2FkaW5nIiwidG9nZ2xlTGlrZSIsImNyZWF0ZVBsYXlsaXN0IiwiZGVsZXRlUGxheWxpc3QiLCJyZW5hbWVQbGF5bGlzdCIsImFkZFNvbmdUb1BsYXlsaXN0IiwicmVtb3ZlU29uZ0Zyb21QbGF5bGlzdCIsInJlY29yZExpc3RlbmluZ0hpc3RvcnkiLCJzdG9wQ3VycmVudFNvbmdUcmFja2luZyIsImdldFBlcnNvbmFsaXplZFNvbmdzIiwiZ2V0U21hcnRQZXJzb25hbGl6ZWRTb25ncyIsInF1ZXVlIiwiYWRkVG9RdWV1ZSIsInJlbW92ZUZyb21RdWV1ZSIsImdldE5leHRTb25nRnJvbVF1ZXVlIiwiY2xlYXJRdWV1ZSIsImhhc1F1ZXVlIiwiYWN0aXZlVGFiIiwic2V0QWN0aXZlVGFiIiwiY3VycmVudFBhZ2UiLCJzZXRDdXJyZW50UGFnZSIsImN1cnJlbnRTb25nIiwic2V0Q3VycmVudFNvbmciLCJpc1BsYXlpbmciLCJzZXRJc1BsYXlpbmciLCJpc1BsYXllck1heGltaXplZCIsInNldElzUGxheWVyTWF4aW1pemVkIiwic2hvd0NyZWF0ZVBsYXlsaXN0TW9kYWwiLCJzZXRTaG93Q3JlYXRlUGxheWxpc3RNb2RhbCIsInNob3dBZGRUb1BsYXlsaXN0TW9kYWwiLCJzZXRTaG93QWRkVG9QbGF5bGlzdE1vZGFsIiwic2hvd1NsZWVwVGltZXJNb2RhbCIsInNldFNob3dTbGVlcFRpbWVyTW9kYWwiLCJzZWxlY3RlZFNvbmdGb3JQbGF5bGlzdCIsInNldFNlbGVjdGVkU29uZ0ZvclBsYXlsaXN0IiwiaGFzU2V0TGFzdFBsYXllZFNvbmciLCJzZXRIYXNTZXRMYXN0UGxheWVkU29uZyIsImxhc3RQbGF5ZWRTb25nRGlzbWlzc2VkIiwic2V0TGFzdFBsYXllZFNvbmdEaXNtaXNzZWQiLCJpc0RhcmtNb2RlIiwidG9nZ2xlVGhlbWUiLCJkaXNwbGF5Q291bnQiLCJzZXREaXNwbGF5Q291bnQiLCJpbWFnZVVybHMiLCJzZXRJbWFnZVVybHMiLCJhdWRpb1VybCIsInNldEF1ZGlvVXJsIiwiYXVkaW9SZWYiLCJjdXJyZW50VGltZSIsInNldEN1cnJlbnRUaW1lIiwiZHVyYXRpb24iLCJzZXREdXJhdGlvbiIsInZvbHVtZSIsInNldFZvbHVtZSIsImlzU2Vla2luZyIsInNldElzU2Vla2luZyIsInBlbmRpbmdTZWVrVGltZSIsInNldFBlbmRpbmdTZWVrVGltZSIsImlzRXh0ZXJuYWxseVNlZWtpbmciLCJzZXRJc0V4dGVybmFsbHlTZWVraW5nIiwicmVjb21tZW5kZWRRdWV1ZSIsInNldFJlY29tbWVuZGVkUXVldWUiLCJwbGF5ZWRTb25ncyIsInNldFBsYXllZFNvbmdzIiwiU2V0IiwicGVyc29uYWxpemVkTGlzdCIsInNldFBlcnNvbmFsaXplZExpc3QiLCJjdXJyZW50U29uZ0luZGV4Iiwic2V0Q3VycmVudFNvbmdJbmRleCIsImxpc3RlbmVkU29uZ3MiLCJzZXRMaXN0ZW5lZFNvbmdzIiwiaXNGZXRjaGluZ01vcmUiLCJzZXRJc0ZldGNoaW5nTW9yZSIsImN1cnJlbnRCYXRjaExpc3RlbmVkU29uZ3MiLCJzZXRDdXJyZW50QmF0Y2hMaXN0ZW5lZFNvbmdzIiwic29uZ1N0YXJ0VGltZSIsInNldFNvbmdTdGFydFRpbWUiLCJiYXRjaFN0YXJ0SW5kZXgiLCJzZXRCYXRjaFN0YXJ0SW5kZXgiLCJpc1NodWZmbGVFbmFibGVkIiwic2V0SXNTaHVmZmxlRW5hYmxlZCIsInJlcGVhdE1vZGUiLCJzZXRSZXBlYXRNb2RlIiwic2xlZXBUaW1lciIsInJlbWFpbmluZ1RpbWUiLCJzdGFydFRpbWVyIiwiY2FuY2VsVGltZXIiLCJ0cmlnZ2VyQWZ0ZXJTb25nVGltZXIiLCJpc0FjdGl2ZSIsImlzU2xlZXBUaW1lckFjdGl2ZSIsImxvYWRNb3JlU29uZ3MiLCJwcmV2IiwiZGlzcGxheWVkU29uZ3MiLCJzbGljZSIsImxvYWRBdWRpbyIsImZpbGVfaWQiLCJ1cmwiLCJjdXJyZW50IiwiYXVkaW8iLCJpc05hTiIsInBsYXkiLCJjYXRjaCIsImUiLCJjb25zb2xlIiwiZXJyb3IiLCJwYXVzZSIsImZldGNoSW1hZ2VzIiwibmV3VXJscyIsInNvbmdzVG9Mb2FkIiwic29uZyIsImlkIiwiaW1nX2lkIiwicGxheWxpc3QiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwibG9nIiwibG9hZExhc3RQbGF5ZWRJbWFnZSIsImluaXRpYWxSZWNzIiwiZmlsdGVyZWQiLCJmaWx0ZXIiLCJoYXMiLCJ0b1N0cmluZyIsIm5ld1BlcnNvbmFsaXplZExpc3QiLCJuZXdTZXQiLCJhZGQiLCJBcnJheSIsImZyb20iLCJoYW5kbGVTb25nUGxheSIsImxpc3RlbkR1cmF0aW9uIiwiRGF0ZSIsImdldFRpbWUiLCJuYW1lIiwidG9GaXhlZCIsImV4aXN0cyIsInNvbWUiLCJzIiwidXBkYXRlZCIsIm1hcCIsInJlY3MiLCJoYW5kbGVBZGRUb1F1ZXVlIiwic3VjY2VzcyIsInRvZ2dsZVBsYXkiLCJ0b2dnbGVQbGF5ZXJTaXplIiwiY2xvc2VQbGF5ZXIiLCJoYW5kbGVUb2dnbGVMaWtlIiwic29uZ0lkIiwiaXNMaWtlZCIsImhhbmRsZVByZXZpb3VzIiwicHJldkluZGV4IiwicHJldlNvbmciLCJuZXdVcmwiLCJjdXJyZW50SW5kZXgiLCJmaW5kSW5kZXgiLCJuZXh0SW5kZXgiLCJuZXh0U29uZyIsImhhbmRsZUxvYWRlZE1ldGFkYXRhIiwibG9hZGVkRHVyYXRpb24iLCJpc0Zpbml0ZSIsImVyciIsInNldFRpbWVvdXQiLCJoYW5kbGVOZXh0IiwibmV4dFF1ZXVlU29uZyIsIlN0cmluZyIsIm5ld1JlY3MiLCJleGlzdGluZyIsIndhcm4iLCJmb3JtYXROdW1iZXIiLCJudW0iLCJoYW5kbGVBZGRUb1BsYXlsaXN0IiwiaGFuZGxlU29uZ0VuZCIsImhhbmRsZVNsZWVwVGltZXJTZXQiLCJtaW51dGVzIiwicmVuZGVyQ29udGVudCIsIm9uQmFjayIsIm9uU29uZ1BsYXkiLCJvbkFkZFRvUXVldWUiLCJvbkNyZWF0ZVBsYXlsaXN0Iiwib25EZWxldGVQbGF5bGlzdCIsIm9uUmVuYW1lUGxheWxpc3QiLCJvblJlbW92ZVNvbmdGcm9tUGxheWxpc3QiLCJvbkFkZFRvUGxheWxpc3QiLCJvbkxvYWRNb3JlIiwiaGFzTW9yZVNvbmdzIiwib25QbGF5bGlzdHNDbGljayIsIm9uTGlrZWRDbGljayIsInRoZW1lQ2xhc3NlcyIsInNldEN1cnJlbnRUaW1lU3RhdGUiLCJkaXYiLCJjbGFzc05hbWUiLCJidXR0b24iLCJvbkNsaWNrIiwic2l6ZSIsInNwYW4iLCJpbWFnZVVybCIsIm9uVG9nZ2xlUGxheSIsIm9uTWF4aW1pemUiLCJvblByZXZpb3VzIiwib25OZXh0Iiwib25DbG9zZSIsIm9uVG9nZ2xlTGlrZSIsIm9uTWluaW1pemUiLCJzZWVrVGltZSIsIm9uUmVtb3ZlRnJvbVF1ZXVlIiwib25PcGVuU2xlZXBUaW1lciIsImlzT3BlbiIsIm9uU2V0VGltZXIiLCJjdXJyZW50VGltZXIiLCJyZWYiLCJzcmMiLCJ1bmRlZmluZWQiLCJvbkVuZGVkIiwib25UaW1lVXBkYXRlIiwiTWF0aCIsImFicyIsIm9uTG9hZGVkTWV0YWRhdGEiLCJvblZvbHVtZUNoYW5nZSIsInN0eWxlIiwiZGlzcGxheSIsIk11c2ljUGxheWVyQXBwIiwicG9zaXRpb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./app/page.tsx\n"));

/***/ }),

/***/ "(app-pages-browser)/./components/HomePage.tsx":
/*!*********************************!*\
  !*** ./components/HomePage.tsx ***!
  \*********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var _components_ThemeContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/components/ThemeContext */ \"(app-pages-browser)/./components/ThemeContext.tsx\");\n/* harmony import */ var _hooks_useAuth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/hooks/useAuth */ \"(app-pages-browser)/./hooks/useAuth.ts\");\n/* harmony import */ var _barrel_optimize_names_Music_TrendingUp_lucide_react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! __barrel_optimize__?names=Music,TrendingUp!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/music.js\");\n/* harmony import */ var _barrel_optimize_names_Music_TrendingUp_lucide_react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! __barrel_optimize__?names=Music,TrendingUp!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/trending-up.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _SongCard__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SongCard */ \"(app-pages-browser)/./components/SongCard.tsx\");\n/* harmony import */ var _TrendingSong__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TrendingSong */ \"(app-pages-browser)/./components/TrendingSong.tsx\");\n\nvar _s = $RefreshSig$();\n\n\n\n\n\n\nconst HomePage = (param)=>{\n    let { songs, onSongPlay, formatNumber, onAddToPlaylist, onAddToQueue, imageUrls, onLoadMore, hasMoreSongs, recentlyPlayedSongs } = param;\n    var _user_user_metadata;\n    _s();\n    const { isDarkMode } = (0,_components_ThemeContext__WEBPACK_IMPORTED_MODULE_1__.useTheme)();\n    const { user } = (0,_hooks_useAuth__WEBPACK_IMPORTED_MODULE_2__.useAuth)();\n    // Show loading state if no songs are loaded yet\n    if (songs.length === 0) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"min-h-screen \".concat(isDarkMode ? \"bg-gray-900 text-white\" : \"bg-gray-50 text-gray-900\", \" flex items-center justify-center\"),\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"text-center\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4\"\n                    }, void 0, false, {\n                        fileName: \"/home/project/components/HomePage.tsx\",\n                        lineNumber: 32,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: isDarkMode ? \"text-gray-400\" : \"text-gray-600\",\n                        children: \"Loading your music...\"\n                    }, void 0, false, {\n                        fileName: \"/home/project/components/HomePage.tsx\",\n                        lineNumber: 33,\n                        columnNumber: 11\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/project/components/HomePage.tsx\",\n                lineNumber: 31,\n                columnNumber: 9\n            }, undefined)\n        }, void 0, false, {\n            fileName: \"/home/project/components/HomePage.tsx\",\n            lineNumber: 30,\n            columnNumber: 7\n        }, undefined);\n    }\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"min-h-screen \".concat(isDarkMode ? \"bg-gray-900 text-white\" : \"bg-gray-50 text-gray-900\"),\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"sticky top-0 \".concat(isDarkMode ? \"bg-gray-900/95\" : \"bg-gray-50/95\", \" backdrop-blur-md z-10 px-4 py-4\"),\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"flex items-center justify-between mb-4\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h1\", {\n                                    className: \"text-2xl font-bold\",\n                                    children: \"Good evening\"\n                                }, void 0, false, {\n                                    fileName: \"/home/project/components/HomePage.tsx\",\n                                    lineNumber: 45,\n                                    columnNumber: 13\n                                }, undefined),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                    className: \"\".concat(isDarkMode ? \"text-gray-400\" : \"text-gray-600\", \" text-sm\"),\n                                    children: \"What do you want to listen to?\"\n                                }, void 0, false, {\n                                    fileName: \"/home/project/components/HomePage.tsx\",\n                                    lineNumber: 46,\n                                    columnNumber: 13\n                                }, undefined)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/project/components/HomePage.tsx\",\n                            lineNumber: 44,\n                            columnNumber: 11\n                        }, undefined),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"w-10 h-10 rounded-full flex items-center justify-center overflow-hidden\",\n                            children: (user === null || user === void 0 ? void 0 : (_user_user_metadata = user.user_metadata) === null || _user_user_metadata === void 0 ? void 0 : _user_user_metadata.avatar_url) ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                                src: user.user_metadata.avatar_url,\n                                alt: \"Profile\",\n                                className: \"w-full h-full object-cover\"\n                            }, void 0, false, {\n                                fileName: \"/home/project/components/HomePage.tsx\",\n                                lineNumber: 50,\n                                columnNumber: 15\n                            }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"w-full h-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Music_TrendingUp_lucide_react__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n                                    size: 20,\n                                    className: \"text-white\"\n                                }, void 0, false, {\n                                    fileName: \"/home/project/components/HomePage.tsx\",\n                                    lineNumber: 57,\n                                    columnNumber: 17\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/home/project/components/HomePage.tsx\",\n                                lineNumber: 56,\n                                columnNumber: 15\n                            }, undefined)\n                        }, void 0, false, {\n                            fileName: \"/home/project/components/HomePage.tsx\",\n                            lineNumber: 48,\n                            columnNumber: 11\n                        }, undefined)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/home/project/components/HomePage.tsx\",\n                    lineNumber: 43,\n                    columnNumber: 9\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"/home/project/components/HomePage.tsx\",\n                lineNumber: 42,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"px-4 pb-4\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"mb-8\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex items-center justify-between mb-4\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h2\", {\n                                        className: \"text-xl font-semibold flex items-center\",\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Music_TrendingUp_lucide_react__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n                                                className: \"mr-2 text-purple-400\",\n                                                size: 20\n                                            }, void 0, false, {\n                                                fileName: \"/home/project/components/HomePage.tsx\",\n                                                lineNumber: 70,\n                                                columnNumber: 15\n                                            }, undefined),\n                                            \"Trending Now\"\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/project/components/HomePage.tsx\",\n                                        lineNumber: 69,\n                                        columnNumber: 13\n                                    }, undefined),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        className: \"text-purple-400 text-sm font-medium\",\n                                        children: \"See all\"\n                                    }, void 0, false, {\n                                        fileName: \"/home/project/components/HomePage.tsx\",\n                                        lineNumber: 73,\n                                        columnNumber: 13\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/home/project/components/HomePage.tsx\",\n                                lineNumber: 68,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex space-x-4 overflow-x-auto pb-2 scrollbar-hide\",\n                                children: songs.slice(0, 10).map((song)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_TrendingSong__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n                                        song: {\n                                            ...song,\n                                            image: imageUrls[song.id] || \"\"\n                                        },\n                                        onPlay: onSongPlay,\n                                        formatNumber: formatNumber,\n                                        cachedImageUrl: imageUrls[song.id]\n                                    }, song.id, false, {\n                                        fileName: \"/home/project/components/HomePage.tsx\",\n                                        lineNumber: 77,\n                                        columnNumber: 15\n                                    }, undefined))\n                            }, void 0, false, {\n                                fileName: \"/home/project/components/HomePage.tsx\",\n                                lineNumber: 75,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/project/components/HomePage.tsx\",\n                        lineNumber: 67,\n                        columnNumber: 9\n                    }, undefined),\n                    recentlyPlayedSongs.length > 0 && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"mb-8\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h2\", {\n                                className: \"text-xl font-bold mb-4 px-2\",\n                                children: \"Recently Played\"\n                            }, void 0, false, {\n                                fileName: \"/home/project/components/HomePage.tsx\",\n                                lineNumber: 90,\n                                columnNumber: 5\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"overflow-x-auto\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex gap-6 px-2 py-4\",\n                                    children: Array.from({\n                                        length: Math.ceil(recentlyPlayedSongs.length / 3)\n                                    }).map((_, columnIndex)=>{\n                                        const start = columnIndex * 3;\n                                        const end = start + 3;\n                                        const group = recentlyPlayedSongs.slice(start, end);\n                                        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"min-w-[260px] flex flex-col gap-5\",\n                                            children: group.map((song)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                    className: \"flex items-center p-3 bg-gray-800/50 hover:bg-gray-800 rounded-lg transition-all group cursor-pointer\",\n                                                    onClick: ()=>onSongPlay({\n                                                            ...song,\n                                                            image: imageUrls[song.id] || \"\"\n                                                        }),\n                                                    children: [\n                                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                                                            src: imageUrls[song.id] || \"/placeholder.jpg\",\n                                                            alt: song.name,\n                                                            className: \"w-16 h-16 rounded-lg object-cover shadow-md\"\n                                                        }, void 0, false, {\n                                                            fileName: \"/home/project/components/HomePage.tsx\",\n                                                            lineNumber: 106,\n                                                            columnNumber: 19\n                                                        }, undefined),\n                                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                            className: \"flex flex-col ml-4\",\n                                                            children: [\n                                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                                    className: \"text-base font-semibold text-white\",\n                                                                    children: song.name\n                                                                }, void 0, false, {\n                                                                    fileName: \"/home/project/components/HomePage.tsx\",\n                                                                    lineNumber: 112,\n                                                                    columnNumber: 21\n                                                                }, undefined),\n                                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                                    className: \"text-sm text-neutral-300\",\n                                                                    children: song.artist\n                                                                }, void 0, false, {\n                                                                    fileName: \"/home/project/components/HomePage.tsx\",\n                                                                    lineNumber: 113,\n                                                                    columnNumber: 21\n                                                                }, undefined)\n                                                            ]\n                                                        }, void 0, true, {\n                                                            fileName: \"/home/project/components/HomePage.tsx\",\n                                                            lineNumber: 111,\n                                                            columnNumber: 19\n                                                        }, undefined)\n                                                    ]\n                                                }, song.id, true, {\n                                                    fileName: \"/home/project/components/HomePage.tsx\",\n                                                    lineNumber: 101,\n                                                    columnNumber: 17\n                                                }, undefined))\n                                        }, columnIndex, false, {\n                                            fileName: \"/home/project/components/HomePage.tsx\",\n                                            lineNumber: 99,\n                                            columnNumber: 13\n                                        }, undefined);\n                                    })\n                                }, void 0, false, {\n                                    fileName: \"/home/project/components/HomePage.tsx\",\n                                    lineNumber: 92,\n                                    columnNumber: 7\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/home/project/components/HomePage.tsx\",\n                                lineNumber: 91,\n                                columnNumber: 5\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/project/components/HomePage.tsx\",\n                        lineNumber: 89,\n                        columnNumber: 3\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex items-center justify-between mb-4\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h2\", {\n                                        className: \"text-xl font-semibold\",\n                                        children: \"Made for you\"\n                                    }, void 0, false, {\n                                        fileName: \"/home/project/components/HomePage.tsx\",\n                                        lineNumber: 129,\n                                        columnNumber: 13\n                                    }, undefined),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        className: \"text-purple-400 text-sm font-medium\",\n                                        children: \"See all\"\n                                    }, void 0, false, {\n                                        fileName: \"/home/project/components/HomePage.tsx\",\n                                        lineNumber: 130,\n                                        columnNumber: 13\n                                    }, undefined)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/home/project/components/HomePage.tsx\",\n                                lineNumber: 128,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"space-y-3\",\n                                children: songs.map((song)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_SongCard__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n                                        song: {\n                                            ...song,\n                                            image: imageUrls[song.id] || \"\"\n                                        },\n                                        onPlay: onSongPlay,\n                                        formatNumber: formatNumber,\n                                        onAddToPlaylist: onAddToPlaylist,\n                                        onAddToQueue: onAddToQueue,\n                                        cachedImageUrl: imageUrls[song.id]\n                                    }, song.id, false, {\n                                        fileName: \"/home/project/components/HomePage.tsx\",\n                                        lineNumber: 134,\n                                        columnNumber: 15\n                                    }, undefined))\n                            }, void 0, false, {\n                                fileName: \"/home/project/components/HomePage.tsx\",\n                                lineNumber: 132,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/project/components/HomePage.tsx\",\n                        lineNumber: 127,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/project/components/HomePage.tsx\",\n                lineNumber: 65,\n                columnNumber: 7\n            }, undefined)\n        ]\n    }, void 0, true, {\n        fileName: \"/home/project/components/HomePage.tsx\",\n        lineNumber: 40,\n        columnNumber: 5\n    }, undefined);\n};\n_s(HomePage, \"jAnCuiuX/KWEMNgoC9SL9mKTjeU=\", false, function() {\n    return [\n        _components_ThemeContext__WEBPACK_IMPORTED_MODULE_1__.useTheme,\n        _hooks_useAuth__WEBPACK_IMPORTED_MODULE_2__.useAuth\n    ];\n});\n_c = HomePage;\n/* harmony default export */ __webpack_exports__[\"default\"] = (HomePage);\nvar _c;\n$RefreshReg$(_c, \"HomePage\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2NvbXBvbmVudHMvSG9tZVBhZ2UudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFxRDtBQUNYO0FBRWE7QUFDN0I7QUFDUTtBQUNRO0FBZ0IxQyxNQUFNTyxXQUFvQztRQUFDLEVBQUVDLEtBQUssRUFBRUMsVUFBVSxFQUFFQyxZQUFZLEVBQUVDLGVBQWUsRUFBRUMsWUFBWSxFQUFFQyxTQUFTLEVBQUNDLFVBQVUsRUFBQ0MsWUFBWSxFQUFFQyxtQkFBbUIsRUFBRTtRQTBCeEpDOztJQXpCWCxNQUFNLEVBQUVDLFVBQVUsRUFBRSxHQUFHbEIsa0VBQVFBO0lBQy9CLE1BQU0sRUFBRWlCLElBQUksRUFBRSxHQUFHaEIsdURBQU9BO0lBRXhCLGdEQUFnRDtJQUNoRCxJQUFJTyxNQUFNVyxNQUFNLEtBQUssR0FBRztRQUN0QixxQkFDRSw4REFBQ0M7WUFBSUMsV0FBVyxnQkFBbUYsT0FBbkVILGFBQWEsMkJBQTJCLDRCQUEyQjtzQkFDakcsNEVBQUNFO2dCQUFJQyxXQUFVOztrQ0FDYiw4REFBQ0Q7d0JBQUlDLFdBQVU7Ozs7OztrQ0FDZiw4REFBQ0M7d0JBQUVELFdBQVdILGFBQWEsa0JBQWtCO2tDQUFpQjs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFJdEU7SUFFQSxxQkFDRSw4REFBQ0U7UUFBSUMsV0FBVyxnQkFBbUYsT0FBbkVILGFBQWEsMkJBQTJCOzswQkFFdEUsOERBQUNFO2dCQUFJQyxXQUFXLGdCQUFnRSxPQUFoREgsYUFBYSxtQkFBbUIsaUJBQWdCOzBCQUM5RSw0RUFBQ0U7b0JBQUlDLFdBQVU7O3NDQUNiLDhEQUFDRDs7OENBQ0MsOERBQUNHO29DQUFHRixXQUFVOzhDQUFxQjs7Ozs7OzhDQUNuQyw4REFBQ0M7b0NBQUVELFdBQVcsR0FBa0QsT0FBL0NILGFBQWEsa0JBQWtCLGlCQUFnQjs4Q0FBVzs7Ozs7Ozs7Ozs7O3NDQUU3RSw4REFBQ0U7NEJBQUlDLFdBQVU7c0NBQ1pKLENBQUFBLGlCQUFBQSw0QkFBQUEs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Q3FCLEtBQUtFLEVBQUUsQ0FBQyxJQUFJO3dDQUFHO3dDQUNqREMsUUFBUTVCO3dDQUNSQyxjQUFjQTt3Q0FDZEMsaUJBQWlCQTt3Q0FDakJDLGNBQWNBO3dDQUNkMEIsZ0JBQWdCekIsU0FBUyxDQUFDcUIsS0FBS0UsRUFBRSxDQUFDO3VDQU43QkYsS0FBS0UsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWM1QjtHQTlITTdCOztRQUNtQlAsOERBQVFBO1FBQ2RDLG1EQUFPQTs7O0tBRnBCTTtBQWdJTiwrREFBZUEsUUFBUUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9jb21wb25lbnRzL0hvbWVQYWdlLnRzeD80MjdiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVRoZW1lIH0gZnJvbSAnQC9jb21wb25lbnRzL1RoZW1lQ29udGV4dCc7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnQC9ob29rcy91c2VBdXRoJztcbmltcG9ydCB7IFNvbmcgfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB7IE11c2ljLCBQbHVzLCBUcmVuZGluZ1VwIH0gZnJvbSAnbHVjaWRlLXJlYWN0JztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgU29uZ0NhcmQgZnJvbSAnLi9Tb25nQ2FyZCc7XG5pbXBvcnQgVHJlbmRpbmdTb25nIGZyb20gJy4vVHJlbmRpbmdTb25nJztcblxuXG5pbnRlcmZhY2UgSG9tZVBhZ2VQcm9wcyB7XG4gIHNvbmdzOiBTb25nW107XG4gIG9uU29uZ1BsYXk6IChzb25nOiBTb25nKSA9PiB2b2lkO1xuICBmb3JtYXROdW1iZXI6IChudW06IG51bWJlcikgPT4gc3RyaW5nO1xuICBvbkFkZFRvUGxheWxpc3Q6IChzb25nOiBTb25nKSA9PiB2b2lkO1xuICBvbkFkZFRvUXVldWU6IChzb25nOiBTb25nKSA9PiB2b2lkO1xuICBpbWFnZVVybHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47ICAvLyBORVdcbiAgb25Mb2FkTW9yZTogKCkgPT4gdm9pZDsgICAgICAgICAgICAgLy8gTkVXXG4gIGhhc01vcmVTb25nczogYm9vbGVhbjsgICAgICAgICAgICAgIC8vIE5FV1xuICByZWNlbnRseVBsYXllZFNvbmdzOiBTb25nW107ICAgICAgICAvLyBORVdcbn1cblxuXG5jb25zdCBIb21lUGFnZTogUmVhY3QuRkM8SG9tZVBhZ2VQcm9wcz4gPSAoeyBzb25ncywgb25Tb25nUGxheSwgZm9ybWF0TnVtYmVyLCBvbkFkZFRvUGxheWxpc3QsIG9uQWRkVG9RdWV1ZSwgaW1hZ2VVcmxzLG9uTG9hZE1vcmUsaGFzTW9yZVNvbmdzLCByZWNlbnRseVBsYXllZFNvbmdzIH0pID0+IHtcbiAgY29uc3QgeyBpc0RhcmtNb2RlIH0gPSB1c2VUaGVtZSgpO1xuICBjb25zdCB7IHVzZXIgfSA9IHVzZUF1dGgoKTtcbiAgXG4gIC8vIFNob3cgbG9hZGluZyBzdGF0ZSBpZiBubyBzb25ncyBhcmUgbG9hZGVkIHlldFxuICBpZiAoc29uZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtgbWluLWgtc2NyZWVuICR7aXNEYXJrTW9kZSA/ICdiZy1ncmF5LTkwMCB0ZXh0LXdoaXRlJyA6ICdiZy1ncmF5LTUwIHRleHQtZ3JheS05MDAnfSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlcmB9PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmltYXRlLXNwaW4gcm91bmRlZC1mdWxsIGgtMTIgdy0xMiBib3JkZXItYi0yIGJvcmRlci1wdXJwbGUtNTAwIG14LWF1dG8gbWItNFwiPjwvZGl2PlxuICAgICAgICAgIDxwIGNsYXNzTmFtZT17aXNEYXJrTW9kZSA/ICd0ZXh0LWdyYXktNDAwJyA6ICd0ZXh0LWdyYXktNjAwJ30+TG9hZGluZyB5b3VyIG11c2ljLi4uPC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPXtgbWluLWgtc2NyZWVuICR7aXNEYXJrTW9kZSA/ICdiZy1ncmF5LTkwMCB0ZXh0LXdoaXRlJyA6ICdiZy1ncmF5LTUwIHRleHQtZ3JheS05MDAnfWB9PlxuICAgICAgey8qIEhlYWRlciAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtgc3RpY2t5IHRvcC0wICR7aXNEYXJrTW9kZSA/ICdiZy1ncmF5LTkwMC85NScgOiAnYmctZ3JheS01MC85NSd9IGJhY2tkcm9wLWJsdXItbWQgei0xMCBweC00IHB5LTRgfT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gbWItNFwiPlxuICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8aDEgY2xhc3NOYW1lPVwidGV4dC0yeGwgZm9udC1ib2xkXCI+R29vZCBldmVuaW5nPC9oMT5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT17YCR7aXNEYXJrTW9kZSA/ICd0ZXh0LWdyYXktNDAwJyA6ICd0ZXh0LWdyYXktNjAwJ30gdGV4dC1zbWB9PldoYXQgZG8geW91IHdhbnQgdG8gbGlzdGVuIHRvPzwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctMTAgaC0xMCByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgb3ZlcmZsb3ctaGlkZGVuXCI+XG4gICAgICAgICAgICB7dXNlcj8udXNlcl9tZXRhZGF0YT8uYXZhdGFyX3VybCA/IChcbiAgICAgICAgICAgICAgPGltZyBcbiAgICAgICAgICAgICAgICBzcmM9e3VzZXIudXNlcl9tZXRhZGF0YS5hdmF0YXJfdXJsfSBcbiAgICAgICAgICAgICAgICBhbHQ9XCJQcm9maWxlXCIgXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIGgtZnVsbCBvYmplY3QtY292ZXJcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgaC1mdWxsIGJnLWdyYWRpZW50LXRvLWJyIGZyb20tcHVycGxlLTUwMCB0by1waW5rLTUwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgIDxNdXNpYyBzaXplPXsyMH0gY2xhc3NOYW1lPVwidGV4dC13aGl0ZVwiIC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIENvbnRlbnQgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInB4LTQgcGItNFwiPlxuICAgICAgICB7LyogVHJlbmRpbmcgU2VjdGlvbiAqL31cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYi04XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gbWItNFwiPlxuICAgICAgICAgICAgPGgyIGNsYXNzTmFtZT1cInRleHQteGwgZm9udC1zZW1pYm9sZCBmbGV4IGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgICA8VHJlbmRpbmdVcCBjbGFzc05hbWU9XCJtci0yIHRleHQtcHVycGxlLTQwMFwiIHNpemU9ezIwfSAvPlxuICAgICAgICAgICAgICBUcmVuZGluZyBOb3dcbiAgICAgICAgICAgIDwvaDI+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cInRleHQtcHVycGxlLTQwMCB0ZXh0LXNtIGZvbnQtbWVkaXVtXCI+U2VlIGFsbDwvYnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBzcGFjZS14LTQgb3ZlcmZsb3cteC1hdXRvIHBiLTIgc2Nyb2xsYmFyLWhpZGVcIj5cbiAgICAgICAgICAgIHtzb25ncy5zbGljZSgwLCAxMCkubWFwKChzb25nKSA9PiAoXG4gICAgICAgICAgICAgIDxUcmVuZGluZ1NvbmcgXG4gICAgICAgICAgICAgICAga2V5PXtzb25nLmlkfVxuICAgICAgICAgICAgICAgIHNvbmc9e3sgLi4uc29uZywgaW1hZ2U6IGltYWdlVXJsc1tzb25nLmlkXSB8fCAnJyB9fVxuICAgICAgICAgICAgICAgIG9uUGxheT17b25Tb25nUGxheX1cbiAgICAgICAgICAgICAgICBmb3JtYXROdW1iZXI9e2Zvcm1hdE51bWJlcn1cbiAgICAgICAgICAgICAgICBjYWNoZWRJbWFnZVVybD17aW1hZ2VVcmxzW3NvbmcuaWRdfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKSl9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG57cmVjZW50bHlQbGF5ZWRTb25ncy5sZW5ndGggPiAwICYmIChcbiAgPGRpdiBjbGFzc05hbWU9XCJtYi04XCI+XG4gICAgPGgyIGNsYXNzTmFtZT1cInRleHQteGwgZm9udC1ib2xkIG1iLTQgcHgtMlwiPlJlY2VudGx5IFBsYXllZDwvaDI+XG4gICAgPGRpdiBjbGFzc05hbWU9XCJvdmVyZmxvdy14LWF1dG9cIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBnYXAtNiBweC0yIHB5LTRcIj5cbiAgICAgICAge0FycmF5LmZyb20oeyBsZW5ndGg6IE1hdGguY2VpbChyZWNlbnRseVBsYXllZFNvbmdzLmxlbmd0aCAvIDMpIH0pLm1hcCgoXywgY29sdW1uSW5kZXgpID0+IHtcbiAgICAgICAgICBjb25zdCBzdGFydCA9IGNvbHVtbkluZGV4ICogMztcbiAgICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIDM7XG4gICAgICAgICAgY29uc3QgZ3JvdXAgPSByZWNlbnRseVBsYXllZFNvbmdzLnNsaWNlKHN0YXJ0LCBlbmQpO1xuXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYga2V5PXtjb2x1bW5JbmRleH0gY2xhc3NOYW1lPVwibWluLXctWzI2MHB4XSBmbGV4IGZsZXgtY29sIGdhcC01XCI+XG4gICAgICAgICAgICAgIHtncm91cC5tYXAoKHNvbmcpID0+IChcbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICBrZXk9e3NvbmcuaWR9XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBwLTMgYmctZ3JheS04MDAvNTAgaG92ZXI6YmctZ3JheS04MDAgcm91bmRlZC1sZyB0cmFuc2l0aW9uLWFsbCBncm91cCBjdXJzb3ItcG9pbnRlclwiXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBvblNvbmdQbGF5KHsgLi4uc29uZywgaW1hZ2U6IGltYWdlVXJsc1tzb25nLmlkXSB8fCAnJyB9KX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8aW1nXG4gICAgICAgICAgICAgICAgICAgIHNyYz17aW1hZ2VVcmxzW3NvbmcuaWRdIHx8ICcvcGxhY2Vob2xkZXIuanBnJ31cbiAgICAgICAgICAgICAgICAgICAgYWx0PXtzb25nLm5hbWV9XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctMTYgaC0xNiByb3VuZGVkLWxnIG9iamVjdC1jb3ZlciBzaGFkb3ctbWRcIlxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBtbC00XCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1iYXNlIGZvbnQtc2VtaWJvbGQgdGV4dC13aGl0ZVwiPntzb25nLm5hbWV9PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LW5ldXRyYWwtMzAwXCI+e3NvbmcuYXJ0aXN0fTwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKTtcbiAgICAgICAgfSl9XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG4pfVxuXG5cbiAgICAgICAgey8qIFJlY29tbWVuZGF0aW9ucyBTZWN0aW9uICovfVxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIG1iLTRcIj5cbiAgICAgICAgICAgIDxoMiBjbGFzc05hbWU9XCJ0ZXh0LXhsIGZvbnQtc2VtaWJvbGRcIj5NYWRlIGZvciB5b3U8L2gyPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJ0ZXh0LXB1cnBsZS00MDAgdGV4dC1zbSBmb250LW1lZGl1bVwiPlNlZSBhbGw8L2J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktM1wiPlxuICAgICAgICAgICAge3NvbmdzLm1hcCgoc29uZykgPT4gKFxuICAgICAgICAgICAgICA8U29uZ0NhcmQgXG4gICAgICAgICAgICAgICAga2V5PXtzb25nLmlkfVxuICAgICAgICAgICAgICAgIHNvbmc9e3sgLi4uc29uZywgaW1hZ2U6IGltYWdlVXJsc1tzb25nLmlkXSB8fCAnJyB9fVxuICAgICAgICAgICAgICAgIG9uUGxheT17b25Tb25nUGxheX1cbiAgICAgICAgICAgICAgICBmb3JtYXROdW1iZXI9e2Zvcm1hdE51bWJlcn1cbiAgICAgICAgICAgICAgICBvbkFkZFRvUGxheWxpc3Q9e29uQWRkVG9QbGF5bGlzdH1cbiAgICAgICAgICAgICAgICBvbkFkZFRvUXVldWU9e29uQWRkVG9RdWV1ZX1cbiAgICAgICAgICAgICAgICBjYWNoZWRJbWFnZVVybD17aW1hZ2VVcmxzW3NvbmcuaWRdfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKSl9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBIb21lUGFnZTsiXSwibmFtZXMiOlsidXNlVGhlbWUiLCJ1c2VBdXRoIiwiTXVzaWMiLCJUcmVuZGluZ1VwIiwiUmVhY3QiLCJTb25nQ2FyZCIsIlRyZW5kaW5nU29uZyIsIkhvbWVQYWdlIiwic29uZ3MiLCJvblNvbmdQbGF5IiwiZm9ybWF0TnVtYmVyIiwib25BZGRUb1BsYXlsaXN0Iiwib25BZGRUb1F1ZXVlIiwiaW1hZ2VVcmxzIiwib25Mb2FkTW9yZSIsImhhc01vcmVTb25ncyIsInJlY2VudGx5UGxheWVkU29uZ3MiLCJ1c2VyIiwiaXNEYXJrTW9kZSIsImxlbmd0aCIsImRpdiIsImNsYXNzTmFtZSIsInAiLCJoMSIsInVzZXJfbWV0YWRhdGEiLCJhdmF0YXJfdXJsIiwiaW1nIiwic3JjIiwiYWx0Iiwic2l6ZSIsImgyIiwiYnV0dG9uIiwic2xpY2UiLCJtYXAiLCJzb25nIiwiaW1hZ2UiLCJpZCIsIm9uUGxheSIsImNhY2hlZEltYWdlVXJsIiwiQXJyYXkiLCJmcm9tIiwiTWF0aCIsImNlaWwiLCJfIiwiY29sdW1uSW5kZXgiLCJzdGFydCIsImVuZCIsImdyb3VwIiwib25DbGljayIsIm5hbWUiLCJhcnRpc3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./components/HomePage.tsx\n"));

/***/ }),

/***/ "(app-pages-browser)/./hooks/useSupabaseData.ts":
/*!**********************************!*\
  !*** ./hooks/useSupabaseData.ts ***!
  \**********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useSupabaseData: function() { return /* binding */ useSupabaseData; }\n/* harmony export */ });\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase */ \"(app-pages-browser)/./lib/supabase.ts\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction useSupabaseData(user) {\n    const [songs, setSongs] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [playlists, setPlaylists] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [likedSongs, setLikedSongs] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(new Set());\n    const [lastPlayedSong, setLastPlayedSong] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [recentlyPlayedSongs, setRecentlyPlayedSongs] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [personalizedSongs, setPersonalizedSongs] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(true);\n    const [currentSongStartTime, setCurrentSongStartTime] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const currentSongRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    // Get personalized songs based on user's actual listening preferences\n    const getSmartPersonalizedSongs = async (userId, listenedSongsInBatch, excludeSongs)=>{\n        try {\n            console.log(\"\\uD83E\\uDDE0 Fetching smart personalized songs based on listening behavior\");\n            console.log(\"\\uD83C\\uDFB5 Songs user actually listened to:\", listenedSongsInBatch.map((s)=>s.name));\n            if (listenedSongsInBatch.length === 0) {\n                console.log(\"⚠️ No listened songs in batch, falling back to regular personalization\");\n                return [];\n            }\n            // Extract tags and artists from listened songs\n            const preferredTags = new Set();\n            const preferredArtists = new Set();\n            listenedSongsInBatch.forEach((song)=>{\n                var _song_tags;\n                (_song_tags = song.tags) === null || _song_tags === void 0 ? void 0 : _song_tags.forEach((tag)=>preferredTags.add(tag.toLowerCase()));\n                preferredArtists.add(song.artist.toLowerCase());\n            });\n            console.log(\"\\uD83C\\uDFF7️ Preferred tags:\", Array.from(preferredTags));\n            console.log(\"\\uD83C\\uDFA4 Preferred artists:\", Array.from(preferredArtists));\n            // Fetch all songs from database\n            const { data: songsData, error: songsError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"songs\").select(\"*\");\n            if (songsError) {\n                console.error(\"❌ Error fetching songs for smart personalization:\", songsError);\n                return [];\n            }\n            if (!songsData || songsData.length === 0) {\n                console.warn(\"⚠️ No songs found in database\");\n                return [];\n            }\n            // Get user's liked songs\n            const { data: likedData } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"liked_songs\").select(\"song_id\").eq(\"user_id\", userId);\n            const userLikedSongs = new Set();\n            if (likedData) {\n                likedData.forEach((item)=>userLikedSongs.add(item.song_id));\n            }\n            // Filter and score songs based on listening preferences\n            const availableSongs = songsData.filter((song)=>{\n                return !excludeSongs.has(song.file_id.toString());\n            });\n            console.log(\"\\uD83C\\uDFB5 Available songs for smart recommendations: \".concat(availableSongs.length));\n            if (availableSongs.length === 0) {\n                console.warn(\"⚠️ No available songs after filtering\");\n                return [];\n            }\n            // Score songs based on user's listening preferences\n            const scoredSongs = availableSongs.map((song)=>{\n                var _song_tags;\n                let score = 0;\n                // High priority: Tag matching with listened songs\n                const songTags = ((_song_tags = song.tags) === null || _song_tags === void 0 ? void 0 : _song_tags.map((tag)=>tag.toLowerCase())) || [];\n                const matchingTags = songTags.filter((tag)=>preferredTags.has(tag));\n                score += matchingTags.length * 25; // Higher weight for tag matching\n                // High priority: Artist matching with listened songs\n                if (preferredArtists.has(song.artist.toLowerCase())) {\n                    score += 30; // Higher weight for artist matching\n                }\n                // Medium priority: Same language as listened songs\n                const listenedLanguages = listenedSongsInBatch.map((s)=>s.language);\n                if (listenedLanguages.includes(song.language)) {\n                    score += 15;\n                }\n                // Lower priority: General popularity\n                score += Math.log(1 + (song.likes || 0)) * 2;\n                score += Math.log(1 + (song.views || 0)) * 1;\n                // Bonus for liked songs\n                if (userLikedSongs.has(song.file_id)) {\n                    score += 10;\n                }\n                // Add small randomness to avoid repetition\n                score += Math.random() * 2;\n                return {\n                    song: convertDatabaseSong(song, userLikedSongs.has(song.file_id)),\n                    score\n                };\n            });\n            // Sort by score and return top recommendations\n            const recommendations = scoredSongs.sort((a, b)=>b.score - a.score).slice(0, 15) // Get more songs for variety\n            .map((entry)=>entry.song);\n            console.log(\"\\uD83E\\uDDE0 Smart recommendations based on listening behavior:\", recommendations.slice(0, 5).map((s)=>\"\".concat(s.name, \" by \").concat(s.artist)));\n            return recommendations;\n        } catch (error) {\n            console.error(\"❌ Error in getSmartPersonalizedSongs:\", error);\n            return [];\n        }\n    };\n    // Convert database song to UI song format\n    const convertDatabaseSong = function(dbSong) {\n        let isLiked = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;\n        return {\n            file_id: dbSong.file_id,\n            img_id: dbSong.img_id,\n            name: dbSong.name,\n            artist: dbSong.artist,\n            language: dbSong.language,\n            tags: dbSong.tags,\n            views: dbSong.views,\n            likes: dbSong.likes,\n            id: dbSong.file_id.toString(),\n            image: \"https://images.pexels.com/photos/\".concat(dbSong.img_id, \"/pexels-photo-\").concat(dbSong.img_id, \".jpeg?auto=compress&cs=tinysrgb&w=300\"),\n            isLiked\n        };\n    };\n    // Fetch all songs\n    const fetchSongs = async ()=>{\n        if (!user) {\n            setSongs([]);\n            return;\n        }\n        try {\n            const { data: songsData, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"songs\").select(\"*\").order(\"views\", {\n                ascending: false\n            });\n            if (error) throw error;\n            let userLikedSongs = new Set();\n            const { data: likedData } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"liked_songs\").select(\"song_id\").eq(\"user_id\", user.id);\n            if (likedData) {\n                userLikedSongs = new Set(likedData.map((item)=>item.song_id));\n                setLikedSongs(userLikedSongs);\n            }\n            const convertedSongs = (songsData === null || songsData === void 0 ? void 0 : songsData.map((song)=>convertDatabaseSong(song, userLikedSongs.has(song.file_id)))) || [];\n            const sortedSongs = [\n                ...convertedSongs\n            ].sort((a, b)=>{\n                const aScore = a.views + a.likes;\n                const bScore = b.views + b.likes;\n                return bScore - aScore;\n            });\n            setSongs(sortedSongs);\n            const { data: userData } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"users\").select(\"last_song_file_id\").eq(\"id\", user.id).single();\n            if (userData === null || userData === void 0 ? void 0 : userData.last_song_file_id) {\n                const lastSong = convertedSongs.find((song)=>song.file_id === userData.last_song_file_id);\n                if (lastSong) {\n                    setLastPlayedSong(lastSong);\n                }\n            }\n        } catch (error) {\n            console.error(\"Error fetching songs:\", error);\n            setSongs([]) // Set empty array on error\n            ;\n        }\n    };\n    // Get personalized songs with proper error handling and filtering\n    const getPersonalizedSongs = async (userId, currentSong, listenedSongs)=>{\n        try {\n            console.log(\"\\uD83C\\uDFB5 Fetching personalized songs for:\", currentSong.name);\n            console.log(\"\\uD83C\\uDFB5 Listened songs count:\", (listenedSongs === null || listenedSongs === void 0 ? void 0 : listenedSongs.size) || 0);\n            // 1. Fetch all songs from database\n            const { data: songsData, error: songsError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"songs\").select(\"*\");\n            if (songsError) {\n                console.error(\"❌ Error fetching songs for personalization:\", songsError);\n                return [];\n            }\n            if (!songsData || songsData.length === 0) {\n                console.warn(\"⚠️ No songs found in database\");\n                return [];\n            }\n            // 2. Fetch user's listening history\n            const { data: historyData, error: historyError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"history\").select(\"song_id, minutes_listened\").eq(\"user_id\", userId);\n            if (historyError) {\n                console.error(\"❌ Error fetching history:\", historyError);\n            }\n            const historyMap = new Map();\n            if (historyData) {\n                historyData.forEach((h)=>historyMap.set(h.song_id, h.minutes_listened || 0));\n            }\n            // 3. Get user's liked songs\n            const { data: likedData } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"liked_songs\").select(\"song_id\").eq(\"user_id\", userId);\n            const userLikedSongs = new Set();\n            if (likedData) {\n                likedData.forEach((item)=>userLikedSongs.add(item.song_id));\n            }\n            // 4. Filter and score songs\n            const availableSongs = songsData.filter((song)=>{\n                // Exclude current song\n                if (song.file_id === currentSong.file_id) {\n                    return false;\n                }\n                // Exclude listened songs if provided\n                if (listenedSongs && listenedSongs.has(song.file_id.toString())) {\n                    console.log(\"\\uD83D\\uDEAB Excluding listened song: \".concat(song.name, \" by \").concat(song.artist));\n                    return false;\n                }\n                return true;\n            });\n            console.log(\"\\uD83C\\uDFB5 Available songs after filtering: \".concat(availableSongs.length));\n            if (availableSongs.length === 0) {\n                console.warn(\"⚠️ No available songs after filtering\");\n                return [];\n            }\n            // 5. Score and sort songs\n            const scoredSongs = availableSongs.map((song)=>{\n                var _song_tags;\n                let score = 0;\n                // Tag matching (highest priority)\n                const matchingTags = ((_song_tags = song.tags) === null || _song_tags === void 0 ? void 0 : _song_tags.filter((tag)=>{\n                    var _currentSong_tags;\n                    return (_currentSong_tags = currentSong.tags) === null || _currentSong_tags === void 0 ? void 0 : _currentSong_tags.includes(tag);\n                })) || [];\n                score += matchingTags.length * 15;\n                // Artist matching\n                if (song.artist === currentSong.artist) {\n                    score += 25;\n                }\n                // Language matching\n                if (song.language === currentSong.language) {\n                    score += 10;\n                }\n                // Listening history boost\n                const listenedMinutes = historyMap.get(song.file_id) || 0;\n                score += Math.min(listenedMinutes * 2, 20); // Cap at 20 points\n                // Popularity boost (likes and views)\n                score += Math.log(1 + (song.likes || 0)) * 2;\n                score += Math.log(1 + (song.views || 0)) * 1;\n                // Liked songs boost\n                if (userLikedSongs.has(song.file_id)) {\n                    score += 8;\n                }\n                // Add controlled randomness to avoid repetition\n                score += Math.random() * 3;\n                return {\n                    song: convertDatabaseSong(song, userLikedSongs.has(song.file_id)),\n                    score\n                };\n            });\n            // 6. Sort by score and return top recommendations\n            const recommendations = scoredSongs.sort((a, b)=>b.score - a.score).slice(0, 10) // Get more songs to have a buffer\n            .map((entry)=>entry.song);\n            console.log(\"\\uD83C\\uDFB5 Personalized recommendations:\", recommendations.slice(0, 5).map((s)=>\"\".concat(s.name, \" by \").concat(s.artist)));\n            console.log(\"\\uD83C\\uDFB5 Total available songs:\", availableSongs.length);\n            return recommendations;\n        } catch (error) {\n            console.error(\"❌ Error in getPersonalizedSongs:\", error);\n            return [];\n        }\n    };\n    // Get personalized songs based on user's top 10 history\n    const fetchPersonalizedSongs = async ()=>{\n        if (!user) {\n            setPersonalizedSongs([]);\n            return;\n        }\n        try {\n            console.log(\"\\uD83C\\uDFAF Fetching personalized songs based on listening history\");\n            // 1. Get user's top 10 songs from history\n            const { data: historyData, error: historyError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"history\").select(\"\\n          song_id,\\n          minutes_listened,\\n          songs (*)\\n        \").eq(\"user_id\", user.id).order(\"minutes_listened\", {\n                ascending: false\n            }).limit(10);\n            if (historyError) {\n                console.error(\"❌ Error fetching history for personalization:\", historyError);\n                setPersonalizedSongs([]);\n                return;\n            }\n            if (!historyData || historyData.length === 0) {\n                console.log(\"⚠️ No listening history found, using trending songs\");\n                // Fallback to trending songs if no history\n                const { data: trendingSongs } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"songs\").select(\"*\").order(\"views\", {\n                    ascending: false\n                }).limit(20);\n                if (trendingSongs) {\n                    const { data: likedData } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"liked_songs\").select(\"song_id\").eq(\"user_id\", user.id);\n                    const userLikedSongs = new Set();\n                    if (likedData) {\n                        likedData.forEach((item)=>userLikedSongs.add(item.song_id));\n                    }\n                    const converted = trendingSongs.map((song)=>convertDatabaseSong(song, userLikedSongs.has(song.file_id)));\n                    setPersonalizedSongs(converted);\n                }\n                return;\n            }\n            // 2. Extract common tags and artists from top songs\n            const topSongs = historyData.filter((item)=>item.songs).map((item)=>item.songs);\n            const tagCounts = new Map();\n            const artistCounts = new Map();\n            const historySongIds = new Set();\n            topSongs.forEach((song)=>{\n                historySongIds.add(song.file_id);\n                // Count tags\n                if (song.tags && Array.isArray(song.tags)) {\n                    song.tags.forEach((tag)=>{\n                        const normalizedTag = tag.toLowerCase().trim();\n                        tagCounts.set(normalizedTag, (tagCounts.get(normalizedTag) || 0) + 1);\n                    });\n                }\n                // Count artists\n                const normalizedArtist = song.artist.toLowerCase().trim();\n                artistCounts.set(normalizedArtist, (artistCounts.get(normalizedArtist) || 0) + 1);\n            });\n            // Get most common tags and artists\n            const commonTags = Array.from(tagCounts.entries()).sort((a, b)=>b[1] - a[1]).slice(0, 5).map((param)=>{\n                let [tag] = param;\n                return tag;\n            });\n            const commonArtists = Array.from(artistCounts.entries()).sort((a, b)=>b[1] - a[1]).slice(0, 3).map((param)=>{\n                let [artist] = param;\n                return artist;\n            });\n            console.log(\"\\uD83C\\uDFF7️ Common tags from history:\", commonTags);\n            console.log(\"\\uD83C\\uDFA4 Common artists from history:\", commonArtists);\n            // 3. Fetch all songs and filter out history songs\n            const { data: allSongs, error: songsError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"songs\").select(\"*\");\n            if (songsError) {\n                console.error(\"❌ Error fetching songs for personalization:\", songsError);\n                setPersonalizedSongs([]);\n                return;\n            }\n            if (!allSongs || allSongs.length === 0) {\n                setPersonalizedSongs([]);\n                return;\n            }\n            // 4. Get user's liked songs\n            const { data: likedData } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"liked_songs\").select(\"song_id\").eq(\"user_id\", user.id);\n            const userLikedSongs = new Set();\n            if (likedData) {\n                likedData.forEach((item)=>userLikedSongs.add(item.song_id));\n            }\n            // 5. Filter and score songs\n            const availableSongs = allSongs.filter((song)=>!historySongIds.has(song.file_id) // Exclude songs from history\n            );\n            console.log(\"\\uD83C\\uDFB5 Available songs after filtering history: \".concat(availableSongs.length));\n            if (availableSongs.length === 0) {\n                setPersonalizedSongs([]);\n                return;\n            }\n            // 6. Score songs based on common tags and artists\n            const scoredSongs = availableSongs.map((song)=>{\n                let score = 0;\n                // Score based on common tags (highest priority)\n                if (song.tags && Array.isArray(song.tags)) {\n                    const songTags = song.tags.map((tag)=>tag.toLowerCase().trim());\n                    const matchingTags = songTags.filter((tag)=>commonTags.includes(tag));\n                    score += matchingTags.length * 20 // High weight for tag matching\n                    ;\n                }\n                // Score based on common artists\n                const songArtist = song.artist.toLowerCase().trim();\n                if (commonArtists.includes(songArtist)) {\n                    score += 25 // High weight for artist matching\n                    ;\n                }\n                // Bonus for liked songs\n                if (userLikedSongs.has(song.file_id)) {\n                    score += 10;\n                }\n                // General popularity boost (lower weight)\n                score += Math.log(1 + (song.likes || 0)) * 2;\n                score += Math.log(1 + (song.views || 0)) * 1;\n                // Add small randomness to avoid repetition\n                score += Math.random() * 3;\n                return {\n                    song: convertDatabaseSong(song, userLikedSongs.has(song.file_id)),\n                    score\n                };\n            });\n            // 7. Sort by score and return top recommendations\n            const recommendations = scoredSongs.sort((a, b)=>b.score - a.score).slice(0, 30) // Get top 30 personalized songs\n            .map((entry)=>entry.song);\n            console.log(\"\\uD83C\\uDFAF Personalized recommendations:\", recommendations.slice(0, 5).map((s)=>\"\".concat(s.name, \" by \").concat(s.artist)));\n            setPersonalizedSongs(recommendations);\n        } catch (error) {\n            console.error(\"❌ Error in fetchPersonalizedSongs:\", error);\n            setPersonalizedSongs([]);\n        }\n    };\n    // Fetch recently played songs based on listening history\n    const fetchRecentlyPlayed = async ()=>{\n        if (!user) {\n            setRecentlyPlayedSongs([]);\n            return;\n        }\n        try {\n            // Get user's listening history sorted by minutes listened\n            const { data: historyData, error: historyError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"history\").select(\"\\n          song_id,\\n          minutes_listened,\\n          songs (*)\\n        \").eq(\"user_id\", user.id).order(\"minutes_listened\", {\n                ascending: false\n            }).limit(9);\n            if (historyError) {\n                console.error(\"Error fetching recently played:\", historyError);\n                return;\n            }\n            if (!historyData || historyData.length === 0) {\n                setRecentlyPlayedSongs([]);\n                return;\n            }\n            // Get user's liked songs for proper conversion\n            const { data: likedData } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"liked_songs\").select(\"song_id\").eq(\"user_id\", user.id);\n            const userLikedSongs = new Set();\n            if (likedData) {\n                likedData.forEach((item)=>userLikedSongs.add(item.song_id));\n            }\n            // Convert to Song format\n            const recentSongs = historyData.filter((item)=>item.songs) // Ensure song data exists\n            .map((item)=>convertDatabaseSong(item.songs, userLikedSongs.has(item.song_id)));\n            setRecentlyPlayedSongs(recentSongs);\n        } catch (error) {\n            console.error(\"Error fetching recently played songs:\", error);\n            setRecentlyPlayedSongs([]);\n        }\n    };\n    // Fetch user playlists\n    const fetchPlaylists = async ()=>{\n        if (!user) {\n            setPlaylists([]);\n            return;\n        }\n        try {\n            const { data: playlistsData, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"playlists\").select(\"\\n          id,\\n          name,\\n          playlist_songs (\\n            songs (*)\\n          )\\n        \").eq(\"user_id\", user.id);\n            if (error) throw error;\n            const convertedPlaylists = (playlistsData === null || playlistsData === void 0 ? void 0 : playlistsData.map((playlist)=>{\n                var _playlist_playlist_songs, _playlistSongs_;\n                const playlistSongs = ((_playlist_playlist_songs = playlist.playlist_songs) === null || _playlist_playlist_songs === void 0 ? void 0 : _playlist_playlist_songs.map((ps)=>convertDatabaseSong(ps.songs, likedSongs.has(ps.songs.file_id)))) || [];\n                return {\n                    id: playlist.id.toString(),\n                    name: playlist.name,\n                    songCount: playlistSongs.length,\n                    image: ((_playlistSongs_ = playlistSongs[0]) === null || _playlistSongs_ === void 0 ? void 0 : _playlistSongs_.image) || \"https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg?auto=compress&cs=tinysrgb&w=300\",\n                    songs: playlistSongs\n                };\n            })) || [];\n            setPlaylists(convertedPlaylists);\n        } catch (error) {\n            console.error(\"Error fetching playlists:\", error);\n        }\n    };\n    // Toggle like song\n    const toggleLike = async (songId)=>{\n        if (!user) return;\n        const songFileId = parseInt(songId);\n        const isCurrentlyLiked = likedSongs.has(songFileId);\n        try {\n            if (isCurrentlyLiked) {\n                // Remove from liked_songs\n                const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"liked_songs\").delete().eq(\"user_id\", user.id).eq(\"song_id\", songFileId);\n                if (error) throw error;\n                // Decrement likes\n                await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.rpc(\"decrement_song_likes\", {\n                    song_file_id: songFileId\n                });\n                setLikedSongs((prev)=>{\n                    const newSet = new Set(prev);\n                    newSet.delete(songFileId);\n                    return newSet;\n                });\n            } else {\n                // Add to liked_songs\n                const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"liked_songs\").insert({\n                    user_id: user.id,\n                    song_id: songFileId\n                });\n                if (error) throw error;\n                // Increment likes\n                await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.rpc(\"increment_song_likes\", {\n                    song_file_id: songFileId\n                });\n                setLikedSongs((prev)=>new Set(prev).add(songFileId));\n            }\n            // Update songs state\n            // Update songs state\n            setSongs((prevSongs)=>prevSongs.map((song)=>song.id === songId ? {\n                        ...song,\n                        isLiked: !isCurrentlyLiked,\n                        likes: song.likes + (isCurrentlyLiked ? -1 : 1)\n                    } : song));\n            // Update playlists state\n            setPlaylists((prevPlaylists)=>prevPlaylists.map((playlist)=>({\n                        ...playlist,\n                        songs: playlist.songs.map((song)=>song.id === songId ? {\n                                ...song,\n                                isLiked: !isCurrentlyLiked,\n                                likes: song.likes + (isCurrentlyLiked ? -1 : 1)\n                            } : song)\n                    })));\n        } catch (error) {\n            console.error(\"Error toggling like:\", error);\n        }\n    };\n    // Create playlist\n    const createPlaylist = async (name)=>{\n        if (!user) return;\n        try {\n            const { data, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"playlists\").insert({\n                user_id: user.id,\n                name\n            }).select().single();\n            if (error) throw error;\n            const newPlaylist = {\n                id: data.id.toString(),\n                name: data.name,\n                songCount: 0,\n                image: \"https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg?auto=compress&cs=tinysrgb&w=300\",\n                songs: []\n            };\n            setPlaylists((prev)=>[\n                    ...prev,\n                    newPlaylist\n                ]);\n        } catch (error) {\n            console.error(\"Error creating playlist:\", error);\n        }\n    };\n    // Delete playlist\n    const deletePlaylist = async (playlistId)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"playlists\").delete().eq(\"id\", parseInt(playlistId)).eq(\"user_id\", user.id);\n            if (error) throw error;\n            setPlaylists((prev)=>prev.filter((playlist)=>playlist.id !== playlistId));\n        } catch (error) {\n            console.error(\"Error deleting playlist:\", error);\n        }\n    };\n    // Rename playlist\n    const renamePlaylist = async (playlistId, newName)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"playlists\").update({\n                name: newName\n            }).eq(\"id\", parseInt(playlistId)).eq(\"user_id\", user.id);\n            if (error) throw error;\n            setPlaylists((prev)=>prev.map((playlist)=>playlist.id === playlistId ? {\n                        ...playlist,\n                        name: newName\n                    } : playlist));\n        } catch (error) {\n            console.error(\"Error renaming playlist:\", error);\n        }\n    };\n    // Add song to playlist\n    const addSongToPlaylist = async (playlistId, song)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"playlist_songs\").insert({\n                playlist_id: parseInt(playlistId),\n                song_id: song.file_id\n            });\n            if (error) throw error;\n            setPlaylists((prev)=>prev.map((playlist)=>{\n                    if (playlist.id === playlistId) {\n                        const songExists = playlist.songs.some((s)=>s.id === song.id);\n                        if (!songExists) {\n                            var _updatedSongs_;\n                            const updatedSongs = [\n                                ...playlist.songs,\n                                song\n                            ];\n                            return {\n                                ...playlist,\n                                songs: updatedSongs,\n                                songCount: updatedSongs.length,\n                                image: ((_updatedSongs_ = updatedSongs[0]) === null || _updatedSongs_ === void 0 ? void 0 : _updatedSongs_.image) || playlist.image\n                            };\n                        }\n                    }\n                    return playlist;\n                }));\n        } catch (error) {\n            console.error(\"Error adding song to playlist:\", error);\n        }\n    };\n    // Remove song from playlist\n    const removeSongFromPlaylist = async (playlistId, songId)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"playlist_songs\").delete().eq(\"playlist_id\", parseInt(playlistId)).eq(\"song_id\", parseInt(songId));\n            if (error) throw error;\n            setPlaylists((prev)=>prev.map((playlist)=>{\n                    if (playlist.id === playlistId) {\n                        var _updatedSongs_;\n                        const updatedSongs = playlist.songs.filter((song)=>song.id !== songId);\n                        return {\n                            ...playlist,\n                            songs: updatedSongs,\n                            songCount: updatedSongs.length,\n                            image: ((_updatedSongs_ = updatedSongs[0]) === null || _updatedSongs_ === void 0 ? void 0 : _updatedSongs_.image) || \"https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg?auto=compress&cs=tinysrgb&w=300\"\n                        };\n                    }\n                    return playlist;\n                }));\n        } catch (error) {\n            console.error(\"Error removing song from playlist:\", error);\n        }\n    };\n    // Update last song in user profile\n    const updateLastSong = async (songId)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"users\").update({\n                last_song_file_id: parseInt(songId)\n            }).eq(\"id\", user.id);\n            if (error) throw error;\n        } catch (error) {\n            console.error(\"Error updating last song:\", error);\n        }\n    };\n    // Record listening history with proper time tracking\n    const recordListeningHistory = async (songId)=>{\n        if (!user) return;\n        // If there's a previous song playing, record its listening time\n        if (currentSongRef.current && currentSongStartTime) {\n            const endTime = new Date();\n            const minutesListened = (endTime.getTime() - currentSongStartTime.getTime()) / (1000 * 60);\n            if (minutesListened > 0.1) {\n                try {\n                    const minutes = Math.round(minutesListened * 100) / 100;\n                    const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.rpc(\"upsert_history_minutes\", {\n                        user_uuid: user.id,\n                        song_file_id: parseInt(currentSongRef.current),\n                        minutes: minutes\n                    });\n                    if (error) {\n                        console.error(\"❌ Error recording song history:\", error);\n                    } else {\n                        console.log(\"✅ History updated: +\".concat(minutes, \" mins for song \").concat(currentSongRef.current));\n                    }\n                } catch (error) {\n                    console.error(\"Error recording previous song history:\", error);\n                }\n            }\n        }\n        // Set new song as current\n        currentSongRef.current = songId;\n        setCurrentSongStartTime(new Date());\n        // Update last song in user profile\n        await updateLastSong(songId);\n        try {\n            await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.rpc(\"increment_song_views\", {\n                song_file_id: parseInt(songId)\n            });\n        } catch (error) {\n            console.error(\"Error incrementing song views:\", error);\n        }\n    };\n    // Stop current song tracking (when player is closed)\n    const stopCurrentSongTracking = async ()=>{\n        if (currentSongRef.current && currentSongStartTime && user) {\n            const endTime = new Date();\n            const minutesListened = (endTime.getTime() - currentSongStartTime.getTime()) / (1000 * 60);\n            if (minutesListened > 0.1) {\n                try {\n                    const minutes = Math.round(minutesListened * 100) / 100;\n                    const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.rpc(\"upsert_history_minutes\", {\n                        user_uuid: user.id,\n                        song_file_id: parseInt(currentSongRef.current),\n                        minutes: minutes\n                    });\n                    if (error) {\n                        console.error(\"❌ Error recording song history on stop:\", error);\n                    } else {\n                        console.log(\"\\uD83D\\uDED1 History updated on stop: +\".concat(minutes, \" mins for song \").concat(currentSongRef.current));\n                    }\n                } catch (error) {\n                    console.error(\"Error recording final song history:\", error);\n                }\n            }\n        }\n        currentSongRef.current = null;\n        setCurrentSongStartTime(null);\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const loadData = async ()=>{\n            if (!user) {\n                // Reset data when user logs out\n                setSongs([]);\n                setPlaylists([]);\n                setLikedSongs(new Set());\n                setLastPlayedSong(null);\n                setLoading(false);\n                return;\n            }\n            try {\n                setLoading(true);\n                await Promise.all([\n                    fetchSongs(),\n                    fetchPlaylists(),\n                    fetchRecentlyPlayed(),\n                    fetchPersonalizedSongs()\n                ]);\n            } catch (error) {\n                console.error(\"Error loading data:\", error);\n            } finally{\n                setLoading(false);\n            }\n        };\n        loadData();\n    }, [\n        user\n    ]);\n    return {\n        songs,\n        personalizedSongs,\n        playlists,\n        likedSongs: songs.filter((song)=>song.isLiked),\n        recentlyPlayedSongs,\n        lastPlayedSong,\n        loading,\n        toggleLike,\n        createPlaylist,\n        deletePlaylist,\n        renamePlaylist,\n        addSongToPlaylist,\n        removeSongFromPlaylist,\n        recordListeningHistory,\n        stopCurrentSongTracking,\n        refreshData: ()=>{\n            fetchSongs();\n            fetchPlaylists();\n            fetchRecentlyPlayed();\n            fetchPersonalizedSongs();\n        },\n        getPersonalizedSongs,\n        getSmartPersonalizedSongs\n    };\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2hvb2tzL3VzZVN1cGFiYXNlRGF0YS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXVEO0FBR0o7QUFFNUMsU0FBU0ksZ0JBQWdCQyxJQUFpQjtJQUMvQyxNQUFNLENBQUNDLE9BQU9DLFNBQVMsR0FBR0osK0NBQVFBLENBQVMsRUFBRTtJQUM3QyxNQUFNLENBQUNLLFdBQVdDLGFBQWEsR0FBR04sK0NBQVFBLENBQWEsRUFBRTtJQUN6RCxNQUFNLENBQUNPLFlBQVlDLGNBQWMsR0FBR1IsK0NBQVFBLENBQWMsSUFBSVM7SUFDOUQsTUFBTSxDQUFDQyxnQkFBZ0JDLGtCQUFrQixHQUFHWCwrQ0FBUUEsQ0FBYztJQUNsRSxNQUFNLENBQUNZLHFCQUFxQkMsdUJBQXVCLEdBQUdiLCtDQUFRQSxDQUFTLEVBQUU7SUFDekUsTUFBTSxDQUFDYyxtQkFBbUJDLHFCQUFxQixHQUFHZiwrQ0FBUUEsQ0FBUyxFQUFFO0lBQ3JFLE1BQU0sQ0FBQ2dCLFNBQVNDLFdBQVcsR0FBR2pCLCtDQUFRQSxDQUFDO0lBQ3ZDLE1BQU0sQ0FBQ2tCLHNCQUFzQkMsd0JBQXdCLEdBQUduQiwrQ0FBUUEsQ0FBYztJQUM5RSxNQUFNb0IsaUJBQWlCckIsNkNBQU1BLENBQWdCO0lBRTdDLHNFQUFzRTtJQUN0RSxNQUFNc0IsNEJBQTRCLE9BQ2hDQyxRQUNBQyxzQkFDQUM7UUFFQSxJQUFJO1lBQ0ZDLFFBQVFDLEdBQUcsQ0FBQztZQUNaRCxRQUFRQyxHQUFHLENBQUMsaURBQXVDSCxxQkFBcUJJLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsSUFBSTtZQUV2RixJQUFJTixxQkFBcUJPLE1BQU0sS0FBSyxHQUFHO2dCQUNyQ0wsUUFBUUMsR0FBRyxDQUFDO2dCQUNaLE9BQU8sRUFBRTtZQUNYO1lBRUEsK0NBQStDO1lBQy9DLE1BQU1LLGdCQUFnQixJQUFJdEI7WUFDMUIsTUFBTXVCLG1CQUFtQixJQUFJdkI7WUFFN0JjLHFCQUFxQlUsT0FBTyxDQUFD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aENFLFNBQVMsRUFBRTtnQkFDWEUsYUFBYSxFQUFFO2dCQUNmRSxjQUFjLElBQUlDO2dCQUNsQkUsa0JBQWtCO2dCQUNsQk0sV0FBVztnQkFDWDtZQUNGO1lBRUEsSUFBSTtnQkFDRkEsV0FBVztnQkFDWCxNQUFNNEosUUFBUUMsR0FBRyxDQUFDO29CQUFDN0Y7b0JBQWM2QztvQkFBa0JGO29CQUF1QmpCO2lCQUF5QjtZQUNyRyxFQUFFLE9BQU8vRCxPQUFPO2dCQUNkbkIsUUFBUW1CLEtBQUssQ0FBQyx1QkFBdUJBO1lBQ3ZDLFNBQVU7Z0JBQ1IzQixXQUFXO1lBQ2I7UUFDRjtRQUVBMko7SUFDRixHQUFHO1FBQUMxSztLQUFLO0lBRVQsT0FBTztRQUNMQztRQUNBVztRQUNBVDtRQUNBRSxZQUFZSixNQUFNbUQsTUFBTSxDQUFDcEIsQ0FBQUEsT0FBUUEsS0FBSzJDLE9BQU87UUFDN0NqRTtRQUNBRjtRQUNBTTtRQUNBc0g7UUFDQWM7UUFDQUU7UUFDQUU7UUFDQUc7UUFDQUs7UUFDQUU7UUFDQVM7UUFDQUksYUFBYTtZQUNYOUY7WUFDQTZDO1lBQ0FGO1lBQ0FqQjtRQUNGO1FBQ0FkO1FBQ0F4RTtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vaG9va3MvdXNlU3VwYWJhc2VEYXRhLnRzP2FiZmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGF0YWJhc2VTb25nLCBzdXBhYmFzZSB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJ1xuaW1wb3J0IHsgUGxheWxpc3QsIFNvbmcgfSBmcm9tICdAL3R5cGVzJ1xuaW1wb3J0IHsgVXNlciB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcbmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0J1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlU3VwYWJhc2VEYXRhKHVzZXI6IFVzZXIgfCBudWxsKSB7XG4gIGNvbnN0IFtzb25ncywgc2V0U29uZ3NdID0gdXNlU3RhdGU8U29uZ1tdPihbXSlcbiAgY29uc3QgW3BsYXlsaXN0cywgc2V0UGxheWxpc3RzXSA9IHVzZVN0YXRlPFBsYXlsaXN0W10+KFtdKVxuICBjb25zdCBbbGlrZWRTb25ncywgc2V0TGlrZWRTb25nc10gPSB1c2VTdGF0ZTxTZXQ8bnVtYmVyPj4obmV3IFNldCgpKVxuICBjb25zdCBbbGFzdFBsYXllZFNvbmcsIHNldExhc3RQbGF5ZWRTb25nXSA9IHVzZVN0YXRlPFNvbmcgfCBudWxsPihudWxsKVxuICBjb25zdCBbcmVjZW50bHlQbGF5ZWRTb25ncywgc2V0UmVjZW50bHlQbGF5ZWRTb25nc10gPSB1c2VTdGF0ZTxTb25nW10+KFtdKVxuICBjb25zdCBbcGVyc29uYWxpemVkU29uZ3MsIHNldFBlcnNvbmFsaXplZFNvbmdzXSA9IHVzZVN0YXRlPFNvbmdbXT4oW10pXG4gIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpXG4gIGNvbnN0IFtjdXJyZW50U29uZ1N0YXJ0VGltZSwgc2V0Q3VycmVudFNvbmdTdGFydFRpbWVdID0gdXNlU3RhdGU8RGF0ZSB8IG51bGw+KG51bGwpXG4gIGNvbnN0IGN1cnJlbnRTb25nUmVmID0gdXNlUmVmPHN0cmluZyB8IG51bGw+KG51bGwpXG5cbiAgLy8gR2V0IHBlcnNvbmFsaXplZCBzb25ncyBiYXNlZCBvbiB1c2VyJ3MgYWN0dWFsIGxpc3RlbmluZyBwcmVmZXJlbmNlc1xuICBjb25zdCBnZXRTbWFydFBlcnNvbmFsaXplZFNvbmdzID0gYXN5bmMgKFxuICAgIHVzZXJJZDogc3RyaW5nLCBcbiAgICBsaXN0ZW5lZFNvbmdzSW5CYXRjaDogU29uZ1tdLCBcbiAgICBleGNsdWRlU29uZ3M6IFNldDxzdHJpbmc+XG4gICk6IFByb21pc2U8U29uZ1tdPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn6egIEZldGNoaW5nIHNtYXJ0IHBlcnNvbmFsaXplZCBzb25ncyBiYXNlZCBvbiBsaXN0ZW5pbmcgYmVoYXZpb3InKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn461IFNvbmdzIHVzZXIgYWN0dWFsbHkgbGlzdGVuZWQgdG86JywgbGlzdGVuZWRTb25nc0luQmF0Y2gubWFwKHMgPT4gcy5uYW1lKSk7XG4gICAgICBcbiAgICAgIGlmIChsaXN0ZW5lZFNvbmdzSW5CYXRjaC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBObyBsaXN0ZW5lZCBzb25ncyBpbiBiYXRjaCwgZmFsbGluZyBiYWNrIHRvIHJlZ3VsYXIgcGVyc29uYWxpemF0aW9uJyk7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cblxuICAgICAgLy8gRXh0cmFjdCB0YWdzIGFuZCBhcnRpc3RzIGZyb20gbGlzdGVuZWQgc29uZ3NcbiAgICAgIGNvbnN0IHByZWZlcnJlZFRhZ3MgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICAgIGNvbnN0IHByZWZlcnJlZEFydGlzdHMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICAgIFxuICAgICAgbGlzdGVuZWRTb25nc0luQmF0Y2guZm9yRWFjaChzb25nID0+IHtcbiAgICAgICAgc29uZy50YWdzPy5mb3JFYWNoKHRhZyA9PiBwcmVmZXJyZWRUYWdzLmFkZCh0YWcudG9Mb3dlckNhc2UoKSkpO1xuICAgICAgICBwcmVmZXJyZWRBcnRpc3RzLmFkZChzb25nLmFydGlzdC50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZygn8J+Pt++4jyBQcmVmZXJyZWQgdGFnczonLCBBcnJheS5mcm9tKHByZWZlcnJlZFRhZ3MpKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn46kIFByZWZlcnJlZCBhcnRpc3RzOicsIEFycmF5LmZyb20ocHJlZmVycmVkQXJ0aXN0cykpO1xuXG4gICAgICAvLyBGZXRjaCBhbGwgc29uZ3MgZnJvbSBkYXRhYmFzZVxuICAgICAgY29uc3QgeyBkYXRhOiBzb25nc0RhdGEsIGVycm9yOiBzb25nc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc29uZ3MnKVxuICAgICAgICAuc2VsZWN0KCcqJyk7XG4gICAgICBcbiAgICAgIGlmIChzb25nc0Vycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBmZXRjaGluZyBzb25ncyBmb3Igc21hcnQgcGVyc29uYWxpemF0aW9uOicsIHNvbmdzRXJyb3IpO1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICghc29uZ3NEYXRhIHx8IHNvbmdzRGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gTm8gc29uZ3MgZm91bmQgaW4gZGF0YWJhc2UnKTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgdXNlcidzIGxpa2VkIHNvbmdzXG4gICAgICBjb25zdCB7IGRhdGE6IGxpa2VkRGF0YSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2xpa2VkX3NvbmdzJylcbiAgICAgICAgLnNlbGVjdCgnc29uZ19pZCcpXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHVzZXJMaWtlZFNvbmdzID0gbmV3IFNldDxudW1iZXI+KCk7XG4gICAgICBpZiAobGlrZWREYXRhKSB7XG4gICAgICAgIGxpa2VkRGF0YS5mb3JFYWNoKGl0ZW0gPT4gdXNlckxpa2VkU29uZ3MuYWRkKGl0ZW0uc29uZ19pZCkpO1xuICAgICAgfVxuXG4gICAgICAvLyBGaWx0ZXIgYW5kIHNjb3JlIHNvbmdzIGJhc2VkIG9uIGxpc3RlbmluZyBwcmVmZXJlbmNlc1xuICAgICAgY29uc3QgYXZhaWxhYmxlU29uZ3MgPSBzb25nc0RhdGEuZmlsdGVyKChzb25nKSA9PiB7XG4gICAgICAgIHJldHVybiAhZXhjbHVkZVNvbmdzLmhhcyhzb25nLmZpbGVfaWQudG9TdHJpbmcoKSk7XG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coYPCfjrUgQXZhaWxhYmxlIHNvbmdzIGZvciBzbWFydCByZWNvbW1lbmRhdGlvbnM6ICR7YXZhaWxhYmxlU29uZ3MubGVuZ3RofWApO1xuXG4gICAgICBpZiAoYXZhaWxhYmxlU29uZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIE5vIGF2YWlsYWJsZSBzb25ncyBhZnRlciBmaWx0ZXJpbmcnKTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuXG4gICAgICAvLyBTY29yZSBzb25ncyBiYXNlZCBvbiB1c2VyJ3MgbGlzdGVuaW5nIHByZWZlcmVuY2VzXG4gICAgICBjb25zdCBzY29yZWRTb25ncyA9IGF2YWlsYWJsZVNvbmdzLm1hcCgoc29uZykgPT4ge1xuICAgICAgICBsZXQgc2NvcmUgPSAwO1xuXG4gICAgICAgIC8vIEhpZ2ggcHJpb3JpdHk6IFRhZyBtYXRjaGluZyB3aXRoIGxpc3RlbmVkIHNvbmdzXG4gICAgICAgIGNvbnN0IHNvbmdUYWdzID0gc29uZy50YWdzPy5tYXAoKHRhZzogc3RyaW5nKSA9PiB0YWcudG9Mb3dlckNhc2UoKSkgfHwgW107XG4gICAgICAgIGNvbnN0IG1hdGNoaW5nVGFncyA9IHNvbmdUYWdzLmZpbHRlcigodGFnOiBzdHJpbmcpID0+IHByZWZlcnJlZFRhZ3MuaGFzKHRhZykpO1xuICAgICAgICBzY29yZSArPSBtYXRjaGluZ1RhZ3MubGVuZ3RoICogMjU7IC8vIEhpZ2hlciB3ZWlnaHQgZm9yIHRhZyBtYXRjaGluZ1xuXG4gICAgICAgIC8vIEhpZ2ggcHJpb3JpdHk6IEFydGlzdCBtYXRjaGluZyB3aXRoIGxpc3RlbmVkIHNvbmdzXG4gICAgICAgIGlmIChwcmVmZXJyZWRBcnRpc3RzLmhhcyhzb25nLmFydGlzdC50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgIHNjb3JlICs9IDMwOyAvLyBIaWdoZXIgd2VpZ2h0IGZvciBhcnRpc3QgbWF0Y2hpbmdcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1lZGl1bSBwcmlvcml0eTogU2FtZSBsYW5ndWFnZSBhcyBsaXN0ZW5lZCBzb25nc1xuICAgICAgICBjb25zdCBsaXN0ZW5lZExhbmd1YWdlcyA9IGxpc3RlbmVkU29uZ3NJbkJhdGNoLm1hcChzID0+IHMubGFuZ3VhZ2UpO1xuICAgICAgICBpZiAobGlzdGVuZWRMYW5ndWFnZXMuaW5jbHVkZXMoc29uZy5sYW5ndWFnZSkpIHtcbiAgICAgICAgICBzY29yZSArPSAxNTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExvd2VyIHByaW9yaXR5OiBHZW5lcmFsIHBvcHVsYXJpdHlcbiAgICAgICAgc2NvcmUgKz0gTWF0aC5sb2coMSArIChzb25nLmxpa2VzIHx8IDApKSAqIDI7XG4gICAgICAgIHNjb3JlICs9IE1hdGgubG9nKDEgKyAoc29uZy52aWV3cyB8fCAwKSkgKiAxO1xuXG4gICAgICAgIC8vIEJvbnVzIGZvciBsaWtlZCBzb25nc1xuICAgICAgICBpZiAodXNlckxpa2VkU29uZ3MuaGFzKHNvbmcuZmlsZV9pZCkpIHtcbiAgICAgICAgICBzY29yZSArPSAxMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBzbWFsbCByYW5kb21uZXNzIHRvIGF2b2lkIHJlcGV0aXRpb25cbiAgICAgICAgc2NvcmUgKz0gTWF0aC5yYW5kb20oKSAqIDI7XG5cbiAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgc29uZzogY29udmVydERhdGFiYXNlU29uZyhzb25nLCB1c2VyTGlrZWRTb25ncy5oYXMoc29uZy5maWxlX2lkKSksIFxuICAgICAgICAgIHNjb3JlIFxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFNvcnQgYnkgc2NvcmUgYW5kIHJldHVybiB0b3AgcmVjb21tZW5kYXRpb25zXG4gICAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSBzY29yZWRTb25nc1xuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5zY29yZSAtIGEuc2NvcmUpXG4gICAgICAgIC5zbGljZSgwLCAxNSkgLy8gR2V0IG1vcmUgc29uZ3MgZm9yIHZhcmlldHlcbiAgICAgICAgLm1hcChlbnRyeSA9PiBlbnRyeS5zb25nKTtcblxuICAgICAgY29uc29sZS5sb2coJ/Cfp6AgU21hcnQgcmVjb21tZW5kYXRpb25zIGJhc2VkIG9uIGxpc3RlbmluZyBiZWhhdmlvcjonLCBcbiAgICAgICAgcmVjb21tZW5kYXRpb25zLnNsaWNlKDAsIDUpLm1hcChzID0+IGAke3MubmFtZX0gYnkgJHtzLmFydGlzdH1gKSk7XG4gICAgICBcbiAgICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGluIGdldFNtYXJ0UGVyc29uYWxpemVkU29uZ3M6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfTtcblxuICAvLyBDb252ZXJ0IGRhdGFiYXNlIHNvbmcgdG8gVUkgc29uZyBmb3JtYXRcbiAgY29uc3QgY29udmVydERhdGFiYXNlU29uZyA9IChkYlNvbmc6IERhdGFiYXNlU29uZywgaXNMaWtlZDogYm9vbGVhbiA9IGZhbHNlKTogU29uZyA9PiAoe1xuICAgIGZpbGVfaWQ6IGRiU29uZy5maWxlX2lkLFxuICAgIGltZ19pZDogZGJTb25nLmltZ19pZCxcbiAgICBuYW1lOiBkYlNvbmcubmFtZSxcbiAgICBhcnRpc3Q6IGRiU29uZy5hcnRpc3QsXG4gICAgbGFuZ3VhZ2U6IGRiU29uZy5sYW5ndWFnZSxcbiAgICB0YWdzOiBkYlNvbmcudGFncyxcbiAgICB2aWV3czogZGJTb25nLnZpZXdzLFxuICAgIGxpa2VzOiBkYlNvbmcubGlrZXMsXG4gICAgaWQ6IGRiU29uZy5maWxlX2lkLnRvU3RyaW5nKCksXG4gICAgaW1hZ2U6IGBodHRwczovL2ltYWdlcy5wZXhlbHMuY29tL3Bob3Rvcy8ke2RiU29uZy5pbWdfaWR9L3BleGVscy1waG90by0ke2RiU29uZy5pbWdfaWR9LmpwZWc/YXV0bz1jb21wcmVzcyZjcz10aW55c3JnYiZ3PTMwMGAsXG4gICAgaXNMaWtlZFxuICB9KVxuXG4gIC8vIEZldGNoIGFsbCBzb25nc1xuICBjb25zdCBmZXRjaFNvbmdzID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmICghdXNlcikge1xuICAgICAgc2V0U29uZ3MoW10pXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgZGF0YTogc29uZ3NEYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3NvbmdzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5vcmRlcigndmlld3MnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcblxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuXG4gICAgICBsZXQgdXNlckxpa2VkU29uZ3MgPSBuZXcgU2V0PG51bWJlcj4oKVxuICAgICAgXG4gICAgICBjb25zdCB7IGRhdGE6IGxpa2VkRGF0YSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2xpa2VkX3NvbmdzJylcbiAgICAgICAgLnNlbGVjdCgnc29uZ19pZCcpXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpXG4gICAgICBcbiAgICAgIGlmIChsaWtlZERhdGEpIHtcbiAgICAgICAgdXNlckxpa2VkU29uZ3MgPSBuZXcgU2V0KGxpa2VkRGF0YS5tYXAoaXRlbSA9PiBpdGVtLnNvbmdfaWQpKVxuICAgICAgICBzZXRMaWtlZFNvbmdzKHVzZXJMaWtlZFNvbmdzKVxuICAgICAgfVxuXG4gICAgICBjb25zdCBjb252ZXJ0ZWRTb25ncyA9IHNvbmdzRGF0YT8ubWFwKHNvbmcgPT4gXG4gICAgICAgIGNvbnZlcnREYXRhYmFzZVNvbmcoc29uZywgdXNlckxpa2VkU29uZ3MuaGFzKHNvbmcuZmlsZV9pZCkpXG4gICAgICApIHx8IFtdXG5cbiAgICAgIGNvbnN0IHNvcnRlZFNvbmdzID0gWy4uLmNvbnZlcnRlZFNvbmdzXS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGNvbnN0IGFTY29yZSA9IGEudmlld3MgKyBhLmxpa2VzO1xuICAgICAgICBjb25zdCBiU2NvcmUgPSBiLnZpZXdzICsgYi5saWtlcztcbiAgICAgICAgcmV0dXJuIGJTY29yZSAtIGFTY29yZTtcbiAgICAgIH0pO1xuXG4gICAgICBzZXRTb25ncyhzb3J0ZWRTb25ncyk7XG5cbiAgICAgIGNvbnN0IHsgZGF0YTogdXNlckRhdGEgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCd1c2VycycpXG4gICAgICAgIC5zZWxlY3QoJ2xhc3Rfc29uZ19maWxlX2lkJylcbiAgICAgICAgLmVxKCdpZCcsIHVzZXIuaWQpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBpZiAodXNlckRhdGE/Lmxhc3Rfc29uZ19maWxlX2lkKSB7XG4gICAgICAgIGNvbnN0IGxhc3RTb25nID0gY29udmVydGVkU29uZ3MuZmluZChzb25nID0+IHNvbmcuZmlsZV9pZCA9PT0gdXNlckRhdGEubGFzdF9zb25nX2ZpbGVfaWQpXG4gICAgICAgIGlmIChsYXN0U29uZykge1xuICAgICAgICAgIHNldExhc3RQbGF5ZWRTb25nKGxhc3RTb25nKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHNvbmdzOicsIGVycm9yKVxuICAgICAgc2V0U29uZ3MoW10pIC8vIFNldCBlbXB0eSBhcnJheSBvbiBlcnJvclxuICAgIH1cbiAgfVxuXG4gIC8vIEdldCBwZXJzb25hbGl6ZWQgc29uZ3Mgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcgYW5kIGZpbHRlcmluZ1xuICBjb25zdCBnZXRQZXJzb25hbGl6ZWRTb25ncyA9IGFzeW5jICh1c2VySWQ6IHN0cmluZywgY3VycmVudFNvbmc6IFNvbmcsIGxpc3RlbmVkU29uZ3M/OiBTZXQ8c3RyaW5nPik6IFByb21pc2U8U29uZ1tdPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn461IEZldGNoaW5nIHBlcnNvbmFsaXplZCBzb25ncyBmb3I6JywgY3VycmVudFNvbmcubmFtZSk7XG4gICAgICBjb25zb2xlLmxvZygn8J+OtSBMaXN0ZW5lZCBzb25ncyBjb3VudDonLCBsaXN0ZW5lZFNvbmdzPy5zaXplIHx8IDApO1xuICAgICAgXG4gICAgICAvLyAxLiBGZXRjaCBhbGwgc29uZ3MgZnJvbSBkYXRhYmFzZVxuICAgICAgY29uc3QgeyBkYXRhOiBzb25nc0RhdGEsIGVycm9yOiBzb25nc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc29uZ3MnKVxuICAgICAgICAuc2VsZWN0KCcqJyk7XG4gICAgICBcbiAgICAgIGlmIChzb25nc0Vycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBmZXRjaGluZyBzb25ncyBmb3IgcGVyc29uYWxpemF0aW9uOicsIHNvbmdzRXJyb3IpO1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICghc29uZ3NEYXRhIHx8IHNvbmdzRGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gTm8gc29uZ3MgZm91bmQgaW4gZGF0YWJhc2UnKTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuXG4gICAgICAvLyAyLiBGZXRjaCB1c2VyJ3MgbGlzdGVuaW5nIGhpc3RvcnlcbiAgICAgIGNvbnN0IHsgZGF0YTogaGlzdG9yeURhdGEsIGVycm9yOiBoaXN0b3J5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdoaXN0b3J5JylcbiAgICAgICAgLnNlbGVjdCgnc29uZ19pZCwgbWludXRlc19saXN0ZW5lZCcpXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZCk7XG4gICAgICBcbiAgICAgIGlmIChoaXN0b3J5RXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGZldGNoaW5nIGhpc3Rvcnk6JywgaGlzdG9yeUVycm9yKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgaGlzdG9yeU1hcCA9IG5ldyBNYXA8bnVtYmVyLCBudW1iZXI+KCk7XG4gICAgICBpZiAoaGlzdG9yeURhdGEpIHtcbiAgICAgICAgaGlzdG9yeURhdGEuZm9yRWFjaChoID0+IGhpc3RvcnlNYXAuc2V0KGguc29uZ19pZCwgaC5taW51dGVzX2xpc3RlbmVkIHx8IDApKTtcbiAgICAgIH1cblxuICAgICAgLy8gMy4gR2V0IHVzZXIncyBsaWtlZCBzb25nc1xuICAgICAgY29uc3QgeyBkYXRhOiBsaWtlZERhdGEgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdsaWtlZF9zb25ncycpXG4gICAgICAgIC5zZWxlY3QoJ3NvbmdfaWQnKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpO1xuICAgICAgXG4gICAgICBjb25zdCB1c2VyTGlrZWRTb25ncyA9IG5ldyBTZXQ8bnVtYmVyPigpO1xuICAgICAgaWYgKGxpa2VkRGF0YSkge1xuICAgICAgICBsaWtlZERhdGEuZm9yRWFjaChpdGVtID0+IHVzZXJMaWtlZFNvbmdzLmFkZChpdGVtLnNvbmdfaWQpKTtcbiAgICAgIH1cblxuICAgICAgLy8gNC4gRmlsdGVyIGFuZCBzY29yZSBzb25nc1xuICAgICAgY29uc3QgYXZhaWxhYmxlU29uZ3MgPSBzb25nc0RhdGEuZmlsdGVyKChzb25nKSA9PiB7XG4gICAgICAgIC8vIEV4Y2x1ZGUgY3VycmVudCBzb25nXG4gICAgICAgIGlmIChzb25nLmZpbGVfaWQgPT09IGN1cnJlbnRTb25nLmZpbGVfaWQpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4Y2x1ZGUgbGlzdGVuZWQgc29uZ3MgaWYgcHJvdmlkZWRcbiAgICAgICAgaWYgKGxpc3RlbmVkU29uZ3MgJiYgbGlzdGVuZWRTb25ncy5oYXMoc29uZy5maWxlX2lkLnRvU3RyaW5nKCkpKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYPCfmqsgRXhjbHVkaW5nIGxpc3RlbmVkIHNvbmc6ICR7c29uZy5uYW1lfSBieSAke3NvbmcuYXJ0aXN0fWApO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coYPCfjrUgQXZhaWxhYmxlIHNvbmdzIGFmdGVyIGZpbHRlcmluZzogJHthdmFpbGFibGVTb25ncy5sZW5ndGh9YCk7XG5cbiAgICAgIGlmIChhdmFpbGFibGVTb25ncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gTm8gYXZhaWxhYmxlIHNvbmdzIGFmdGVyIGZpbHRlcmluZycpO1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG5cbiAgICAgIC8vIDUuIFNjb3JlIGFuZCBzb3J0IHNvbmdzXG4gICAgICBjb25zdCBzY29yZWRTb25ncyA9IGF2YWlsYWJsZVNvbmdzLm1hcCgoc29uZykgPT4ge1xuICAgICAgICBsZXQgc2NvcmUgPSAwO1xuXG4gICAgICAgIC8vIFRhZyBtYXRjaGluZyAoaGlnaGVzdCBwcmlvcml0eSlcbiAgICAgICAgY29uc3QgbWF0Y2hpbmdUYWdzID0gc29uZy50YWdzPy5maWx0ZXIoKHRhZzogc3RyaW5nKSA9PlxuICAgICAgICAgIGN1cnJlbnRTb25nLnRhZ3M/LmluY2x1ZGVzKHRhZylcbiAgICAgICAgKSB8fCBbXTtcbiAgICAgICAgc2NvcmUgKz0gbWF0Y2hpbmdUYWdzLmxlbmd0aCAqIDE1O1xuXG4gICAgICAgIC8vIEFydGlzdCBtYXRjaGluZ1xuICAgICAgICBpZiAoc29uZy5hcnRpc3QgPT09IGN1cnJlbnRTb25nLmFydGlzdCkge1xuICAgICAgICAgIHNjb3JlICs9IDI1O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTGFuZ3VhZ2UgbWF0Y2hpbmdcbiAgICAgICAgaWYgKHNvbmcubGFuZ3VhZ2UgPT09IGN1cnJlbnRTb25nLmxhbmd1YWdlKSB7XG4gICAgICAgICAgc2NvcmUgKz0gMTA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBMaXN0ZW5pbmcgaGlzdG9yeSBib29zdFxuICAgICAgICBjb25zdCBsaXN0ZW5lZE1pbnV0ZXMgPSBoaXN0b3J5TWFwLmdldChzb25nLmZpbGVfaWQpIHx8IDA7XG4gICAgICAgIHNjb3JlICs9IE1hdGgubWluKGxpc3RlbmVkTWludXRlcyAqIDIsIDIwKTsgLy8gQ2FwIGF0IDIwIHBvaW50c1xuXG4gICAgICAgIC8vIFBvcHVsYXJpdHkgYm9vc3QgKGxpa2VzIGFuZCB2aWV3cylcbiAgICAgICAgc2NvcmUgKz0gTWF0aC5sb2coMSArIChzb25nLmxpa2VzIHx8IDApKSAqIDI7XG4gICAgICAgIHNjb3JlICs9IE1hdGgubG9nKDEgKyAoc29uZy52aWV3cyB8fCAwKSkgKiAxO1xuXG4gICAgICAgIC8vIExpa2VkIHNvbmdzIGJvb3N0XG4gICAgICAgIGlmICh1c2VyTGlrZWRTb25ncy5oYXMoc29uZy5maWxlX2lkKSkge1xuICAgICAgICAgIHNjb3JlICs9IDg7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgY29udHJvbGxlZCByYW5kb21uZXNzIHRvIGF2b2lkIHJlcGV0aXRpb25cbiAgICAgICAgc2NvcmUgKz0gTWF0aC5yYW5kb20oKSAqIDM7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzb25nOiBjb252ZXJ0RGF0YWJhc2VTb25nKHNvbmcsIHVzZXJMaWtlZFNvbmdzLmhhcyhzb25nLmZpbGVfaWQpKSxcbiAgICAgICAgICBzY29yZVxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIC8vIDYuIFNvcnQgYnkgc2NvcmUgYW5kIHJldHVybiB0b3AgcmVjb21tZW5kYXRpb25zXG4gICAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSBzY29yZWRTb25nc1xuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5zY29yZSAtIGEuc2NvcmUpXG4gICAgICAgIC5zbGljZSgwLCAxMCkgLy8gR2V0IG1vcmUgc29uZ3MgdG8gaGF2ZSBhIGJ1ZmZlclxuICAgICAgICAubWFwKGVudHJ5ID0+IGVudHJ5LnNvbmcpO1xuXG4gICAgICBjb25zb2xlLmxvZygn8J+OtSBQZXJzb25hbGl6ZWQgcmVjb21tZW5kYXRpb25zOicsIHJlY29tbWVuZGF0aW9ucy5zbGljZSgwLCA1KS5tYXAocyA9PiBgJHtzLm5hbWV9IGJ5ICR7cy5hcnRpc3R9YCkpO1xuICAgICAgY29uc29sZS5sb2coJ/CfjrUgVG90YWwgYXZhaWxhYmxlIHNvbmdzOicsIGF2YWlsYWJsZVNvbmdzLmxlbmd0aCk7XG4gICAgICBcbiAgICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGluIGdldFBlcnNvbmFsaXplZFNvbmdzOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH07XG5cbiAgLy8gR2V0IHBlcnNvbmFsaXplZCBzb25ncyBiYXNlZCBvbiB1c2VyJ3MgdG9wIDEwIGhpc3RvcnlcbiAgY29uc3QgZmV0Y2hQZXJzb25hbGl6ZWRTb25ncyA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHNldFBlcnNvbmFsaXplZFNvbmdzKFtdKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn46vIEZldGNoaW5nIHBlcnNvbmFsaXplZCBzb25ncyBiYXNlZCBvbiBsaXN0ZW5pbmcgaGlzdG9yeScpO1xuICAgICAgXG4gICAgICAvLyAxLiBHZXQgdXNlcidzIHRvcCAxMCBzb25ncyBmcm9tIGhpc3RvcnlcbiAgICAgIGNvbnN0IHsgZGF0YTogaGlzdG9yeURhdGEsIGVycm9yOiBoaXN0b3J5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdoaXN0b3J5JylcbiAgICAgICAgLnNlbGVjdChgXG4gICAgICAgICAgc29uZ19pZCxcbiAgICAgICAgICBtaW51dGVzX2xpc3RlbmVkLFxuICAgICAgICAgIHNvbmdzICgqKVxuICAgICAgICBgKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxuICAgICAgICAub3JkZXIoJ21pbnV0ZXNfbGlzdGVuZWQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgICAgLmxpbWl0KDEwKVxuXG4gICAgICBpZiAoaGlzdG9yeUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBmZXRjaGluZyBoaXN0b3J5IGZvciBwZXJzb25hbGl6YXRpb246JywgaGlzdG9yeUVycm9yKVxuICAgICAgICBzZXRQZXJzb25hbGl6ZWRTb25ncyhbXSlcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGlmICghaGlzdG9yeURhdGEgfHwgaGlzdG9yeURhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfimqDvuI8gTm8gbGlzdGVuaW5nIGhpc3RvcnkgZm91bmQsIHVzaW5nIHRyZW5kaW5nIHNvbmdzJylcbiAgICAgICAgLy8gRmFsbGJhY2sgdG8gdHJlbmRpbmcgc29uZ3MgaWYgbm8gaGlzdG9yeVxuICAgICAgICBjb25zdCB7IGRhdGE6IHRyZW5kaW5nU29uZ3MgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgLmZyb20oJ3NvbmdzJylcbiAgICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgICAub3JkZXIoJ3ZpZXdzJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAgICAgLmxpbWl0KDIwKVxuICAgICAgICBcbiAgICAgICAgaWYgKHRyZW5kaW5nU29uZ3MpIHtcbiAgICAgICAgICBjb25zdCB7IGRhdGE6IGxpa2VkRGF0YSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgIC5mcm9tKCdsaWtlZF9zb25ncycpXG4gICAgICAgICAgICAuc2VsZWN0KCdzb25nX2lkJylcbiAgICAgICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpXG4gICAgICAgICAgXG4gICAgICAgICAgY29uc3QgdXNlckxpa2VkU29uZ3MgPSBuZXcgU2V0PG51bWJlcj4oKVxuICAgICAgICAgIGlmIChsaWtlZERhdGEpIHtcbiAgICAgICAgICAgIGxpa2VkRGF0YS5mb3JFYWNoKGl0ZW0gPT4gdXNlckxpa2VkU29uZ3MuYWRkKGl0ZW0uc29uZ19pZCkpXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IGNvbnZlcnRlZCA9IHRyZW5kaW5nU29uZ3MubWFwKHNvbmcgPT4gXG4gICAgICAgICAgICBjb252ZXJ0RGF0YWJhc2VTb25nKHNvbmcsIHVzZXJMaWtlZFNvbmdzLmhhcyhzb25nLmZpbGVfaWQpKVxuICAgICAgICAgIClcbiAgICAgICAgICBzZXRQZXJzb25hbGl6ZWRTb25ncyhjb252ZXJ0ZWQpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIC8vIDIuIEV4dHJhY3QgY29tbW9uIHRhZ3MgYW5kIGFydGlzdHMgZnJvbSB0b3Agc29uZ3NcbiAgICAgIGNvbnN0IHRvcFNvbmdzID0gaGlzdG9yeURhdGFcbiAgICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0uc29uZ3MpXG4gICAgICAgIC5tYXAoaXRlbSA9PiBpdGVtLnNvbmdzKVxuICAgICAgXG4gICAgICBjb25zdCB0YWdDb3VudHMgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpXG4gICAgICBjb25zdCBhcnRpc3RDb3VudHMgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpXG4gICAgICBjb25zdCBoaXN0b3J5U29uZ0lkcyA9IG5ldyBTZXQ8bnVtYmVyPigpXG4gICAgICBcbiAgICAgIHRvcFNvbmdzLmZvckVhY2goc29uZyA9PiB7XG4gICAgICAgIGhpc3RvcnlTb25nSWRzLmFkZChzb25nLmZpbGVfaWQpXG4gICAgICAgIFxuICAgICAgICAvLyBDb3VudCB0YWdzXG4gICAgICAgIGlmIChzb25nLnRhZ3MgJiYgQXJyYXkuaXNBcnJheShzb25nLnRhZ3MpKSB7XG4gICAgICAgICAgc29uZy50YWdzLmZvckVhY2goKHRhZzogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkVGFnID0gdGFnLnRvTG93ZXJDYXNlKCkudHJpbSgpXG4gICAgICAgICAgICB0YWdDb3VudHMuc2V0KG5vcm1hbGl6ZWRUYWcsICh0YWdDb3VudHMuZ2V0KG5vcm1hbGl6ZWRUYWcpIHx8IDApICsgMSlcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDb3VudCBhcnRpc3RzXG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRBcnRpc3QgPSBzb25nLmFydGlzdC50b0xvd2VyQ2FzZSgpLnRyaW0oKVxuICAgICAgICBhcnRpc3RDb3VudHMuc2V0KG5vcm1hbGl6ZWRBcnRpc3QsIChhcnRpc3RDb3VudHMuZ2V0KG5vcm1hbGl6ZWRBcnRpc3QpIHx8IDApICsgMSlcbiAgICAgIH0pXG5cbiAgICAgIC8vIEdldCBtb3N0IGNvbW1vbiB0YWdzIGFuZCBhcnRpc3RzXG4gICAgICBjb25zdCBjb21tb25UYWdzID0gQXJyYXkuZnJvbSh0YWdDb3VudHMuZW50cmllcygpKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pXG4gICAgICAgIC5zbGljZSgwLCA1KVxuICAgICAgICAubWFwKChbdGFnXSkgPT4gdGFnKVxuICAgICAgXG4gICAgICBjb25zdCBjb21tb25BcnRpc3RzID0gQXJyYXkuZnJvbShhcnRpc3RDb3VudHMuZW50cmllcygpKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pXG4gICAgICAgIC5zbGljZSgwLCAzKVxuICAgICAgICAubWFwKChbYXJ0aXN0XSkgPT4gYXJ0aXN0KVxuXG4gICAgICBjb25zb2xlLmxvZygn8J+Pt++4jyBDb21tb24gdGFncyBmcm9tIGhpc3Rvcnk6JywgY29tbW9uVGFncylcbiAgICAgIGNvbnNvbGUubG9nKCfwn46kIENvbW1vbiBhcnRpc3RzIGZyb20gaGlzdG9yeTonLCBjb21tb25BcnRpc3RzKVxuXG4gICAgICAvLyAzLiBGZXRjaCBhbGwgc29uZ3MgYW5kIGZpbHRlciBvdXQgaGlzdG9yeSBzb25nc1xuICAgICAgY29uc3QgeyBkYXRhOiBhbGxTb25ncywgZXJyb3I6IHNvbmdzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzb25ncycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuXG4gICAgICBpZiAoc29uZ3NFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgZmV0Y2hpbmcgc29uZ3MgZm9yIHBlcnNvbmFsaXphdGlvbjonLCBzb25nc0Vycm9yKVxuICAgICAgICBzZXRQZXJzb25hbGl6ZWRTb25ncyhbXSlcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGlmICghYWxsU29uZ3MgfHwgYWxsU29uZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNldFBlcnNvbmFsaXplZFNvbmdzKFtdKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgLy8gNC4gR2V0IHVzZXIncyBsaWtlZCBzb25nc1xuICAgICAgY29uc3QgeyBkYXRhOiBsaWtlZERhdGEgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdsaWtlZF9zb25ncycpXG4gICAgICAgIC5zZWxlY3QoJ3NvbmdfaWQnKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxuICAgICAgXG4gICAgICBjb25zdCB1c2VyTGlrZWRTb25ncyA9IG5ldyBTZXQ8bnVtYmVyPigpXG4gICAgICBpZiAobGlrZWREYXRhKSB7XG4gICAgICAgIGxpa2VkRGF0YS5mb3JFYWNoKGl0ZW0gPT4gdXNlckxpa2VkU29uZ3MuYWRkKGl0ZW0uc29uZ19pZCkpXG4gICAgICB9XG5cbiAgICAgIC8vIDUuIEZpbHRlciBhbmQgc2NvcmUgc29uZ3NcbiAgICAgIGNvbnN0IGF2YWlsYWJsZVNvbmdzID0gYWxsU29uZ3MuZmlsdGVyKHNvbmcgPT4gXG4gICAgICAgICFoaXN0b3J5U29uZ0lkcy5oYXMoc29uZy5maWxlX2lkKSAvLyBFeGNsdWRlIHNvbmdzIGZyb20gaGlzdG9yeVxuICAgICAgKVxuXG4gICAgICBjb25zb2xlLmxvZyhg8J+OtSBBdmFpbGFibGUgc29uZ3MgYWZ0ZXIgZmlsdGVyaW5nIGhpc3Rvcnk6ICR7YXZhaWxhYmxlU29uZ3MubGVuZ3RofWApXG5cbiAgICAgIGlmIChhdmFpbGFibGVTb25ncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2V0UGVyc29uYWxpemVkU29uZ3MoW10pXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICAvLyA2LiBTY29yZSBzb25ncyBiYXNlZCBvbiBjb21tb24gdGFncyBhbmQgYXJ0aXN0c1xuICAgICAgY29uc3Qgc2NvcmVkU29uZ3MgPSBhdmFpbGFibGVTb25ncy5tYXAoc29uZyA9PiB7XG4gICAgICAgIGxldCBzY29yZSA9IDBcblxuICAgICAgICAvLyBTY29yZSBiYXNlZCBvbiBjb21tb24gdGFncyAoaGlnaGVzdCBwcmlvcml0eSlcbiAgICAgICAgaWYgKHNvbmcudGFncyAmJiBBcnJheS5pc0FycmF5KHNvbmcudGFncykpIHtcbiAgICAgICAgICBjb25zdCBzb25nVGFncyA9IHNvbmcudGFncy5tYXAoKHRhZzogc3RyaW5nKSA9PiB0YWcudG9Mb3dlckNhc2UoKS50cmltKCkpXG4gICAgICAgICAgY29uc3QgbWF0Y2hpbmdUYWdzID0gc29uZ1RhZ3MuZmlsdGVyKHRhZyA9PiBjb21tb25UYWdzLmluY2x1ZGVzKHRhZykpXG4gICAgICAgICAgc2NvcmUgKz0gbWF0Y2hpbmdUYWdzLmxlbmd0aCAqIDIwIC8vIEhpZ2ggd2VpZ2h0IGZvciB0YWcgbWF0Y2hpbmdcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNjb3JlIGJhc2VkIG9uIGNvbW1vbiBhcnRpc3RzXG4gICAgICAgIGNvbnN0IHNvbmdBcnRpc3QgPSBzb25nLmFydGlzdC50b0xvd2VyQ2FzZSgpLnRyaW0oKVxuICAgICAgICBpZiAoY29tbW9uQXJ0aXN0cy5pbmNsdWRlcyhzb25nQXJ0aXN0KSkge1xuICAgICAgICAgIHNjb3JlICs9IDI1IC8vIEhpZ2ggd2VpZ2h0IGZvciBhcnRpc3QgbWF0Y2hpbmdcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJvbnVzIGZvciBsaWtlZCBzb25nc1xuICAgICAgICBpZiAodXNlckxpa2VkU29uZ3MuaGFzKHNvbmcuZmlsZV9pZCkpIHtcbiAgICAgICAgICBzY29yZSArPSAxMFxuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2VuZXJhbCBwb3B1bGFyaXR5IGJvb3N0IChsb3dlciB3ZWlnaHQpXG4gICAgICAgIHNjb3JlICs9IE1hdGgubG9nKDEgKyAoc29uZy5saWtlcyB8fCAwKSkgKiAyXG4gICAgICAgIHNjb3JlICs9IE1hdGgubG9nKDEgKyAoc29uZy52aWV3cyB8fCAwKSkgKiAxXG5cbiAgICAgICAgLy8gQWRkIHNtYWxsIHJhbmRvbW5lc3MgdG8gYXZvaWQgcmVwZXRpdGlvblxuICAgICAgICBzY29yZSArPSBNYXRoLnJhbmRvbSgpICogM1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc29uZzogY29udmVydERhdGFiYXNlU29uZyhzb25nLCB1c2VyTGlrZWRTb25ncy5oYXMoc29uZy5maWxlX2lkKSksXG4gICAgICAgICAgc2NvcmVcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gNy4gU29ydCBieSBzY29yZSBhbmQgcmV0dXJuIHRvcCByZWNvbW1lbmRhdGlvbnNcbiAgICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IHNjb3JlZFNvbmdzXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSlcbiAgICAgICAgLnNsaWNlKDAsIDMwKSAvLyBHZXQgdG9wIDMwIHBlcnNvbmFsaXplZCBzb25nc1xuICAgICAgICAubWFwKGVudHJ5ID0+IGVudHJ5LnNvbmcpXG5cbiAgICAgIGNvbnNvbGUubG9nKCfwn46vIFBlcnNvbmFsaXplZCByZWNvbW1lbmRhdGlvbnM6JywgcmVjb21tZW5kYXRpb25zLnNsaWNlKDAsIDUpLm1hcChzID0+IGAke3MubmFtZX0gYnkgJHtzLmFydGlzdH1gKSlcbiAgICAgIHNldFBlcnNvbmFsaXplZFNvbmdzKHJlY29tbWVuZGF0aW9ucylcbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgaW4gZmV0Y2hQZXJzb25hbGl6ZWRTb25nczonLCBlcnJvcilcbiAgICAgIHNldFBlcnNvbmFsaXplZFNvbmdzKFtdKVxuICAgIH1cbiAgfVxuXG4gIC8vIEZldGNoIHJlY2VudGx5IHBsYXllZCBzb25ncyBiYXNlZCBvbiBsaXN0ZW5pbmcgaGlzdG9yeVxuICBjb25zdCBmZXRjaFJlY2VudGx5UGxheWVkID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmICghdXNlcikge1xuICAgICAgc2V0UmVjZW50bHlQbGF5ZWRTb25ncyhbXSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgdXNlcidzIGxpc3RlbmluZyBoaXN0b3J5IHNvcnRlZCBieSBtaW51dGVzIGxpc3RlbmVkXG4gICAgICBjb25zdCB7IGRhdGE6IGhpc3RvcnlEYXRhLCBlcnJvcjogaGlzdG9yeUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnaGlzdG9yeScpXG4gICAgICAgIC5zZWxlY3QoYFxuICAgICAgICAgIHNvbmdfaWQsXG4gICAgICAgICAgbWludXRlc19saXN0ZW5lZCxcbiAgICAgICAgICBzb25ncyAoKilcbiAgICAgICAgYClcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgICAgLm9yZGVyKCdtaW51dGVzX2xpc3RlbmVkJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAgIC5saW1pdCg5KVxuXG4gICAgICBpZiAoaGlzdG9yeUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHJlY2VudGx5IHBsYXllZDonLCBoaXN0b3J5RXJyb3IpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICBpZiAoIWhpc3RvcnlEYXRhIHx8IGhpc3RvcnlEYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzZXRSZWNlbnRseVBsYXllZFNvbmdzKFtdKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgLy8gR2V0IHVzZXIncyBsaWtlZCBzb25ncyBmb3IgcHJvcGVyIGNvbnZlcnNpb25cbiAgICAgIGNvbnN0IHsgZGF0YTogbGlrZWREYXRhIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnbGlrZWRfc29uZ3MnKVxuICAgICAgICAuc2VsZWN0KCdzb25nX2lkJylcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgIFxuICAgICAgY29uc3QgdXNlckxpa2VkU29uZ3MgPSBuZXcgU2V0PG51bWJlcj4oKVxuICAgICAgaWYgKGxpa2VkRGF0YSkge1xuICAgICAgICBsaWtlZERhdGEuZm9yRWFjaChpdGVtID0+IHVzZXJMaWtlZFNvbmdzLmFkZChpdGVtLnNvbmdfaWQpKVxuICAgICAgfVxuXG4gICAgICAvLyBDb252ZXJ0IHRvIFNvbmcgZm9ybWF0XG4gICAgICBjb25zdCByZWNlbnRTb25ncyA9IGhpc3RvcnlEYXRhXG4gICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLnNvbmdzKSAvLyBFbnN1cmUgc29uZyBkYXRhIGV4aXN0c1xuICAgICAgICAubWFwKGl0ZW0gPT4gY29udmVydERhdGFiYXNlU29uZyhpdGVtLnNvbmdzLCB1c2VyTGlrZWRTb25ncy5oYXMoaXRlbS5zb25nX2lkKSkpXG5cbiAgICAgIHNldFJlY2VudGx5UGxheWVkU29uZ3MocmVjZW50U29uZ3MpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHJlY2VudGx5IHBsYXllZCBzb25nczonLCBlcnJvcilcbiAgICAgIHNldFJlY2VudGx5UGxheWVkU29uZ3MoW10pXG4gICAgfVxuICB9XG5cbiAgLy8gRmV0Y2ggdXNlciBwbGF5bGlzdHNcbiAgY29uc3QgZmV0Y2hQbGF5bGlzdHMgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICBzZXRQbGF5bGlzdHMoW10pXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhOiBwbGF5bGlzdHNEYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BsYXlsaXN0cycpXG4gICAgICAgIC5zZWxlY3QoYFxuICAgICAgICAgIGlkLFxuICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgcGxheWxpc3Rfc29uZ3MgKFxuICAgICAgICAgICAgc29uZ3MgKCopXG4gICAgICAgICAgKVxuICAgICAgICBgKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxuXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG5cbiAgICAgIGNvbnN0IGNvbnZlcnRlZFBsYXlsaXN0czogUGxheWxpc3RbXSA9IHBsYXlsaXN0c0RhdGE/Lm1hcChwbGF5bGlzdCA9PiB7XG4gICAgICAgIGNvbnN0IHBsYXlsaXN0U29uZ3MgPSBwbGF5bGlzdC5wbGF5bGlzdF9zb25ncz8ubWFwKChwczogYW55KSA9PiBcbiAgICAgICAgICBjb252ZXJ0RGF0YWJhc2VTb25nKHBzLnNvbmdzLCBsaWtlZFNvbmdzLmhhcyhwcy5zb25ncy5maWxlX2lkKSlcbiAgICAgICAgKSB8fCBbXVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IHBsYXlsaXN0LmlkLnRvU3RyaW5nKCksXG4gICAgICAgICAgbmFtZTogcGxheWxpc3QubmFtZSxcbiAgICAgICAgICBzb25nQ291bnQ6IHBsYXlsaXN0U29uZ3MubGVuZ3RoLFxuICAgICAgICAgIGltYWdlOiBwbGF5bGlzdFNvbmdzWzBdPy5pbWFnZSB8fCAnaHR0cHM6Ly9pbWFnZXMucGV4ZWxzLmNvbS9waG90b3MvMTc2MzA3NS9wZXhlbHMtcGhvdG8tMTc2MzA3NS5qcGVnP2F1dG89Y29tcHJlc3MmY3M9dGlueXNyZ2Imdz0zMDAnLFxuICAgICAgICAgIHNvbmdzOiBwbGF5bGlzdFNvbmdzXG4gICAgICAgIH1cbiAgICAgIH0pIHx8IFtdXG5cbiAgICAgIHNldFBsYXlsaXN0cyhjb252ZXJ0ZWRQbGF5bGlzdHMpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHBsYXlsaXN0czonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyBUb2dnbGUgbGlrZSBzb25nXG4gIGNvbnN0IHRvZ2dsZUxpa2UgPSBhc3luYyAoc29uZ0lkOiBzdHJpbmcpID0+IHtcbiAgaWYgKCF1c2VyKSByZXR1cm47XG5cbiAgY29uc3Qgc29uZ0ZpbGVJZCA9IHBhcnNlSW50KHNvbmdJZCk7XG4gIGNvbnN0IGlzQ3VycmVudGx5TGlrZWQgPSBsaWtlZFNvbmdzLmhhcyhzb25nRmlsZUlkKTtcblxuICB0cnkge1xuICAgIGlmIChpc0N1cnJlbnRseUxpa2VkKSB7XG4gICAgICAvLyBSZW1vdmUgZnJvbSBsaWtlZF9zb25nc1xuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2xpa2VkX3NvbmdzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpXG4gICAgICAgIC5lcSgnc29uZ19pZCcsIHNvbmdGaWxlSWQpO1xuXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuXG4gICAgICAvLyBEZWNyZW1lbnQgbGlrZXNcbiAgICAgIGF3YWl0IHN1cGFiYXNlLnJwYygnZGVjcmVtZW50X3NvbmdfbGlrZXMnLCB7IHNvbmdfZmlsZV9pZDogc29uZ0ZpbGVJZCB9KTtcblxuICAgICAgc2V0TGlrZWRTb25ncyhwcmV2ID0+IHtcbiAgICAgICAgY29uc3QgbmV3U2V0ID0gbmV3IFNldChwcmV2KTtcbiAgICAgICAgbmV3U2V0LmRlbGV0ZShzb25nRmlsZUlkKTtcbiAgICAgICAgcmV0dXJuIG5ld1NldDtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBZGQgdG8gbGlrZWRfc29uZ3NcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdsaWtlZF9zb25ncycpXG4gICAgICAgIC5pbnNlcnQoe1xuICAgICAgICAgIHVzZXJfaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgc29uZ19pZDogc29uZ0ZpbGVJZCxcbiAgICAgICAgfSk7XG5cbiAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG5cbiAgICAgIC8vIEluY3JlbWVudCBsaWtlc1xuICAgICAgYXdhaXQgc3VwYWJhc2UucnBjKCdpbmNyZW1lbnRfc29uZ19saWtlcycsIHsgc29uZ19maWxlX2lkOiBzb25nRmlsZUlkIH0pO1xuXG4gICAgICBzZXRMaWtlZFNvbmdzKHByZXYgPT4gbmV3IFNldChwcmV2KS5hZGQoc29uZ0ZpbGVJZCkpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBzb25ncyBzdGF0ZVxuICAgIC8vIFVwZGF0ZSBzb25ncyBzdGF0ZVxuc2V0U29uZ3MocHJldlNvbmdzID0+XG4gIHByZXZTb25ncy5tYXAoc29uZyA9PlxuICAgIHNvbmcuaWQgPT09IHNvbmdJZFxuICAgICAgPyB7XG4gICAgICAgICAgLi4uc29uZyxcbiAgICAgICAgICBpc0xpa2VkOiAhaXNDdXJyZW50bHlMaWtlZCxcbiAgICAgICAgICBsaWtlczogc29uZy5saWtlcyArIChpc0N1cnJlbnRseUxpa2VkID8gLTEgOiAxKSxcbiAgICAgICAgfVxuICAgICAgOiBzb25nXG4gIClcbik7XG5cblxuICAgIC8vIFVwZGF0ZSBwbGF5bGlzdHMgc3RhdGVcbiAgICBzZXRQbGF5bGlzdHMocHJldlBsYXlsaXN0cyA9PlxuICAgICAgcHJldlBsYXlsaXN0cy5tYXAocGxheWxpc3QgPT4gKHtcbiAgICAgICAgLi4ucGxheWxpc3QsXG4gICAgICAgIHNvbmdzOiBwbGF5bGlzdC5zb25ncy5tYXAoc29uZyA9PlxuICAgICAgICAgIHNvbmcuaWQgPT09IHNvbmdJZFxuICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgLi4uc29uZyxcbiAgICAgICAgICAgICAgICBpc0xpa2VkOiAhaXNDdXJyZW50bHlMaWtlZCxcbiAgICAgICAgICAgICAgICBsaWtlczogc29uZy5saWtlcyArIChpc0N1cnJlbnRseUxpa2VkID8gLTEgOiAxKSxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiBzb25nXG4gICAgICAgICksXG4gICAgICB9KSlcbiAgICApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHRvZ2dsaW5nIGxpa2U6JywgZXJyb3IpO1xuICB9XG59O1xuXG5cbiAgLy8gQ3JlYXRlIHBsYXlsaXN0XG4gIGNvbnN0IGNyZWF0ZVBsYXlsaXN0ID0gYXN5bmMgKG5hbWU6IHN0cmluZykgPT4ge1xuICAgIGlmICghdXNlcikgcmV0dXJuXG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BsYXlsaXN0cycpXG4gICAgICAgIC5pbnNlcnQoe1xuICAgICAgICAgIHVzZXJfaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgbmFtZVxuICAgICAgICB9KVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG5cbiAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcblxuICAgICAgY29uc3QgbmV3UGxheWxpc3Q6IFBsYXlsaXN0ID0ge1xuICAgICAgICBpZDogZGF0YS5pZC50b1N0cmluZygpLFxuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIHNvbmdDb3VudDogMCxcbiAgICAgICAgaW1hZ2U6ICdodHRwczovL2ltYWdlcy5wZXhlbHMuY29tL3Bob3Rvcy8xNzYzMDc1L3BleGVscy1waG90by0xNzYzMDc1LmpwZWc/YXV0bz1jb21wcmVzcyZjcz10aW55c3JnYiZ3PTMwMCcsXG4gICAgICAgIHNvbmdzOiBbXVxuICAgICAgfVxuXG4gICAgICBzZXRQbGF5bGlzdHMocHJldiA9PiBbLi4ucHJldiwgbmV3UGxheWxpc3RdKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBwbGF5bGlzdDonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyBEZWxldGUgcGxheWxpc3RcbiAgY29uc3QgZGVsZXRlUGxheWxpc3QgPSBhc3luYyAocGxheWxpc3RJZDogc3RyaW5nKSA9PiB7XG4gICAgaWYgKCF1c2VyKSByZXR1cm5cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncGxheWxpc3RzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgnaWQnLCBwYXJzZUludChwbGF5bGlzdElkKSlcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcblxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuXG4gICAgICBzZXRQbGF5bGlzdHMocHJldiA9PiBwcmV2LmZpbHRlcihwbGF5bGlzdCA9PiBwbGF5bGlzdC5pZCAhPT0gcGxheWxpc3RJZCkpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHBsYXlsaXN0OicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIC8vIFJlbmFtZSBwbGF5bGlzdFxuICBjb25zdCByZW5hbWVQbGF5bGlzdCA9IGFzeW5jIChwbGF5bGlzdElkOiBzdHJpbmcsIG5ld05hbWU6IHN0cmluZykgPT4ge1xuICAgIGlmICghdXNlcikgcmV0dXJuXG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BsYXlsaXN0cycpXG4gICAgICAgIC51cGRhdGUoeyBuYW1lOiBuZXdOYW1lIH0pXG4gICAgICAgIC5lcSgnaWQnLCBwYXJzZUludChwbGF5bGlzdElkKSlcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcblxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuXG4gICAgICBzZXRQbGF5bGlzdHMocHJldiA9PiBcbiAgICAgICAgcHJldi5tYXAocGxheWxpc3QgPT4gXG4gICAgICAgICAgcGxheWxpc3QuaWQgPT09IHBsYXlsaXN0SWQgXG4gICAgICAgICAgICA/IHsgLi4ucGxheWxpc3QsIG5hbWU6IG5ld05hbWUgfVxuICAgICAgICAgICAgOiBwbGF5bGlzdFxuICAgICAgICApXG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbmFtaW5nIHBsYXlsaXN0OicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIC8vIEFkZCBzb25nIHRvIHBsYXlsaXN0XG4gIGNvbnN0IGFkZFNvbmdUb1BsYXlsaXN0ID0gYXN5bmMgKHBsYXlsaXN0SWQ6IHN0cmluZywgc29uZzogU29uZykgPT4ge1xuICAgIGlmICghdXNlcikgcmV0dXJuXG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BsYXlsaXN0X3NvbmdzJylcbiAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgcGxheWxpc3RfaWQ6IHBhcnNlSW50KHBsYXlsaXN0SWQpLFxuICAgICAgICAgIHNvbmdfaWQ6IHNvbmcuZmlsZV9pZFxuICAgICAgICB9KVxuXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG5cbiAgICAgIHNldFBsYXlsaXN0cyhwcmV2ID0+IFxuICAgICAgICBwcmV2Lm1hcChwbGF5bGlzdCA9PiB7XG4gICAgICAgICAgaWYgKHBsYXlsaXN0LmlkID09PSBwbGF5bGlzdElkKSB7XG4gICAgICAgICAgICBjb25zdCBzb25nRXhpc3RzID0gcGxheWxpc3Quc29uZ3Muc29tZShzID0+IHMuaWQgPT09IHNvbmcuaWQpXG4gICAgICAgICAgICBpZiAoIXNvbmdFeGlzdHMpIHtcbiAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZFNvbmdzID0gWy4uLnBsYXlsaXN0LnNvbmdzLCBzb25nXVxuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIC4uLnBsYXlsaXN0LFxuICAgICAgICAgICAgICAgIHNvbmdzOiB1cGRhdGVkU29uZ3MsXG4gICAgICAgICAgICAgICAgc29uZ0NvdW50OiB1cGRhdGVkU29uZ3MubGVuZ3RoLFxuICAgICAgICAgICAgICAgIGltYWdlOiB1cGRhdGVkU29uZ3NbMF0/LmltYWdlIHx8IHBsYXlsaXN0LmltYWdlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHBsYXlsaXN0XG4gICAgICAgIH0pXG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFkZGluZyBzb25nIHRvIHBsYXlsaXN0OicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIC8vIFJlbW92ZSBzb25nIGZyb20gcGxheWxpc3RcbiAgY29uc3QgcmVtb3ZlU29uZ0Zyb21QbGF5bGlzdCA9IGFzeW5jIChwbGF5bGlzdElkOiBzdHJpbmcsIHNvbmdJZDogc3RyaW5nKSA9PiB7XG4gICAgaWYgKCF1c2VyKSByZXR1cm5cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncGxheWxpc3Rfc29uZ3MnKVxuICAgICAgICAuZGVsZXRlKClcbiAgICAgICAgLmVxKCdwbGF5bGlzdF9pZCcsIHBhcnNlSW50KHBsYXlsaXN0SWQpKVxuICAgICAgICAuZXEoJ3NvbmdfaWQnLCBwYXJzZUludChzb25nSWQpKVxuXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG5cbiAgICAgIHNldFBsYXlsaXN0cyhwcmV2ID0+IFxuICAgICAgICBwcmV2Lm1hcChwbGF5bGlzdCA9PiB7XG4gICAgICAgICAgaWYgKHBsYXlsaXN0LmlkID09PSBwbGF5bGlzdElkKSB7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkU29uZ3MgPSBwbGF5bGlzdC5zb25ncy5maWx0ZXIoc29uZyA9PiBzb25nLmlkICE9PSBzb25nSWQpXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAuLi5wbGF5bGlzdCxcbiAgICAgICAgICAgICAgc29uZ3M6IHVwZGF0ZWRTb25ncyxcbiAgICAgICAgICAgICAgc29uZ0NvdW50OiB1cGRhdGVkU29uZ3MubGVuZ3RoLFxuICAgICAgICAgICAgICBpbWFnZTogdXBkYXRlZFNvbmdzWzBdPy5pbWFnZSB8fCAnaHR0cHM6Ly9pbWFnZXMucGV4ZWxzLmNvbS9waG90b3MvMTc2MzA3NS9wZXhlbHMtcGhvdG8tMTc2MzA3NS5qcGVnP2F1dG89Y29tcHJlc3MmY3M9dGlueXNyZ2Imdz0zMDAnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBwbGF5bGlzdFxuICAgICAgICB9KVxuICAgICAgKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW1vdmluZyBzb25nIGZyb20gcGxheWxpc3Q6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLy8gVXBkYXRlIGxhc3Qgc29uZyBpbiB1c2VyIHByb2ZpbGVcbiAgY29uc3QgdXBkYXRlTGFzdFNvbmcgPSBhc3luYyAoc29uZ0lkOiBzdHJpbmcpID0+IHtcbiAgICBpZiAoIXVzZXIpIHJldHVyblxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCd1c2VycycpXG4gICAgICAgIC51cGRhdGUoeyBsYXN0X3NvbmdfZmlsZV9pZDogcGFyc2VJbnQoc29uZ0lkKSB9KVxuICAgICAgICAuZXEoJ2lkJywgdXNlci5pZClcblxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBsYXN0IHNvbmc6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLy8gUmVjb3JkIGxpc3RlbmluZyBoaXN0b3J5IHdpdGggcHJvcGVyIHRpbWUgdHJhY2tpbmdcbiAgY29uc3QgcmVjb3JkTGlzdGVuaW5nSGlzdG9yeSA9IGFzeW5jIChzb25nSWQ6IHN0cmluZykgPT4ge1xuICAgIGlmICghdXNlcikgcmV0dXJuXG5cbiAgICAvLyBJZiB0aGVyZSdzIGEgcHJldmlvdXMgc29uZyBwbGF5aW5nLCByZWNvcmQgaXRzIGxpc3RlbmluZyB0aW1lXG4gICAgICBpZiAoY3VycmVudFNvbmdSZWYuY3VycmVudCAmJiBjdXJyZW50U29uZ1N0YXJ0VGltZSkge1xuICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IG1pbnV0ZXNMaXN0ZW5lZCA9IChlbmRUaW1lLmdldFRpbWUoKSAtIGN1cnJlbnRTb25nU3RhcnRUaW1lLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwKTtcblxuICAgIGlmIChtaW51dGVzTGlzdGVuZWQgPiAwLjEpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLnJvdW5kKG1pbnV0ZXNMaXN0ZW5lZCAqIDEwMCkgLyAxMDA7XG4gICAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYygndXBzZXJ0X2hpc3RvcnlfbWludXRlcycsIHtcbiAgICAgICAgICB1c2VyX3V1aWQ6IHVzZXIuaWQsXG4gICAgICAgICAgc29uZ19maWxlX2lkOiBwYXJzZUludChjdXJyZW50U29uZ1JlZi5jdXJyZW50KSxcbiAgICAgICAgICBtaW51dGVzOiBtaW51dGVzLFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgcmVjb3JkaW5nIHNvbmcgaGlzdG9yeTonLCBlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYOKchSBIaXN0b3J5IHVwZGF0ZWQ6ICske21pbnV0ZXN9IG1pbnMgZm9yIHNvbmcgJHtjdXJyZW50U29uZ1JlZi5jdXJyZW50fWApO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNvcmRpbmcgcHJldmlvdXMgc29uZyBoaXN0b3J5OicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuXG4gICAgLy8gU2V0IG5ldyBzb25nIGFzIGN1cnJlbnRcbiAgICBjdXJyZW50U29uZ1JlZi5jdXJyZW50ID0gc29uZ0lkXG4gICAgc2V0Q3VycmVudFNvbmdTdGFydFRpbWUobmV3IERhdGUoKSlcbiAgICBcbiAgICAvLyBVcGRhdGUgbGFzdCBzb25nIGluIHVzZXIgcHJvZmlsZVxuICAgIGF3YWl0IHVwZGF0ZUxhc3RTb25nKHNvbmdJZClcbnRyeSB7XG4gIGF3YWl0IHN1cGFiYXNlLnJwYygnaW5jcmVtZW50X3Nvbmdfdmlld3MnLCB7IHNvbmdfZmlsZV9pZDogcGFyc2VJbnQoc29uZ0lkKSB9KTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluY3JlbWVudGluZyBzb25nIHZpZXdzOicsIGVycm9yKTtcbn1cblxuICB9XG5cbiAgLy8gU3RvcCBjdXJyZW50IHNvbmcgdHJhY2tpbmcgKHdoZW4gcGxheWVyIGlzIGNsb3NlZClcbiAgY29uc3Qgc3RvcEN1cnJlbnRTb25nVHJhY2tpbmcgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKGN1cnJlbnRTb25nUmVmLmN1cnJlbnQgJiYgY3VycmVudFNvbmdTdGFydFRpbWUgJiYgdXNlcikge1xuICAgICAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKClcbiAgICAgIGNvbnN0IG1pbnV0ZXNMaXN0ZW5lZCA9IChlbmRUaW1lLmdldFRpbWUoKSAtIGN1cnJlbnRTb25nU3RhcnRUaW1lLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwKVxuICAgICAgXG4gICAgICBpZiAobWludXRlc0xpc3RlbmVkID4gMC4xKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgbWludXRlcyA9IE1hdGgucm91bmQobWludXRlc0xpc3RlbmVkICogMTAwKSAvIDEwMDtcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5ycGMoJ3Vwc2VydF9oaXN0b3J5X21pbnV0ZXMnLCB7XG4gICAgICB1c2VyX3V1aWQ6IHVzZXIuaWQsXG4gICAgICBzb25nX2ZpbGVfaWQ6IHBhcnNlSW50KGN1cnJlbnRTb25nUmVmLmN1cnJlbnQpLFxuICAgICAgbWludXRlczogbWludXRlcyxcbiAgICB9KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIHJlY29yZGluZyBzb25nIGhpc3Rvcnkgb24gc3RvcDonLCBlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5uRIEhpc3RvcnkgdXBkYXRlZCBvbiBzdG9wOiArJHttaW51dGVzfSBtaW5zIGZvciBzb25nICR7Y3VycmVudFNvbmdSZWYuY3VycmVudH1gKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVjb3JkaW5nIGZpbmFsIHNvbmcgaGlzdG9yeTonLCBlcnJvcik7XG4gIH1cbn1cblxuICAgIH1cblxuICAgIGN1cnJlbnRTb25nUmVmLmN1cnJlbnQgPSBudWxsXG4gICAgc2V0Q3VycmVudFNvbmdTdGFydFRpbWUobnVsbClcbiAgfVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgbG9hZERhdGEgPSBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgLy8gUmVzZXQgZGF0YSB3aGVuIHVzZXIgbG9ncyBvdXRcbiAgICAgICAgc2V0U29uZ3MoW10pXG4gICAgICAgIHNldFBsYXlsaXN0cyhbXSlcbiAgICAgICAgc2V0TGlrZWRTb25ncyhuZXcgU2V0KCkpXG4gICAgICAgIHNldExhc3RQbGF5ZWRTb25nKG51bGwpXG4gICAgICAgIHNldExvYWRpbmcoZmFsc2UpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICB0cnkge1xuICAgICAgICBzZXRMb2FkaW5nKHRydWUpXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFtmZXRjaFNvbmdzKCksIGZldGNoUGxheWxpc3RzKCksIGZldGNoUmVjZW50bHlQbGF5ZWQoKSwgZmV0Y2hQZXJzb25hbGl6ZWRTb25ncygpXSlcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgZGF0YTonLCBlcnJvcilcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHNldExvYWRpbmcoZmFsc2UpXG4gICAgICB9XG4gICAgfVxuXG4gICAgbG9hZERhdGEoKVxuICB9LCBbdXNlcl0pXG5cbiAgcmV0dXJuIHtcbiAgICBzb25ncyxcbiAgICBwZXJzb25hbGl6ZWRTb25ncyxcbiAgICBwbGF5bGlzdHMsXG4gICAgbGlrZWRTb25nczogc29uZ3MuZmlsdGVyKHNvbmcgPT4gc29uZy5pc0xpa2VkKSxcbiAgICByZWNlbnRseVBsYXllZFNvbmdzLFxuICAgIGxhc3RQbGF5ZWRTb25nLFxuICAgIGxvYWRpbmcsXG4gICAgdG9nZ2xlTGlrZSxcbiAgICBjcmVhdGVQbGF5bGlzdCxcbiAgICBkZWxldGVQbGF5bGlzdCxcbiAgICByZW5hbWVQbGF5bGlzdCxcbiAgICBhZGRTb25nVG9QbGF5bGlzdCxcbiAgICByZW1vdmVTb25nRnJvbVBsYXlsaXN0LFxuICAgIHJlY29yZExpc3RlbmluZ0hpc3RvcnksXG4gICAgc3RvcEN1cnJlbnRTb25nVHJhY2tpbmcsXG4gICAgcmVmcmVzaERhdGE6ICgpID0+IHtcbiAgICAgIGZldGNoU29uZ3MoKVxuICAgICAgZmV0Y2hQbGF5bGlzdHMoKVxuICAgICAgZmV0Y2hSZWNlbnRseVBsYXllZCgpXG4gICAgICBmZXRjaFBlcnNvbmFsaXplZFNvbmdzKClcbiAgICB9LFxuICAgIGdldFBlcnNvbmFsaXplZFNvbmdzLFxuICAgIGdldFNtYXJ0UGVyc29uYWxpemVkU29uZ3NcbiAgfVxufSJdLCJuYW1lcyI6WyJzdXBhYmFzZSIsInVzZUVmZmVjdCIsInVzZVJlZiIsInVzZVN0YXRlIiwidXNlU3VwYWJhc2VEYXRhIiwidXNlciIsInNvbmdzIiwic2V0U29uZ3MiLCJwbGF5bGlzdHMiLCJzZXRQbGF5bGlzdHMiLCJsaWtlZFNvbmdzIiwic2V0TGlrZWRTb25ncyIsIlNldCIsImxhc3RQbGF5ZWRTb25nIiwic2V0TGFzdFBsYXllZFNvbmciLCJyZWNlbnRseVBsYXllZFNvbmdzIiwic2V0UmVjZW50bHlQbGF5ZWRTb25ncyIsInBlcnNvbmFsaXplZFNvbmdzIiwic2V0UGVyc29uYWxpemVkU29uZ3MiLCJsb2FkaW5nIiwic2V0TG9hZGluZyIsImN1cnJlbnRTb25nU3RhcnRUaW1lIiwic2V0Q3VycmVudFNvbmdTdGFydFRpbWUiLCJjdXJyZW50U29uZ1JlZiIsImdldFNtYXJ0UGVyc29uYWxpemVkU29uZ3MiLCJ1c2VySWQiLCJsaXN0ZW5lZFNvbmdzSW5CYXRjaCIsImV4Y2x1ZGVTb25ncyIsImNvbnNvbGUiLCJsb2ciLCJtYXAiLCJzIiwibmFtZSIsImxlbmd0aCIsInByZWZlcnJlZFRhZ3MiLCJwcmVmZXJyZWRBcnRpc3RzIiwiZm9yRWFjaCIsInNvbmciLCJ0YWdzIiwidGFnIiwiYWRkIiwidG9Mb3dlckNhc2UiLCJhcnRpc3QiLCJBcnJheSIsImZyb20iLCJkYXRhIiwic29uZ3NEYXRhIiwiZXJyb3IiLCJzb25nc0Vycm9yIiwic2VsZWN0Iiwid2FybiIsImxpa2VkRGF0YSIsImVxIiwidXNlckxpa2VkU29uZ3MiLCJpdGVtIiwic29uZ19pZCIsImF2YWlsYWJsZVNvbmdzIiwiZmlsdGVyIiwiaGFzIiwiZmlsZV9pZCIsInRvU3RyaW5nIiwic2NvcmVkU29uZ3MiLCJzY29yZSIsInNvbmdUYWdzIiwibWF0Y2hpbmdUYWdzIiwibGlzdGVuZWRMYW5ndWFnZXMiLCJsYW5ndWFnZSIsImluY2x1ZGVzIiwiTWF0aCIsImxpa2VzIiwidmlld3MiLCJyYW5kb20iLCJjb252ZXJ0RGF0YWJhc2VTb25nIiwicmVjb21tZW5kYXRpb25zIiwic29ydCIsImEiLCJiIiwic2xpY2UiLCJlbnRyeSIsImRiU29uZyIsImlzTGlrZWQiLCJpbWdfaWQiLCJpZCIsImltYWdlIiwiZmV0Y2hTb25ncyIsIm9yZGVyIiwiYXNjZW5kaW5nIiwiY29udmVydGVkU29uZ3MiLCJzb3J0ZWRTb25ncyIsImFTY29yZSIsImJTY29yZSIsInVzZXJEYXRhIiwic2luZ2xlIiwibGFzdF9zb25nX2ZpbGVfaWQiLCJsYXN0U29uZyIsImZpbmQiLCJnZXRQZXJzb25hbGl6ZWRTb25ncyIsImN1cnJlbnRTb25nIiwibGlzdGVuZWRTb25ncyIsInNpemUiLCJoaXN0b3J5RGF0YSIsImhpc3RvcnlFcnJvciIsImhpc3RvcnlNYXAiLCJNYXAiLCJoIiwic2V0IiwibWludXRlc19saXN0ZW5lZCIsImxpc3RlbmVkTWludXRlcyIsImdldCIsIm1pbiIsImZldGNoUGVyc29uYWxpemVkU29uZ3MiLCJsaW1pdCIsInRyZW5kaW5nU29uZ3MiLCJjb252ZXJ0ZWQiLCJ0b3BTb25ncyIsInRhZ0NvdW50cyIsImFydGlzdENvdW50cyIsImhpc3RvcnlTb25nSWRzIiwiaXNBcnJheSIsIm5vcm1hbGl6ZWRUYWciLCJ0cmltIiwibm9ybWFsaXplZEFydGlzdCIsImNvbW1vblRhZ3MiLCJlbnRyaWVzIiwiY29tbW9uQXJ0aXN0cyIsImFsbFNvbmdzIiwic29uZ0FydGlzdCIsImZldGNoUmVjZW50bHlQbGF5ZWQiLCJyZWNlbnRTb25ncyIsImZldGNoUGxheWxpc3RzIiwicGxheWxpc3RzRGF0YSIsImNvbnZlcnRlZFBsYXlsaXN0cyIsInBsYXlsaXN0IiwicGxheWxpc3RTb25ncyIsInBsYXlsaXN0X3NvbmdzIiwicHMiLCJzb25nQ291bnQiLCJ0b2dnbGVMaWtlIiwic29uZ0lkIiwic29uZ0ZpbGVJZCIsInBhcnNlSW50IiwiaXNDdXJyZW50bHlMaWtlZCIsImRlbGV0ZSIsInJwYyIsInNvbmdfZmlsZV9pZCIsInByZXYiLCJuZXdTZXQiLCJpbnNlcnQiLCJ1c2VyX2lkIiwicHJldlNvbmdzIiwicHJldlBsYXlsaXN0cyIsImNyZWF0ZVBsYXlsaXN0IiwibmV3UGxheWxpc3QiLCJkZWxldGVQbGF5bGlzdCIsInBsYXlsaXN0SWQiLCJyZW5hbWVQbGF5bGlzdCIsIm5ld05hbWUiLCJ1cGRhdGUiLCJhZGRTb25nVG9QbGF5bGlzdCIsInBsYXlsaXN0X2lkIiwic29uZ0V4aXN0cyIsInNvbWUiLCJ1cGRhdGVkU29uZ3MiLCJyZW1vdmVTb25nRnJvbVBsYXlsaXN0IiwidXBkYXRlTGFzdFNvbmciLCJyZWNvcmRMaXN0ZW5pbmdIaXN0b3J5IiwiY3VycmVudCIsImVuZFRpbWUiLCJEYXRlIiwibWludXRlc0xpc3RlbmVkIiwiZ2V0VGltZSIsIm1pbnV0ZXMiLCJyb3VuZCIsInVzZXJfdXVpZCIsInN0b3BDdXJyZW50U29uZ1RyYWNraW5nIiwibG9hZERhdGEiLCJQcm9taXNlIiwiYWxsIiwicmVmcmVzaERhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./hooks/useSupabaseData.ts\n"));

/***/ })

});